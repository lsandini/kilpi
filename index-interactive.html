<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kilpirauhassyöpä - Päätöksenteon tuki</title>
    <style>
/* Reset and base styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    line-height: 1.5;
    color: #333;
    background: #f5f5f5;
    min-height: 100vh;
    overflow-x: hidden;
}

.app-header {
    background: #014479;
    color: white;
    padding: 20px 25px;
    text-align: left;
    box-sizing: border-box;
}

.app-header h1 {
    font-size: 22px;
    margin-bottom: 4px;
    font-weight: 600;
    line-height: 1.2;
}

.app-header .subtitle {
    font-size: 14px;
    opacity: 0.9;
    line-height: 1.2;
}

.app-container {
    display: flex;
    min-height: calc(100vh - 81px);
}

/* Sidebar */
.sidebar {
    width: 250px;
    background: #014479;
    color: white;
    overflow-y: auto;
    flex-shrink: 0;
}

.sidebar-nav {
    padding: 15px 0 0 0;
}

.nav-toggle-all {
    padding: 0 15px 10px 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    margin-bottom: 10px;
}

.toggle-all-btn {
    background: transparent;
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: rgba(255, 255, 255, 0.7);
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 11px;
    display: flex;
    align-items: center;
    gap: 5px;
    transition: all 0.2s ease;
    width: 100%;
    justify-content: center;
}

.toggle-all-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.5);
    color: rgba(255, 255, 255, 0.9);
}

.toggle-all-btn .toggle-icon {
    font-size: 12px;
}

.toggle-all-btn .toggle-text {
    font-weight: 500;
}

.nav-section {
    margin-bottom: 12px;
}

.nav-section:first-child {
    margin-top: 0;
}

.nav-section-title {
    padding: 8px 20px;
    color: rgba(255, 255, 255, 0.95);
    font-size: 13px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    background: rgba(0, 0, 0, 0.15);
    margin-top: 0;
    margin-bottom: 0;
}

.nav-section-title.collapsible {
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: background-color 0.2s;
    user-select: none;
}

.nav-section-title.collapsible:hover {
    background: rgba(0, 0, 0, 0.25);
}

.nav-item.nav-item-header {
    text-transform: uppercase;
    font-weight: 600;
    font-size: 13px;
    letter-spacing: 0.5px;
    background: rgba(0, 0, 0, 0.15);
    padding: 8px 20px;
}

.section-text {
    flex: 1;
}

.collapse-icon {
    font-size: 10px;
    transition: transform 0.3s ease;
    margin-left: 8px;
}

.nav-section-title.collapsible.expanded .collapse-icon {
    transform: rotate(180deg);
}

.nav-subsection {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease-out;
}

.nav-section-title.collapsible.expanded + .nav-subsection {
    max-height: 500px;
}

.nav-item {
    display: block;
    padding: 10px 20px;
    color: rgba(255, 255, 255, 0.85);
    text-decoration: none;
    font-size: 14px;
    transition: background-color 0.2s, padding-left 0.2s;
    border-left: 3px solid transparent;
}

.nav-subitem {
    padding-left: 35px;
    font-size: 13px;
    padding-top: 8px;
    padding-bottom: 8px;
}

.nav-item:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
    padding-left: 25px;
}

.nav-subitem:hover {
    padding-left: 40px;
}

.nav-item.active {
    background: rgba(255, 255, 255, 0.15);
    border-left-color: #4FC3F7;
    color: white;
    font-weight: 500;
}

.nav-tool {
    background: rgba(255, 215, 0, 0.08);
    font-weight: 500;
}

.nav-tool:hover {
    background: rgba(255, 215, 0, 0.15);
}

.nav-tool.active {
    background: rgba(255, 215, 0, 0.2);
}

/* Main content area */
.main-content {
    flex: 1;
    background: white;
    overflow-y: auto;
}

/* Content sections */
.content-section {
    display: none;
    padding: 25px;
}

.content-section.active {
    display: block;
}

.section-title {
    font-size: 20px;
    color: #095DA5;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid #095DA5;
}

.placeholder {
    padding: 40px;
    text-align: center;
    color: #999;
    font-style: italic;
}

.info-content {
    padding: 20px 0;
}

.info-content h3 {
    color: #095DA5;
    margin-bottom: 12px;
    margin-top: 24px;
    font-size: 16px;
}

.info-content h3:first-child {
    margin-top: 0;
}

.info-content p {
    margin-bottom: 12px;
    line-height: 1.6;
    color: #555;
}

.info-content ul {
    margin-left: 20px;
    margin-bottom: 12px;
}

.info-content li {
    margin-bottom: 4px;
    line-height: 1.6;
    color: #555;
}

.info-content ul ul {
    margin-top: 6px;
    margin-bottom: 6px;
    margin-left: 20px;
    list-style-type: none;
}

.info-content ul ul li {
    position: relative;
    padding-left: 15px;
}

.info-content ul ul li:before {
    content: "–";
    position: absolute;
    left: 0;
    color: #666;
}

/* Main content */
main {
    padding: 25px;
}

.form-section {
    margin-bottom: 25px;
    padding-bottom: 20px;
    border-bottom: 1px solid #e0e0e0;
}

.form-section:last-of-type {
    border-bottom: none;
}

.form-section h2 {
    font-size: 18px;
    color: #095DA5;
    margin-bottom: 15px;
    font-weight: 600;
}

/* Form elements */
.form-group {
    margin-bottom: 15px;
}

label {
    display: block;
    font-weight: 500;
    margin-bottom: 6px;
    color: #555;
    font-size: 14px;
}

input[type="number"],
select {
    width: 100%;
    padding: 8px 12px;
    font-size: 14px;
    border: 1px solid #ccc;
    border-radius: 3px;
    transition: border-color 0.2s;
}

input[type="number"]:focus,
select:focus {
    outline: none;
    border-color: #095DA5;
    box-shadow: 0 0 0 2px rgba(9, 93, 165, 0.1);
}

.helper-text {
    display: block;
    font-size: 12px;
    color: #888;
    margin-top: 4px;
}

/* Checkboxes */
.checkbox-group {
    margin-bottom: 4px;
}

.checkbox-group label {
    display: flex;
    align-items: center;
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 3px;
    transition: background-color 0.2s;
    font-size: 14px;
    font-weight: normal;
}

.checkbox-group label:hover {
    background-color: #f5f5f5;
}

.checkbox-group input[type="checkbox"] {
    width: 16px;
    height: 16px;
    margin-right: 8px;
    cursor: pointer;
    accent-color: #095DA5;
}

/* Buttons */
.button-group {
    display: flex;
    gap: 10px;
    margin-top: 20px;
}

button {
    flex: 1;
    padding: 10px 20px;
    font-size: 14px;
    font-weight: 600;
    border: none;
    border-radius: 3px;
    cursor: pointer;
    transition: background-color 0.2s;
}

button:hover {
    opacity: 0.9;
}

button:active {
    opacity: 0.8;
}

.btn-primary {
    background: #095DA5;
    color: white;
}

.btn-secondary {
    background: #6c757d;
    color: white;
}

/* Result container */
.result-container {
    margin-top: 25px;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 3px;
    border-left: 4px solid #095DA5;
}

.result-container h2 {
    font-size: 18px;
    color: #095DA5;
    margin-bottom: 15px;
}

.recommendation {
    padding: 15px;
    background: white;
    border-radius: 3px;
    margin-bottom: 15px;
    font-size: 16px;
    font-weight: 600;
    border-left: 4px solid #28a745;
}

.recommendation.warning {
    border-left-color: #ff9800;
}

.recommendation.high-risk {
    border-left-color: #d32f2f;
}

.recommendation.benign {
    border-left-color: #4caf50;
    background: #f1f8f4;
}

.rationale {
    padding: 15px;
    background: white;
    border-radius: 3px;
    margin-bottom: 15px;
}

.rationale h3 {
    font-size: 14px;
    color: #555;
    margin-bottom: 8px;
}

.rationale ul {
    margin-left: 20px;
}

.rationale li {
    margin-bottom: 6px;
    color: #666;
    font-size: 14px;
}

.rationale p {
    font-size: 14px;
    margin-bottom: 10px;
}

.disclaimer {
    padding: 12px;
    background: #fff9e6;
    border: 1px solid #ff9800;
    border-radius: 3px;
    font-size: 13px;
    color: #856404;
}

/* Info and recommendation boxes */
.info-box {
    background: #f0f7ff;
    border: 1px solid #b3d4fc;
    border-left: 4px solid #095DA5;
    border-radius: 4px;
    padding: 15px 20px;
    margin: 15px 0;
}

.info-box h4 {
    color: #095DA5;
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 15px;
}

.info-box p,
.info-box ul {
    margin: 0;
    color: #555;
    font-size: 14px;
    line-height: 1.6;
}

.info-box ul {
    margin-left: 20px;
}

.info-box li {
    margin-bottom: 5px;
}

.recommendation-box {
    background: #f8f9fa;
    border: 1px solid #e0e0e0;
    border-left: 4px solid #ff9800;
    border-radius: 4px;
    padding: 15px 20px;
    margin: 15px 0;
}

.recommendation-box h4 {
    color: #e65100;
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 15px;
}

.recommendation-box ul {
    margin: 0;
    margin-left: 20px;
    color: #555;
    font-size: 14px;
    line-height: 1.6;
}

.recommendation-box li {
    margin-bottom: 5px;
}

.recommendation-box.recommendation-korkea {
    border-left-color: #d32f2f;
}

.recommendation-box.recommendation-korkea h4 {
    color: #c62828;
}

/* Footer */
footer {
    background: #f8f9fa;
    padding: 15px 25px;
    text-align: center;
    font-size: 12px;
    color: #666;
    border-top: 1px solid #e0e0e0;
}

/* PAD Table styles */
.pad-table {
    width: 100%;
    border-collapse: collapse;
    margin: 15px 0;
    font-size: 14px;
}

.pad-table th,
.pad-table td {
    border: 1px solid #ddd;
    padding: 10px 12px;
    text-align: left;
}

.pad-table th {
    background: #095DA5;
    color: white;
    font-weight: 600;
}

.pad-table tr:nth-child(even) {
    background: #f9f9f9;
}

.pad-table tr:hover {
    background: #f0f7ff;
}

/* Info content h4 styling */
.info-content h4 {
    color: #333;
    margin-bottom: 8px;
    margin-top: 16px;
    font-size: 15px;
}

/* Source card styling */
.source-card {
    background: #f8f9fa;
    border: 1px solid #e0e0e0;
    border-left: 4px solid #095DA5;
    border-radius: 4px;
    padding: 20px;
    margin: 15px 0;
}

.source-card h4 {
    color: #095DA5;
    margin-top: 0;
    margin-bottom: 5px;
    font-size: 16px;
}

.source-meta {
    color: #666;
    font-size: 13px;
    margin-bottom: 15px;
}

.article-meta {
    list-style: none;
    margin: 0;
    padding: 0;
}

.article-meta li {
    padding: 4px 0;
    color: #555;
    font-size: 14px;
}

.authors-list {
    line-height: 1.8;
    color: #555;
    font-size: 14px;
}

.copyright {
    margin-top: 15px;
    font-size: 13px;
    color: #888;
    font-style: italic;
}

.references-list {
    margin-left: 25px;
    padding-left: 0;
}

.references-list li {
    margin-bottom: 10px;
    font-size: 13px;
    line-height: 1.5;
    color: #555;
}

.placeholder-text {
    color: #888;
    font-style: italic;
}

/* Responsive design */
@media (max-width: 768px) {
    .sidebar {
        width: 200px;
    }

    .content-section {
        padding: 15px;
    }

    .app-header {
        padding: 15px;
    }

    .app-header h1 {
        font-size: 18px;
    }

    .button-group {
        flex-direction: column;
    }

    button {
        width: 100%;
    }

    .form-section {
        margin-bottom: 20px;
        padding-bottom: 15px;
    }

    .result-container {
        padding: 15px;
    }

    .nav-item {
        font-size: 13px;
        padding: 8px 15px;
    }

    .nav-section-title {
        font-size: 12px;
        padding: 6px 15px;
    }

    .collapse-icon {
        font-size: 9px;
    }

    .nav-subitem {
        padding-left: 25px;
        font-size: 12px;
    }

    .nav-section-title.collapsible.expanded + .nav-subsection {
        max-height: 400px;
    }

    .nav-toggle-all {
        padding: 0 10px 8px 10px;
    }

    .toggle-all-btn {
        font-size: 10px;
        padding: 4px 8px;
    }

    .references-list li {
        font-size: 12px;
    }
}

@media (max-width: 480px) {
    .sidebar {
        display: none;
    }
}
</style>
</head>
<body>
    <header class="app-header">
        <h1>Papillaarinen ja follikulaarinen kilpirauhasen syöpä</h1>
        <p class="subtitle">Interaktiivinen päätöksenteon tuki</p>
    </header>

    <div class="app-container">
        <aside class="sidebar">
            <nav class="sidebar-nav">
                <div class="nav-toggle-all">
                    <button id="toggleAllSections" class="toggle-all-btn" title="Avaa/sulje kaikki">
                        <span class="toggle-icon">⊞</span>
                        <span class="toggle-text">Avaa kaikki</span>
                    </button>
                </div>
                <!-- Section 1: Introduction -->
                <div class="nav-section">
                    <a href="#introduction" class="nav-item nav-item-header active">1. Johdanto</a>
                </div>

                <!-- Section 2: Nodule Evaluation -->
                <div class="nav-section">
                    <div class="nav-section-title collapsible">
                        <span class="section-text">2. Kyhmyn arviointi</span>
                        <span class="collapse-icon">▼</span>
                    </div>
                    <div class="nav-subsection">
                        <a href="#clinical-exam" class="nav-item nav-subitem">2.1 Kliininen tutkimus</a>
                        <a href="#ultrasound" class="nav-item nav-subitem nav-tool">2.2 Ultraääni ⭐</a>
                        <a href="#fna-biopsy" class="nav-item nav-subitem nav-tool">2.3 Ohutneulanäyte (FNA) ⭐</a>
                        <a href="#bethesda" class="nav-item nav-subitem nav-tool">2.4 Bethesda-luokitus ⭐</a>
                        <a href="#incidental-findings" class="nav-item nav-subitem nav-tool">2.5 Sattumalöydökset ⭐</a>
                    </div>
                </div>

                <!-- Section 3: Surgical Treatment -->
                <div class="nav-section">
                    <div class="nav-section-title collapsible">
                        <span class="section-text">3. Kirurginen hoito</span>
                        <span class="collapse-icon">▼</span>
                    </div>
                    <div class="nav-subsection">
                        <a href="#surgical-planning" class="nav-item nav-subitem nav-tool">3.1 Leikkaussuunnittelu ⭐</a>
                        <a href="#lymph-node-dissection" class="nav-item nav-subitem">3.2 Imusolmukedissektio</a>
                        <a href="#surgical-complications" class="nav-item nav-subitem">3.3 Komplikaatiot</a>
                        <a href="#calcium-management" class="nav-item nav-subitem nav-tool">3.4 Kalsiumin hallinta ⭐</a>
                    </div>
                </div>

                <!-- Section 4: Pathology -->
                <div class="nav-section">
                    <div class="nav-section-title collapsible">
                        <span class="section-text">4. Patologia</span>
                        <span class="collapse-icon">▼</span>
                    </div>
                    <div class="nav-subsection">
                        <a href="#pathology-report" class="nav-item nav-subitem">4.1 PAD-lausunto</a>
                        <a href="#tnm-staging" class="nav-item nav-subitem nav-tool">4.2 TNM-luokitus ⭐</a>
                        <a href="#histological-subtypes" class="nav-item nav-subitem">4.3 Histologiset alatyypit</a>
                    </div>
                </div>

                <!-- Section 5: Radioiodine Therapy -->
                <div class="nav-section">
                    <div class="nav-section-title collapsible">
                        <span class="section-text">5. Radiojodihoito</span>
                        <span class="collapse-icon">▼</span>
                    </div>
                    <div class="nav-subsection">
                        <a href="#risk-stratification" class="nav-item nav-subitem nav-tool">5.1 Riskiluokittelu ⭐</a>
                        <a href="#rai-indications" class="nav-item nav-subitem">5.2 Indikaatiot</a>
                        <a href="#tsh-stimulation" class="nav-item nav-subitem">5.3 TSH-stimulaatio</a>
                        <a href="#radiation-safety" class="nav-item nav-subitem">5.4 Säteilysuojelu</a>
                    </div>
                </div>

                <!-- Section 6: Response Assessment & Surveillance -->
                <div class="nav-section">
                    <div class="nav-section-title collapsible">
                        <span class="section-text">6. Vastearvio & Seuranta</span>
                        <span class="collapse-icon">▼</span>
                    </div>
                    <div class="nav-subsection">
                        <a href="#response-assessment" class="nav-item nav-subitem nav-tool">6.1 Vastearviointi ⭐</a>
                        <a href="#surveillance-protocol" class="nav-item nav-subitem">6.2 Seurantaprotokolla</a>
                        <a href="#tsh-targets" class="nav-item nav-subitem nav-tool">6.3 TSH-tavoitteet ⭐</a>
                        <a href="#imaging-surveillance" class="nav-item nav-subitem">6.4 Kuvantamisseuranta</a>
                    </div>
                </div>

                <!-- Section 7: Recurrent & Advanced Disease -->
                <div class="nav-section">
                    <div class="nav-section-title collapsible">
                        <span class="section-text">7. Uusiutunut tauti</span>
                        <span class="collapse-icon">▼</span>
                    </div>
                    <div class="nav-subsection">
                        <a href="#repeat-surgery" class="nav-item nav-subitem nav-tool">7.1 Uusintaleikkaukset ⭐</a>
                        <a href="#repeat-rai" class="nav-item nav-subitem nav-tool">7.2 Radiojodin uusinta ⭐</a>
                        <a href="#external-radiation" class="nav-item nav-subitem nav-tool">7.3 Ulkoinen sädehoito ⭐</a>
                        <a href="#systemic-therapy" class="nav-item nav-subitem nav-tool">7.4 Systeeminen hoito ⭐</a>
                    </div>
                </div>

                <!-- Section 8: Special Topics -->
                <div class="nav-section">
                    <div class="nav-section-title collapsible">
                        <span class="section-text">8. Erityisaiheet</span>
                        <span class="collapse-icon">▼</span>
                    </div>
                    <div class="nav-subsection">
                        <a href="#genetic-predisposition" class="nav-item nav-subitem nav-tool">8.1 Geneettinen alttius ⭐</a>
                        <a href="#pregnancy" class="nav-item nav-subitem nav-tool">8.2 Raskaus ⭐</a>
                        <a href="#thyroglobulin" class="nav-item nav-subitem nav-tool">8.3 Tyreoglobuliini ⭐</a>
                    </div>
                </div>

                <!-- Section 9: Sources -->
                <div class="nav-section">
                    <div class="nav-section-title collapsible">
                        <span class="section-text">9. Lähteet</span>
                        <span class="collapse-icon">▼</span>
                    </div>
                    <div class="nav-subsection">
                        <a href="#source-article" class="nav-item nav-subitem">9.1 Alkuperäisartikkeli</a>
                        <a href="#source-references" class="nav-item nav-subitem">9.2 Kirjallisuusviitteet</a>
                    </div>
                </div>
            </nav>
        </aside>

        <div class="main-content">
            <!-- Section 1: Introduction -->
            <main id="introduction" class="content-section active">
                <h2 class="section-title">Johdanto</h2>
                <div class="info-content">
                    <h3>Kilpirauhassyövästä lyhyesti</h3>
                    <ul>
                        <li>Suomessa todetaan vuosittain noin 450 uutta kilpirauhassyöpätapausta</li>
                        <li>Näistä noin 80% on papillaarista karsinoomaa ja noin 10% follikulaarista karsinoomaa</li>
                        <li>Sairastuneiden ennuste on yleensä erinomainen eikä matalan riskin potilaiden eloonjäämisennuste eroa muusta väestöstä</li>
                        <li>Vuonna 2015 elossa olevia kilpirauhassyöpäpotilaita oli Suomessa 8543</li>
                        <li>Kuolemantapaukset alle 45-vuotiailla ovat harvinaisia</li>
                    </ul>

                    <h3>Taudin luonne</h3>
                    <ul>
                        <li>Vaikka elinikä ennuste on pääsääntöisesti erinomainen, nähdään myös paikallisesti tai etäpesäkkeisenä esiintyvää syöpää</li>
                        <li>Tässä laajassa tautikirjossa moniammatillinen työtapa, yhteiset hoitolinjat sekä hoidon keskittäminen kokeneisiin käsiin takaavat parhaan hoitotuloksen</li>
                        <li>Kilpirauhassyöpä todetaan yhä useammin sattumalta muusta syystä tehdyn tutkimuksen yhteydessä</li>
                    </ul>

                    <h3>Hoito</h3>
                    <ul>
                        <li>Kilpirauhassyövän hoitoon kuuluu lohkon poisto tai koko kilpirauhasen poisto</li>
                        <li>Sen jälkeen merkittävälle osalle potilaista radiojodihoito</li>
                        <li>Suuntaus on pelkän lohkonpoistojen lisäämiseen ja radiojodihoidon kriteerien tiukentumiseen</li>
                        <li>Etenevissä tilanteissa hoitona ovat:
                            <ul>
                                <li>Uusintaleikkaukset</li>
                                <li>Toistetut radiojodihoidot</li>
                                <li>Sädehoito</li>
                                <li>Uudet syöpälääkkeet voivat hyödyttää monia levinnyttä papillaarista tai follikulaarista syöpää sairastavista</li>
                            </ul>
                        </li>
                        <li>Mikäli koko kilpirauhanen on poistettu, tarvitaan elinikäinen tyroksiinihoito</li>
                    </ul>
                </div>
            </main>

            <!-- Section 2.1: Clinical Examination -->
            <main id="clinical-exam" class="content-section">
                <h2 class="section-title">Kliininen tutkimus</h2>
                <div class="info-content">
                    <h3>Kyhmy kilpirauhasessa</h3>
                    <ul>
                        <li>Kilpirauhasen kyhmy todetaan tunnustelemalla 3-7 % väestöstä, mutta ultraäänitutkimuksessa jopa 20-70 %</li>
                        <li>Kilpirauhasen kyhmy on normaalista kudoksesta erottuva rakennemuutos</li>
                        <li>Yleensä yli 15 mm kokoinen kyhmy voidaan todeta tunnustelemalla</li>
                        <li>Klinisesti yksittäisenä havaitun kyhmyn ultraäänitutkimus löytää usein monia erillisiä kyhmyjä</li>
                        <li>Kyhmy voi olla hyvänlaatuinen tai pahanlaatuinen kasvain, joskus syynä on tulehdus tai hyperplasia</li>
                        <li>Nykyään kilpirauhasen kyhmy havaitaan useimmiten sattumalöydöksenä</li>
                    </ul>

                    <h3>Potilaan anamnesi</h3>
                    <ul>
                        <li><strong>Aiempi kaulan alueen sädehoito</strong></li>
                        <li><strong>Sukuanamnesi:</strong>
                            <ul>
                                <li>Papillaarinen kilpirauhaskarsinooma useammalla kuin yhdellä lähisukulaisella</li>
                                <li>Suvun kasvainoireyhtymät (MEN1, MEN2, Cowdenin oireyhtymä, familialinen paksusuolen polypoosi)</li>
                            </ul>
                        </li>
                        <li><strong>Kasvunopeus edeltävinä viikkoina tai lähikuukausina:</strong>
                            <ul>
                                <li>Nopea kasvu viittaa syöpään</li>
                                <li>Äkillinen kivulias kyhmy viittaa kystisen kyhmyn verenvuotoon tai subakuuttiin tyreoidiittiin</li>
                            </ul>
                        </li>
                        <li><strong>Oireet:</strong> Nielemisvaiva, äänen tuoton muutos tai hengenahdistus</li>
                    </ul>

                    <h3>Kliininen tutkiminen</h3>
                    <ul>
                        <li><strong>Kilpirauhasen palpaatio:</strong>
                            <ul>
                                <li>Kyhmyn koko, arkuus, kiinteys/kovuus, fiksaatio ympäristöön ja kyhmyjen lukumäärä</li>
                                <li>Aristava kyhmy ja yleisoireet viittaavat kilpirauhasen tulehdukseen</li>
                                <li>Kiinteä, kova, yksittäinen tai dominantti kyhmy voi olla pahanlaatuinen</li>
                                <li>Oireeton ja pitkään samankokoisena pysynyt kyhmy ei kuitenkaan sulje pois pahanlaatuisuutta</li>
                            </ul>
                        </li>
                        <li><strong>Kaulan imusolmukkeiden palpaatio:</strong>
                            <ul>
                                <li>Sijainti ja määrä</li>
                            </ul>
                        </li>
                        <li><strong>Riskitekijät:</strong> Sukupuoli (mies) sekä ikä (&lt;14-vuotiaat ja &gt;70-vuotiaat) ovat kyhmyn pahanlaatuisuuden vaaratekijöitä</li>
                    </ul>

                    <h3>Laboratoriotutkimukset</h3>
                    <ul>
                        <li><strong>S-TSH:</strong>
                            <ul>
                                <li>Jos arvo on normaali viitevälissä, ei tarvita lisätutkimuksia</li>
                                <li>Jos pitoisuus on suurentunut, mittaa S-T4v ja S-TPOAb hypotyreoosin luonteen arvioimiseksi</li>
                                <li>Jos pitoisuus on pienentynyt, mittaa S-T4v ja S-T3v hypertyreosin luonteen arvioimiseksi</li>
                            </ul>
                        </li>
                        <li><strong>S-Kalsitoniini:</strong>
                            <ul>
                                <li>Mittaa vain, jos potilaan sukuhistoriassa on medullaarinen kilpirauhaskarsinooma tai MEN2</li>
                            </ul>
                        </li>
                        <li><strong>Huomio:</strong> Hypertyreoosin aiheuttava kyhmy on harvoin pahanlaatuinen, mutta laboratoriokokeet eivät poissulje pahanlaatuisuutta</li>
                    </ul>

                    <h3>Kaulan ultraäänitutkimus</h3>
                    <ul>
                        <li>Kaikille potilaille, joilla on todettu klinisesti kilpirauhasen kyhmy</li>
                        <li><strong>Ultraäänitutkimuksen pyyntöön kirjattavat tiedot:</strong>
                            <ul>
                                <li>Potilaan ikä, sukupuoli</li>
                                <li>Sukuanamnesi kilpirauhassyövän osalta</li>
                                <li>Palpoituvan kyhmyn puoli</li>
                                <li>Kilpirauhasen toiminta: eutyreosi tai toiminnan poikkeavuus</li>
                                <li>Kyhmyyn liittyvät oireet: kipu, nielemisvaiva, äänen tuoton muutos, hengenahdistus</li>
                            </ul>
                        </li>
                    </ul>

                    <h3>Kilpirauhasen isotooppikuvaus</h3>
                    <ul>
                        <li>Ei kuulu syöpädiagnostiikkaan</li>
                        <li>Harkitaan, jos potilaalla on kyhmyyn liittyen hypertreosi</li>
                    </ul>
                </div>
            </main>

            <!-- Section 2.2: Ultrasound -->
            <main id="ultrasound" class="content-section">
                <h2 class="section-title">Ultraääni - Maligniteettiriskin arviointi</h2>
                <form id="ultrasoundForm">
                    <section class="form-section">
                        <h2>Kyhmyn ominaisuudet</h2>

                        <div class="form-group">
                            <label for="noduleSize">Kyhmyn koko (mm):</label>
                            <input type="number" id="noduleSize" name="noduleSize" min="1" max="100" required>
                            <span class="helper-text">Syötä kyhmyn suurin läpimitta millimetreinä</span>
                        </div>

                        <div class="form-group">
                            <label for="composition">Koostumus:</label>
                            <select id="composition" name="composition" required>
                                <option value="">Valitse...</option>
                                <option value="solid">Solidi</option>
                                <option value="cystic-solid">Kystissolidi</option>
                                <option value="cystic">Kystinen (puhtaasti)</option>
                                <option value="honeycomb">Hunajakennomainen</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="echogenicity">Kaikurakenne:</label>
                            <select id="echogenicity" name="echogenicity" required>
                                <option value="">Valitse...</option>
                                <option value="markedly-hypo">Vahvasti niukkakaikuinen (< strap-lihas)</option>
                                <option value="mildly-hypo">Lievästi niukkakaikuinen</option>
                                <option value="iso">Samankaikuinen</option>
                                <option value="hyper">Runsaskaikuinen</option>
                            </select>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>Ultraäänipiirteet</h2>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="usFeature" value="microcalcifications">
                                Mikrokalkit (≤1 mm)
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="usFeature" value="macrocalcifications">
                                Makrokalkit (kaikukatvettä aiheuttavat)
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="usFeature" value="irregular-margins">
                                Epätarkkarajaiset reunat
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="usFeature" value="taller-than-wide">
                                Korkeampi kuin leveämpi (AP > sivumitta)
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="usFeature" value="extrathyroidal-extension">
                                Kasvu kilpirauhasen ulkopuolelle
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="usFeature" value="multiple-nodules">
                                Multippelit kyhmyt (monikyhmysstruuma)
                            </label>
                        </div>
                    </section>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">Laske maligniteettiriskin</button>
                        <button type="reset" class="btn-secondary">Tyhjennä</button>
                    </div>
                </form>

                <div id="ultrasoundResult" class="result-container" style="display: none;">
                    <h2>Maligniteettiriskin arvio</h2>
                    <div id="ultrasoundRecommendation" class="recommendation"></div>
                    <div id="ultrasoundRationale" class="rationale"></div>
                    <div class="disclaimer">
                        <strong>Huomio:</strong> Tämä on päätöksenteon tukityökalu. Lopullinen arvio tehdään yksilöllisesti kliinisen tilanteen perusteella.
                    </div>
                </div>
            </main>

            <!-- Section 2.3: FNA Biopsy -->
            <main id="fna-biopsy" class="content-section">
                <h2 class="section-title">Ohutneulanäyte (FNA) - Indikaatiot</h2>
                <form id="fnaForm">
                    <section class="form-section">
                        <h2>Kyhmyn ominaisuudet</h2>

                        <div class="form-group">
                            <label for="fnaNodeSize">Kyhmyn koko (mm):</label>
                            <input type="number" id="fnaNodeSize" name="fnaNodeSize" min="1" max="100" required>
                            <span class="helper-text">Syötä kyhmyn suurin läpimitta millimetreinä</span>
                        </div>

                        <div class="form-group">
                            <label for="fnaComposition">Koostumus:</label>
                            <select id="fnaComposition" name="fnaComposition" required>
                                <option value="">Valitse...</option>
                                <option value="solid-suspicious">Solidi + malignisuspektit piirteet</option>
                                <option value="solid-mildly-hypo">Solidi lievästi niukkakaikuinen</option>
                                <option value="solid-iso-hyper">Solidi saman- tai runsaskaikuinen</option>
                                <option value="cystic-solid">Kystissolidi</option>
                                <option value="cystic">Puhtaasti kystinen</option>
                                <option value="honeycomb">Hunajakennomainen</option>
                            </select>
                            <span class="helper-text">Valitse koostumus ja kaikurakenne</span>
                        </div>

                        <div class="form-group">
                            <label for="patientAge">Potilaan ikä (vuotta):</label>
                            <input type="number" id="patientAge" name="patientAge" min="1" max="120">
                            <span class="helper-text">Valinnainen, mutta vaikuttaa suositukseen alle 35-vuotiailla</span>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>Malignisuspektit piirteet ultraäänessä</h2>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="fnaFeature" value="microcalcifications">
                                Mikrokalkit
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="fnaFeature" value="irregular-margins">
                                Epätarkkarajaisuus
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="fnaFeature" value="extrathyroidal">
                                Kasvu kilpirauhasen ulkopuolelle
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="fnaFeature" value="taller-than-wide">
                                Korkeampi kuin leveämpi
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="fnaFeature" value="markedly-hypo">
                                Vahvasti niukkakaikuinen (< strap-lihas)
                            </label>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>Riskitekijät</h2>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFactor" value="prior-cancer">
                                Aiempi kilpirauhassyöpä
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFactor" value="neck-metastases">
                                Todetut kilpirauhassyövän kaulametastaasit
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFactor" value="radiation">
                                Aiempi pään/kaulan sädehoito lapsena/nuorena
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFactor" value="men2">
                                MEN2-syndrooma tai muu tunnettu riskisyndrooma
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFactor" value="family-history">
                                Sukuanamnesi (1. asteen sukulainen)
                            </label>
                        </div>
                    </section>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">Arvioi FNA-tarve</button>
                        <button type="reset" class="btn-secondary">Tyhjennä</button>
                    </div>
                </form>

                <div id="fnaResult" class="result-container" style="display: none;">
                    <h2>FNA-suositus</h2>
                    <div id="fnaRecommendation" class="recommendation"></div>
                    <div id="fnaRationale" class="rationale"></div>
                    <div class="disclaimer">
                        <strong>Huomio:</strong> Tämä on päätöksenteon tukityökalu. Lopullinen päätös FNA:sta tehdään yksilöllisesti kliinisen arvion perusteella.
                    </div>
                </div>
            </main>

            <!-- Section 2.4: Bethesda Classification -->
            <main id="bethesda" class="content-section">
                <h2 class="section-title">Bethesda-luokitus - Jatkohoidon määrittely</h2>
                <form id="bethesdaForm">
                    <section class="form-section">
                        <h2>Bethesda-kategoria</h2>

                        <div class="form-group">
                            <label for="bethesdaCategory">Valitse sytologinen kategoria:</label>
                            <select id="bethesdaCategory" name="bethesdaCategory" required>
                                <option value="">Valitse...</option>
                                <option value="1">I - Riittämätön näyte</option>
                                <option value="2">II - Benigni (0-3%)</option>
                                <option value="3">III - Merkitykseltään määrittämätön atypia (5-15%)</option>
                                <option value="4">IV - Follikulaarinen neoplasia (15-30%)</option>
                                <option value="5">V - Epäily maligniteetista (60-75%)</option>
                                <option value="6">VI - Maligni (97-99%)</option>
                            </select>
                            <span class="helper-text">Bethesda-luokituksen mukainen sytologinen diagnoosi</span>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>Ultraäänipiirteet</h2>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="bethesdaFeature" value="microcalcifications">
                                Mikrokalkit
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="bethesdaFeature" value="irregular-margins">
                                Epätarkkarajaisuus
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="bethesdaFeature" value="extrathyroidal">
                                Kasvu kilpirauhasen ulkopuolelle
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="bethesdaFeature" value="taller-than-wide">
                                Korkeampi kuin leveämpi
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="bethesdaFeature" value="markedly-hypo">
                                Vahvasti niukkakaikuinen (&lt; strap-lihas)
                            </label>
                        </div>
                    </section>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">Määritä jatkohoito</button>
                        <button type="button" onclick="document.getElementById('bethesdaForm').reset(); document.getElementById('bethesdaResult').style.display='none';" class="btn-secondary">Tyhjennä</button>
                    </div>
                </form>

                <div id="bethesdaResult" class="result-container" style="display: none;">
                    <h2>Jatkohoitosuositus</h2>
                    <div id="bethesdaRecommendation" class="recommendation"></div>
                    <div id="bethesdaRationale" class="rationale"></div>
                    <div class="disclaimer">
                        <strong>Huomio:</strong> Tämä on päätöksenteon tukityökalu. Lopullinen päätös jatkohoidosta tehdään yksilöllisesti ottaen huomioon potilaan ikä, perussairaudet ja kliininen tilanne.
                    </div>
                </div>
            </main>

            <!-- Section 2.5: Incidental Findings -->
            <main id="incidental-findings" class="content-section">
                <h2 class="section-title">Sattumalöydökset - Seurantasuositus</h2>
                <form id="incidentalForm">
                    <section class="form-section">
                        <h2>Kyhmyn ominaisuudet</h2>

                        <div class="form-group">
                            <label for="incidentalSize">Kyhmyn koko (mm):</label>
                            <input type="number" id="incidentalSize" name="incidentalSize" min="1" max="100" required>
                            <span class="helper-text">Sattumalöydöksenä todetun kyhmyn suurin läpimitta</span>
                        </div>

                        <div class="form-group">
                            <label for="incidentalComposition">Kaikurakenne:</label>
                            <select id="incidentalComposition" name="incidentalComposition" required>
                                <option value="">Valitse...</option>
                                <option value="solid-hypo-mild">Solidi lievästi niukkakaikuinen</option>
                                <option value="solid-iso-hyper">Solidi saman- tai runsaskaikuinen</option>
                                <option value="cystic-solid">Kystissolidi</option>
                                <option value="cystic">Puhtaasti kystinen</option>
                            </select>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>Malignisuspektit piirteet</h2>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="incidentalFeature" value="microcalcifications">
                                Mikrokalkit
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="incidentalFeature" value="irregular-margins">
                                Epätarkkarajaisuus
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="incidentalFeature" value="extrathyroidal">
                                Kasvu kilpirauhasen ulkopuolelle
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="incidentalFeature" value="taller-than-wide">
                                Korkeampi kuin leveämpi
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="incidentalFeature" value="markedly-hypo">
                                Vahvasti niukkakaikuinen (&lt; strap-lihas)
                            </label>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>Potilaan tiedot (valinnainen)</h2>

                        <div class="form-group">
                            <label for="incidentalAge">Potilaan ikä (vuotta):</label>
                            <input type="number" id="incidentalAge" name="incidentalAge" min="1" max="120">
                            <span class="helper-text">Alle 35-vuotiaat kuuluvat riskiryhmään</span>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="incidentalRisk" value="risk-group">
                                Riskiryhmä (aiempi kilpirauhassyöpä, sädehoito, MEN2, sukurasitus)
                            </label>
                        </div>
                    </section>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">Määritä seuranta</button>
                        <button type="button" onclick="document.getElementById('incidentalForm').reset(); document.getElementById('incidentalResult').style.display='none';" class="btn-secondary">Tyhjennä</button>
                    </div>
                </form>

                <div id="incidentalResult" class="result-container" style="display: none;">
                    <h2>Seurantasuositus</h2>
                    <div id="incidentalRecommendation" class="recommendation"></div>
                    <div id="incidentalRationale" class="rationale"></div>
                    <div class="disclaimer">
                        <strong>Huomio:</strong> Tämä on päätöksenteon tukityökalu. Jatkohoidon ja seurannan tarve arvioidaan yksilöllisesti ottaen huomioon potilaan ikä, oletettavissa oleva jäljellä oleva elinikä ja perussairaudet.
                    </div>
                </div>
            </main>

            <!-- Section 3.1: Surgical Planning -->
            <main id="surgical-planning" class="content-section">
                <h2 class="section-title">Kirurginen hoito</h2>
                <form id="treatmentForm">
                    <section class="form-section">
                        <h2>Kasvaimen ominaisuudet</h2>

                        <div class="form-group">
                            <label for="tumorSize">Kasvaimen koko (mm):</label>
                            <input type="number" id="tumorSize" name="tumorSize" min="1" max="100" required>
                            <span class="helper-text">Syötä kasvaimen suurin halkaisija millimetreinä</span>
                        </div>

                        <div class="form-group">
                            <label for="tumorType">Histologinen tyyppi:</label>
                            <select id="tumorType" name="tumorType" required>
                                <option value="">Valitse...</option>
                                <option value="papillary">Papillaarinen</option>
                                <option value="follicular">Follikulaarinen</option>
                            </select>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>Riskitekijät</h2>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFactor" value="extrathyroidal">
                                Ekstrathyreoidaalinen leviäminen
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFactor" value="vascular">
                                Verisuoniinvaasio
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFactor" value="lymphNode">
                                Imusolmukevetäytyneisyys (N+)
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFactor" value="braf">
                                BRAF-mutaatio
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFactor" value="aggressive">
                                Aggressiivinen histologia (tall cell, columnar cell, hobnail)
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFactor" value="familyHistory">
                                Kilpirauhassyöpä suvussa
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFactor" value="radiation">
                                Aiempi kaulan säteilytys
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFactor" value="trachealContact">
                                Kosketus henkitorveen/ruokatorveen/rekurrenshermooon
                            </label>
                        </div>
                    </section>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">Laske suositus</button>
                        <button type="reset" class="btn-secondary">Tyhjennä</button>
                    </div>
                </form>

                <div id="result" class="result-container" style="display: none;">
                    <h2>Hoitosuositus</h2>
                    <div id="recommendation" class="recommendation"></div>
                    <div id="rationale" class="rationale"></div>
                    <div class="disclaimer">
                        <strong>Huomio:</strong> Tämä on päätöksenteon tukityökalu, joka perustuu Duodecimin käypä hoito -suositukseen.
                        Lopullinen hoitopäätös tulee tehdä yksilöllisesti huomioiden potilaan kokonaistilanne ja toiveet.
                    </div>
                </div>
            </main>

            <!-- Section 3.2: Lymph Node Dissection -->
            <main id="lymph-node-dissection" class="content-section">
                <h2 class="section-title">Imusolmukedissektio</h2>
                <div class="info-content">
                    <h3>Imusolmukkeisiin levinnyt kilpirauhassyöpä (cN1a-N1b)</h3>
                    <ul>
                        <li><strong>Primaarituumorin hoitona on aina kilpirauhasen poisto</strong></li>
                        <li>Leikkauksen suunnittelu voi vaatia lisäkuvantamista (tietokonetomografia tai magneettitutkimus)</li>
                        <li>Imusolmukkeisiin levinneellä kilpirauhassyövällä tarkoitetaan tilannetta, jossa todetaan makrometastaasi tai yli neljä mikrometastaasia (&gt;2 mm)</li>
                        <li><strong>Keskitettävä aina dissektioita tekeville kirurgeille</strong></li>
                    </ul>

                    <h3>Sentraalisen alueen metastasointi (cN1a)</h3>
                    <ul>
                        <li>Sentraalisen alueen imusolmukedissektio (VI)</li>
                        <li>Tarvittaessa jääleikevarmistus leikkauksen aikana imusolmukkeesta, jos kliinisesti herää epäily metastasoinnista</li>
                        <li>Lisäkilpirauhasten havainnointi ja säilyttäminen on tärkeää</li>
                        <li>Tarvittaessa jääleike lisäkilpirauhasesta, jos harkitaan istutusta</li>
                    </ul>

                    <h3>Lateraalisen alueen metastasointi (cN1b)</h3>
                    <ul>
                        <li><strong>Neulanäytevarmistus ennen leikkausta</strong>, jos ei muuten varmaa kuvantamisen/kliinisen tilanteen perusteella
                            <ul>
                                <li>Myös ohutneulänäytteen tyreoglobuliini-määritystä voidaan käyttää</li>
                                <li>Vaihtoehtona jääleikevarmistus leikkauksen aikana</li>
                            </ul>
                        </li>
                        <li><strong>Dissektio tehdään alueille IIa-Vb potilaskohtaisesti:</strong>
                            <ul>
                                <li>Alue IIb poistetaan, mikäli todettu metastasointi alueella IIa tai IIb</li>
                                <li>Potilaskohtaista harkintaa käyttäen voidaan joissakin tapauksissa tehdä rajatumpikin dissektio</li>
                                <li>I / Va vain jos niissä tautia</li>
                            </ul>
                        </li>
                        <li><strong>Aina myös sentraalisen alueen dissektio (VI)</strong></li>
                    </ul>

                    <h3>Profylaktinen imusolmukedissektio (cN0)</h3>
                    <ul>
                        <li>Riskiarvion perusteella voidaan harkita sentraalisen alueen dissektiota (VI-alue):
                            <ul>
                                <li>Suuri tai infiltratiivinen kasvain (&gt;4 cm, T3-4)</li>
                                <li>Ikä &lt;15 vuotta</li>
                            </ul>
                        </li>
                        <li><strong>Lateraaliselle alueelle (II-V) ei suositella profylaktista dissektiota</strong></li>
                    </ul>

                    <h3>Esofagus/trakeainfiltraatio</h3>
                    <ul>
                        <li>Esofagus/trakearesektio on ensisijainen hoitomuoto, mutta hyödyt ja haitat on punnittava potilaskohtaisesti</li>
                        <li>Leikkaukset on keskitettävä yksiköihin, joissa on ilmatie- ja ruokatorvikirurgian korkeatasoista osaamista</li>
                        <li>Moniammatillisen työryhmän arviota suositellaan ennen leikkausta</li>
                        <li>Sytoreduktiivinen (nonradikaali) kirurgia voi hyödyttää radiojodiherkissä kasvaimissa</li>
                    </ul>

                    <h3>Primaaristi etäpesäkkeinen kilpirauhassyöpä (cM1)</h3>
                    <ul>
                        <li>Moniammatillinen työryhmä on hoitopäätöksissä olennainen - hoitopäätökset yksilöllisiä</li>
                        <li><strong>Pyritään aina kirurgiseen hoitoon, vähintään tyreoidektomiaan:</strong>
                            <ul>
                                <li>Radiojodi ei tehoa, jos kilpirauhanen tallella</li>
                                <li>Keuhkometastasointi on usein hillittävissä/parannettavissa radiojodilla</li>
                            </ul>
                        </li>
                        <li>Yksittäisten kaukometastaasien poistoa tai paikallistoimenpidettä tulisi harkita (esim. keuhko- tai maksametastaasit)</li>
                        <li>Murtumavaarallisten tai selkäydintä komprimoivien luustopesäkkeiden osalta tulee arvioida leikkaushoidon tarve sädehoidon lisäksi</li>
                    </ul>
                </div>
            </main>

            <!-- Section 3.3: Surgical Complications -->
            <main id="surgical-complications" class="content-section">
                <h2 class="section-title">Kirurgiset komplikaatiot</h2>
                <div class="info-content">
                    <h3>Tavallisimmat komplikaatiot</h3>

                    <h4>Lisäkilpirauhasen vajaatoiminta</h4>
                    <ul>
                        <li>Lisäkilpirauhasten vajaatoimintaa (ohimenevä ja pysyvä yhteensä) esiintyy kilpirauhasen syöpäkirurgian jälkeen noin <strong>14 %:lla</strong></li>
                        <li>Kilpirauhaskirurgiaan perehtyneissä yksiköissä pysyvän vajaatoiminnan määrä on <strong>2 % tai alle</strong></li>
                    </ul>

                    <h4>Palaavan kurkunpäähermon (recurrens-hermon) vaurio</h4>
                    <ul>
                        <li>Recurrens-hermon vaurioriski vaihtelee <strong>0.4–18 %:n</strong> välillä</li>
                        <li>Suurin osa vaurioista on toispuoleisia ja ohimeneviä</li>
                        <li>Pysyvien vaurioiden osuus on syöpäkirurgiassa <strong>1.2–8 %</strong></li>
                    </ul>

                    <h3>Harvinaisempia komplikaatioita</h3>
                    <ul>
                        <li>Ylemmän kurkunpäähermon vaurio</li>
                        <li>Sympaattisen hermorungon vaurio (Hornerin syndrooma)</li>
                        <li>Frenikus- tai akkessoriushermon vaurio</li>
                        <li>Trakeomalasian aiheuttama hengitysteiden ahtautuminen</li>
                        <li>Imutiehyeiden vauriot</li>
                    </ul>

                    <h3>Seurannassa ilmeneviä komplikaatioita</h3>
                    <ul>
                        <li>Leikkauksen jälkeinen vuoto</li>
                        <li>Leikkausalueen turvotus</li>
                        <li>Seroomamuodostus</li>
                        <li>Haavan paranemisongelmat ja tulehdukset</li>
                        <li>Leikkausasentoon ja kaulan hyperekstensioon liittyvät leikkauksen jälkeiset kivut ja päänsärky</li>
                    </ul>

                    <h3>Komplikaatioiden esto</h3>
                    <ul>
                        <li><strong>Leikkausten keskittäminen</strong> kirurgeille, jotka leikkaavat vähintään 25 kilpirauhasleikkausta vuodessa
                            <ul>
                                <li>Kokeneen kirurgin paremmat tulokset korostuvat erityisesti korkean riskin potilaiden leikkaushoidossa</li>
                            </ul>
                        </li>
                        <li><strong>Rutiininomainen recurrens-hermon identifiointi</strong>
                            <ul>
                                <li>Hermovaurion estossa kultaisena standardina pidetään recurrens-hermon systemaattista paljastamista leikkauksessa</li>
                                <li>Hermoa ei ole tarpeen irrottaa ympäröivästä kudoksesta, mutta sen kulku kurkunpäähän tulee selvittää</li>
                            </ul>
                        </li>
                        <li><strong>Lisäkilpirauhasten identifiointi ja verenkierron säästäminen</strong>
                            <ul>
                                <li>Lisäkilpirauhaset saavat verenkiertonsa pääasiassa alemmista kilpirauhasvaltimoista</li>
                                <li>Suonitus tulee katkaista mahdollisimman läheltä kilpirauhaskapselin pintaa</li>
                                <li>Mikäli lisäkilpirauhaseen menevä päätevaltimo vaurioituu, rauhanen on istutettava esim. sternokleidomastoideuslihakseen</li>
                            </ul>
                        </li>
                        <li><strong>Hermomonitoroinnin käyttö</strong>
                            <ul>
                                <li>Auttaa hermon anatomisen sijainnin määrittämisessä</li>
                                <li>Suositeltava erityisesti: kookas tuumori, uusintaleikkaus, haastava anatomia</li>
                            </ul>
                        </li>
                        <li><strong>Huolellinen hemostaasi</strong>
                            <ul>
                                <li>Leikkauksen jälkeinen vuoto voi kaulan alueella johtaa nopeasti hengitysvaikeuteen</li>
                            </ul>
                        </li>
                    </ul>

                    <h3>Komplikaatioiden hoito</h3>

                    <h4>Leikkauksen jälkeinen seuranta</h4>
                    <ul>
                        <li>Vuoto, verenpurkauma tai serooma voivat ahtauttaa hengitysteitä ja vaatia nopeita toimenpiteitä (esim. kirurgisen haavan avauksen)</li>
                    </ul>

                    <h4>Recurrens-hermon vaurio</h4>
                    <ul>
                        <li>Hoito tähtää äänen laadun ja heikkouden korjaamiseen sekä aspiraatioriskin vähentämiseen</li>
                        <li>Alussa oleellista on <strong>ääniterapia</strong></li>
                        <li>Mikäli tilanne ei yhdessä vuodessa korjaudu, voidaan harkita kajoavaa hoitoa</li>
                        <li>Kajoavaa hoitoa voidaan harkita varhaisessakin vaiheessa, esim. työkyvyn palauttamiseksi resorboituvalla materiaalilla tehtävällä injektiolaryngoplastialla</li>
                        <li>Molemminpuoleisessa vauriossa etsitään kompromissi riittävän hengitystien ja äänen välillä</li>
                    </ul>
                </div>
            </main>

            <!-- Section 3.4: Calcium Management -->
            <main id="calcium-management" class="content-section">
                <h2 class="section-title">Postoperatiivinen kalsiumin hallinta</h2>

                <form id="calciumForm">
                    <section class="form-section">
                        <h2>Postoperatiiviset laboratorioarvot (1. POP-päivä)</h2>

                        <div class="form-group">
                            <label for="calciumLevel">Plasman/Seerumin Ca++ (mmol/l):</label>
                            <input type="number" id="calciumLevel" name="calciumLevel" step="0.01" min="0.5" max="2.0" required>
                            <span class="helper-text">Ionisoitunut kalsium 1. postoperatiivisena päivänä</span>
                        </div>

                        <div class="form-group">
                            <label for="pthLevel">PTH-pitoisuus (pmol/l):</label>
                            <input type="number" id="pthLevel" name="pthLevel" step="0.01" min="0" max="20">
                            <span class="helper-text">Parathormonipitoisuus 1. postoperatiivisena päivänä (valinnainen)</span>
                        </div>
                    </section>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">Laske hoitosuositus</button>
                        <button type="button" onclick="document.getElementById('calciumForm').reset(); document.getElementById('calciumResult').style.display='none';" class="btn-secondary">Tyhjennä</button>
                    </div>
                </form>

                <div id="calciumResult" class="result-container" style="display: none;">
                    <h2>Kalsiumkorvaussuositus</h2>
                    <div id="calciumRecommendation" class="recommendation"></div>
                    <div id="calciumRationale" class="rationale"></div>
                    <div class="disclaimer">
                        <strong>Huomio:</strong> Tämä on päätöksenteon tukityökalu. Hoitopäätökset tehdään yksilöllisesti kliinisen tilanteen perusteella.
                    </div>
                </div>

                <div class="info-content" style="margin-top: 30px; border-top: 2px solid #e0e0e0; padding-top: 20px;">
                    <h3>Yleisohje postoperatiivisen hypokalsemian hoitoon</h3>
                    <ul>
                        <li>Ohje koskee totaalityreoidektomiaa tai täydentävää kilpirauhaskirurgiaa</li>
                        <li><strong>D-vitamiinipuutteen korjaaminen ennen kirurgiaa</strong> vähentää vaikeaa postoperatiivista hypoparatyreosia</li>
                        <li>Kalsiumpitoisuuden mittaaminen ennen kirurgiaa on suositeltavaa primaarin hyperparatyreoosin yleisyyden vuoksi</li>
                        <li>Jokaiselta potilaalta mitataan 1. postoperatiivisena päivänä seerumin kalsium ja parathormonipitoisuus (PTH)</li>
                    </ul>

                    <h3>PTH-pitoisuuden merkitys</h3>
                    <ul>
                        <li>PTH &lt; 0.58 pmol/l tai 70% lasku preoperatiivisesta assosioituu pysyvän hypoparatyreoosin riskiin</li>
                        <li>PTH &gt; 1.06 pmol/l 1. pop:na ennustaa normalia lisäkilpirauhasen toimintaa 6 kk kuluttua</li>
                        <li>Plasman kalsiumpitoisuuden minimi saavutetaan vasta 24-72 tunnissa</li>
                    </ul>

                    <h3>Hypokalsemia vuodeosastolla</h3>
                    <ul>
                        <li>Jos Ca++ &lt; 1.05 mmol/l: potilasta ei kotiuteta</li>
                        <li>Aloitetaan kalsium-D-vitamiinivalmisteen rinnalle <strong>alfakalsidoli 0.5 µg × 2</strong></li>
                        <li>Ionisoitunut kalsium tutkitaan joka aamu</li>
                        <li>Vaikean hypokalsemian yhteydessä voidaan tarvita tilapäisesti kalsiuminfuusiota</li>
                        <li>Potilas voidaan kotiuttaa vasta kun Ca++ ≥ 1.05 mmol/l</li>
                    </ul>

                    <h3>Pysyvä postoperatiivinen hypoparatyreoosi</h3>
                    <ul>
                        <li>Seuranta yhdistetään kilpirauhassyövän seurantaan</li>
                        <li>Tavoitellaan plasman kalsium- ja fosforipitoisuuksia viitealueella</li>
                        <li>Vuorokausivirtsan kalsiumeritys normaali</li>
                        <li>B-todistus kalsium- ja D-vitamiinivalmisteiden erityiskorvattavuutta varten, jos hypoparatyreoosi jatkuu yli 1-2 kk</li>
                    </ul>

                    <h3>Lääkityksen ajoitus</h3>
                    <ul>
                        <li><strong>Tyroksiini tulee ottaa vähintään 4 tuntia ennen kalsiumvalmistetta</strong> imeytymisen varmistamiseksi</li>
                    </ul>
                </div>
            </main>

            <!-- Section 4.1: Pathology Report -->
            <main id="pathology-report" class="content-section">
                <h2 class="section-title">PAD-lausunto</h2>
                <div class="info-content">
                    <h3>Preparaatin lähettäminen patologille</h3>
                    <p>Esitietojen tulisi sisältää:</p>
                    <ul>
                        <li>Leikkausindikaatio ja aiempi ONB-vastaus (Bethesda-luokka)</li>
                        <li>Kuvaus malignisuspektien pesäkkeiden määrästä, sijainnista, koosta ja suhteesta kilpirauhasen ympäristöön ja kirurgisiin marginaaleihin</li>
                        <li>Tiedot muista todetuista maligniteeteista</li>
                        <li>Tiedot muista kilpirauhassairauksista ja kilpirauhaseen vaikuttavista systeemisairauksista</li>
                        <li>Onko tiedossa syöpäaltiussyndroomaa tai suvussa kilpirauhassyöpää</li>
                    </ul>

                    <h3>Preparaatin merkinnät</h3>
                    <ul>
                        <li><strong>Lohkot identifioidaan:</strong> lohkot eri purkkeihin tai lankamerkintä oikeaan lohkoon</li>
                        <li><strong>Muut identifioinnit:</strong> lankamerkintä epäillyn marginaalipositiivisuuden tai kilpirauhasen ulkopuolisen kasvun alueille</li>
                    </ul>

                    <h3>Jääleike kilpirauhasesta</h3>
                    <ul>
                        <li>Voi pyytää, jos vastaus vaikuttaa leikkauksen kulkuun</li>
                        <li><strong>Ei hyötyä</strong> follikulaarisen tai onkosyyttisen neoplasian invasiivisuuden arvioinnissa</li>
                        <li>Voi olla hyötyä muiden syöpäepäilyiden arvioinnissa, mutta arvio on epävarmempi kuin formaliiniksiksoidusta materiaalista</li>
                    </ul>

                    <h3>Strukturoitu PAD-lausunto</h3>
                    <table class="pad-table">
                        <tr>
                            <th>Ominaisuus</th>
                            <th>Vaihtoehdot</th>
                        </tr>
                        <tr>
                            <td><strong>Histologinen tyyppi</strong></td>
                            <td>Papillaarinen, Follikulaarinen, Onkosyyttinen, Huonosti erilaistunut, Erilaistumaton, Medullaarinen</td>
                        </tr>
                        <tr>
                            <td><strong>Papillaarisen karsinooman alatyyppi</strong></td>
                            <td>Korkeasoluinen (tall cell), Diffuusi sklerosoiva, Kiinteä (solid), Nuppisoluinen (hobnail), Lieriösoluinen (columnar cell)</td>
                        </tr>
                        <tr>
                            <td><strong>Follik./onkos. invaasiotyyppi</strong></td>
                            <td>Minimaalisesti invasiivinen, Kapseloitunut angioinvasiivinen, Laajasti invasiivinen</td>
                        </tr>
                        <tr>
                            <td><strong>Kasvaimen sijainti</strong></td>
                            <td>Oikea lohko, Vasen lohko, Istmus, Bilateraalinen</td>
                        </tr>
                        <tr>
                            <td><strong>Kasvaimen koko</strong></td>
                            <td>Suurin läpimitta mm</td>
                        </tr>
                        <tr>
                            <td><strong>Verisuoni-invaasio</strong></td>
                            <td>Ei / Kyllä, 1-3 suonessa / Kyllä, yli 3 suonessa</td>
                        </tr>
                        <tr>
                            <td><strong>Kasvu kilpirauhasen ulkopuolelle</strong></td>
                            <td>Ei / Vain mikroskooppinen / Makroskooppinen</td>
                        </tr>
                        <tr>
                            <td><strong>Marginaalipositiivisuus</strong></td>
                            <td>Ei (R0) / Mikroskooppinen (R1) / Makroskooppinen (R2)</td>
                        </tr>
                        <tr>
                            <td><strong>BRAF V600E</strong></td>
                            <td>Positiivinen / Negatiivinen / Epäselvä / Ei tehty</td>
                        </tr>
                        <tr>
                            <td><strong>Imusolmukkeet</strong></td>
                            <td>Tutkittujen lkm, Metastaattisten lkm, pN-luokka</td>
                        </tr>
                        <tr>
                            <td><strong>Metastaasin koko</strong></td>
                            <td>&lt;2 mm / 2-30 mm / &gt;30 mm</td>
                        </tr>
                        <tr>
                            <td><strong>Ekstrakapsulaarinen kasvu</strong></td>
                            <td>Ei / Kyllä</td>
                        </tr>
                    </table>

                    <h3>Immunohistokemialisia tutkimuksia</h3>
                    <ul>
                        <li><strong>BRAF V600E:</strong> Suositellaan tehtävän ≥2 cm papillaarisista karsinoomista</li>
                        <li><strong>TTF1 ja PAX8:</strong> Positiivisia kaikissa follikkeliepiteelisuuntaan erilaistuvissa karsinoomissa</li>
                        <li><strong>Tyreoglobuliini:</strong> Yleensä positiivinen hyvin erilaistuneissa karsinoomissa</li>
                        <li><strong>Kalsitoniini:</strong> Positiivinen medullaarisissa karsinoomissa</li>
                    </ul>

                    <h3>Genetiikan tutkimuksia</h3>
                    <ul>
                        <li>Kasvaimen mutaatiotutkimukset tehdään hoitavan lääkärin pyynnöstä</li>
                        <li>Liittyvät yleensä levinneiden radiojodiresistenttien karsinoomien onkologisen hoidon suunnitteluun</li>
                        <li><strong>BRAF V600E -mutaatio:</strong> BRAF- ja MEK-estäjälääkitykset</li>
                        <li><strong>NTRK-tutkimus:</strong> NTRK-estäjälääkitys</li>
                        <li><strong>RET-fuusiogeenitutkimus:</strong> RET-estäjälääkitys</li>
                    </ul>
                </div>
            </main>

            <!-- Section 4.2: TNM Staging -->
            <main id="tnm-staging" class="content-section">
                <h2 class="section-title">TNM-luokitus ja levinneisyysaste</h2>

                <form id="tnmForm">
                    <section class="form-section">
                        <h2>Potilaan tiedot</h2>
                        <div class="form-group">
                            <label for="tnmAge">Potilaan ikä (vuotta):</label>
                            <input type="number" id="tnmAge" name="tnmAge" min="1" max="120" required>
                            <span class="helper-text">Ikä diagnooshetkellä (raja-arvo 55 vuotta)</span>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>T-luokka (primaarikasvain)</h2>
                        <div class="form-group">
                            <label for="tClass">Valitse T-luokka:</label>
                            <select id="tClass" name="tClass" required>
                                <option value="">Valitse...</option>
                                <option value="T1a">T1a - ≤1 cm, rajoittuu kilpirauhaseen</option>
                                <option value="T1b">T1b - &gt;1 cm, ≤2 cm, rajoittuu kilpirauhaseen</option>
                                <option value="T2">T2 - &gt;2 cm, ≤4 cm, rajoittuu kilpirauhaseen</option>
                                <option value="T3a">T3a - &gt;4 cm, rajoittuu kilpirauhaseen</option>
                                <option value="T3b">T3b - Makroskooppinen kasvu kilpirauhasta ympäröiviin lihaksiin</option>
                                <option value="T4a">T4a - Kasvu ihonalaisiin pehmytkudoksiin, kurkunpäähän, henkitorveen, ruokatorveen tai recurrens-hermoon</option>
                                <option value="T4b">T4b - Kasvu prevertebraalifaskiaan, carotis-valtimon ympäri tai mediastinaalisiin suoniin</option>
                            </select>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>N-luokka (imusolmukkeet)</h2>
                        <div class="form-group">
                            <label for="nClass">Valitse N-luokka:</label>
                            <select id="nClass" name="nClass" required>
                                <option value="">Valitse...</option>
                                <option value="N0">N0 - Ei imusolmukemetastaaseja</option>
                                <option value="N1a">N1a - Metastaasi mediaalisessa regiossa (VI) tai ylämediastinumissa (VII)</option>
                                <option value="N1b">N1b - Metastaasi lateraalisissa regioissa (I-V) tai retrofaryngeaalisesti</option>
                            </select>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>M-luokka (etäpesäkkeet)</h2>
                        <div class="form-group">
                            <label for="mClass">Valitse M-luokka:</label>
                            <select id="mClass" name="mClass" required>
                                <option value="">Valitse...</option>
                                <option value="M0">M0 - Ei etäpesäkkeitä</option>
                                <option value="M1">M1 - Etäpesäkkeitä todettu</option>
                            </select>
                        </div>
                    </section>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">Laske levinneisyysaste</button>
                        <button type="button" onclick="document.getElementById('tnmForm').reset(); document.getElementById('tnmResult').style.display='none';" class="btn-secondary">Tyhjennä</button>
                    </div>
                </form>

                <div id="tnmResult" class="result-container" style="display: none;">
                    <h2>Levinneisyysaste</h2>
                    <div id="tnmRecommendation" class="recommendation"></div>
                    <div id="tnmRationale" class="rationale"></div>
                    <div class="disclaimer">
                        <strong>Huomio:</strong> TNM-luokitus perustuu AJCC/UICC 8. painokseen (2017). Koskee papillaarista ja follikulaarista kilpirauhassyöpää.
                    </div>
                </div>

                <div class="info-content" style="margin-top: 30px; border-top: 2px solid #e0e0e0; padding-top: 20px;">
                    <h3>TNM-luokituksen perusteet</h3>
                    <table class="pad-table">
                        <tr>
                            <th>T-luokka</th>
                            <th>Määritelmä</th>
                        </tr>
                        <tr>
                            <td>T1</td>
                            <td>≤2 cm, rajoittuu kilpirauhaseen (T1a ≤1 cm, T1b &gt;1 cm)</td>
                        </tr>
                        <tr>
                            <td>T2</td>
                            <td>&gt;2 cm, ≤4 cm, rajoittuu kilpirauhaseen</td>
                        </tr>
                        <tr>
                            <td>T3a</td>
                            <td>&gt;4 cm, rajoittuu kilpirauhaseen</td>
                        </tr>
                        <tr>
                            <td>T3b</td>
                            <td>Makroskooppinen kasvu kilpirauhasta ympäröiviin lihaksiin</td>
                        </tr>
                        <tr>
                            <td>T4a</td>
                            <td>Kasvu ihonalaisiin pehmytkudoksiin, kurkunpäähän, henkitorveen, ruokatorveen tai recurrens-hermoon</td>
                        </tr>
                        <tr>
                            <td>T4b</td>
                            <td>Kasvu prevertebraalifaskiaan, carotis-valtimon ympäri tai mediastinaalisiin suoniin</td>
                        </tr>
                    </table>

                    <h3>Levinneisyysaste iän mukaan</h3>
                    <table class="pad-table">
                        <tr>
                            <th>Aste</th>
                            <th>Ikä &lt;55 vuotta</th>
                            <th>Ikä ≥55 vuotta</th>
                        </tr>
                        <tr>
                            <td><strong>I</strong></td>
                            <td>T1-4 N0-1 M0</td>
                            <td>T1-2 N0 M0</td>
                        </tr>
                        <tr>
                            <td><strong>II</strong></td>
                            <td>T1-4 N0-1 M1</td>
                            <td>T3 N0 M0 tai T1-3 N1 M0</td>
                        </tr>
                        <tr>
                            <td><strong>III</strong></td>
                            <td>-</td>
                            <td>T4a N0-1 M0</td>
                        </tr>
                        <tr>
                            <td><strong>IVA</strong></td>
                            <td>-</td>
                            <td>T4b N0-1 M0</td>
                        </tr>
                        <tr>
                            <td><strong>IVB</strong></td>
                            <td>-</td>
                            <td>T1-4 N0-1 M1</td>
                        </tr>
                    </table>
                </div>
            </main>

            <!-- Section 4.3: Histological Subtypes -->
            <main id="histological-subtypes" class="content-section">
                <h2 class="section-title">Histologiset alatyypit</h2>
                <div class="info-content">
                    <h3>Kilpirauhassyövän WHO-luokitus (2022)</h3>
                    <p>Uusi WHO-luokitus ilmestyi 2022. Hoitoon vaikuttavia muutoksia ovat laajentuneet huonosti erilaistuneiden (high-grade) karsinoomien kriteerit sekä papillaarisen karsinooman alatyyppien luokittelumuutokset.</p>

                    <h3>Papillaarisen karsinooman alatyypit</h3>
                    <p>Raportoitavat alatyypit, joihin liittyy aikuisilla klassista tyyppiä suurempi uusiutumis- tai metastaasiriski:</p>
                    <table class="pad-table">
                        <tr>
                            <th>Alatyyppi</th>
                            <th>Tunnuspiirteet</th>
                            <th>Kliininen merkitys</th>
                        </tr>
                        <tr>
                            <td><strong>Korkeasoluinen (tall cell)</strong></td>
                            <td>Solut 3× korkeampia kuin leveämpiä, juostemaiset rakenteet, eosinofiilinen sytoplasma. Vähintään 30% kasvainalasta.</td>
                            <td>Yleisin aggressiivinen alatyyppi (5-10% papillaarisista). Kohonnut uusiutumisriski.</td>
                        </tr>
                        <tr>
                            <td><strong>Diffuusi sklerosoiva</strong></td>
                            <td>Laaja skleroosi, usein molemmissa lohkoissa, runsaasti psammomaatteja.</td>
                            <td>Usein nuorilla, metastasoi imusolmukkeisiin.</td>
                        </tr>
                        <tr>
                            <td><strong>Kiinteä (solid)</strong></td>
                            <td>Yli 50% kiinteää kasvutapaa.</td>
                            <td>Aggressiivisempi käytös.</td>
                        </tr>
                        <tr>
                            <td><strong>Nuppisoluinen (hobnail)</strong></td>
                            <td>Yli 30% hobnail-kasvutapaa, solut pullistuvat pintaan.</td>
                            <td>Huono ennuste.</td>
                        </tr>
                        <tr>
                            <td><strong>Lieriösoluinen (columnar cell)</strong></td>
                            <td>Korkeat lieriömäiset solut stratifioituneina.</td>
                            <td>Harvinainen, aggressiivinen.</td>
                        </tr>
                    </table>

                    <h3>Kapseloituneet follikulaariset ja onkosyyttiset kasvaimet</h3>
                    <p>Invaasiotyyppi määrittää ennusteen:</p>
                    <ul>
                        <li><strong>Minimaalisesti invasiivinen:</strong> Vain mikroskooppinen kasvainkapseli-invaasio - hyvä ennuste</li>
                        <li><strong>Angioinvasiivinen:</strong> Mikroskooppinen verisuoni-invaasio
                            <ul>
                                <li>1-3 suonessa: kohtalainen riski</li>
                                <li>≥4 suonessa: korkea riski</li>
                            </ul>
                        </li>
                        <li><strong>Laajasti invasiivinen:</strong> Laaja makroskooppisesti tunnistettava invaasio - korkea riski</li>
                    </ul>

                    <h3>Huonosti erilaistuneet karsinoomat (WHO 2022)</h3>
                    <p>Kaksi kategoriaa:</p>

                    <h4>1. DHGTC (Differentiated High-Grade Thyroid Carcinoma)</h4>
                    <ul>
                        <li>Follikkeliepiteelisuuntaan erilaistuva karsinooma, jossa:
                            <ul>
                                <li>≥5 mitoosia per 2 mm² TAI</li>
                                <li>Tuoretta spontaania kasvainnekroosia</li>
                            </ul>
                        </li>
                        <li>Histologisesti erilaistuneen karsinooman kaltainen</li>
                        <li>Alatyypit: huonosti erilaistunut papillaarinen/follikulaarinen/onkosyyttinen</li>
                    </ul>

                    <h4>2. PDTC (Torinon kriteerit)</h4>
                    <ul>
                        <li>Kiinteä (solid), saarekkeinen (insular) tai juosteinen (trabecular) kasvutapa</li>
                        <li>≥3 mitoosia per 2 mm² TAI kasvainnekroosia TAI rusinamainen tuma-atypia</li>
                        <li>EI papillaariselle karsinoomalle tyypillistä tuma-atypiaa</li>
                    </ul>

                    <h3>Rajalaatuiset kasvaimet</h3>

                    <h4>NIFTP (Non-Invasive Follicular Thyroid Neoplasm with Papillary-like Nuclear Features)</h4>
                    <ul>
                        <li>Ei-invasiivinen, follikulaarisesti järjestyvä kasvain papillaarisen karsinooman tumapiirteillä</li>
                        <li>Uusiutuminen hyvin harvinaista (&lt;1%)</li>
                        <li>Poiston jälkeen kohdellaan kuten adenoomaa</li>
                        <li>Poissulkukriteerit: kapseli/verisuoni-invaasio, papillaarit rakenteet, psammomat, aggressiiviset kasvutavat, nekroosi, >3 mitoosia, BRAF V600E</li>
                    </ul>

                    <h4>UMP (Uncertain Malignant Potential)</h4>
                    <ul>
                        <li>Diagnostinen epävarmuus benignin ja malignin välillä</li>
                        <li>Epäilyttävä kapseli- tai verisuoni-invaasiolöydös, joka ei täytä varmoja kriteereitä</li>
                        <li>Uusiutumisriski pieni - johtaa usein seurantaan</li>
                    </ul>

                    <h3>Muut histopatologiset ennustetekijät</h3>
                    <ul>
                        <li><strong>Makroskooppinen kasvu kilpirauhasen ulkopuolelle:</strong> Merkittävä riskitekijä, vaikuttaa T-luokkaan</li>
                        <li><strong>Makroskooppinen marginaalipositiivisuus:</strong> Korkea uusiutumisriski</li>
                        <li><strong>Imusolmukemetastaasien koko:</strong>
                            <ul>
                                <li>&lt;2 mm mikrometastaasi: vähäinen merkitys</li>
                                <li>&gt;30 mm: suuri riski</li>
                                <li>Ekstrakapsulaarinen kasvu: suuri riski</li>
                            </ul>
                        </li>
                        <li><strong>BRAF V600E:</strong> 30-50% papillaarisista, suurempi uusiutumisriski ja huonompi ennuste</li>
                    </ul>
                </div>
            </main>

            <!-- Section 5.1: Risk Stratification -->
            <main id="risk-stratification" class="content-section">
                <h2 class="section-title">Riskiluokittelu radiojodihoidon suunnitteluun</h2>

                <form id="riskForm">
                    <section class="form-section">
                        <h2>Primaarikasvain</h2>

                        <div class="form-group">
                            <label for="riskTumorSize">Kasvaimen koko (mm):</label>
                            <input type="number" id="riskTumorSize" name="riskTumorSize" min="1" max="100" required>
                            <span class="helper-text">Suurin läpimitta millimetreinä</span>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFeature" value="macroMargin">
                                Makroskooppinen marginaalipositiivisuus (R2)
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFeature" value="extrathyroidal">
                                Kasvu kilpirauhasen ulkopuolelle (ekstratyroidaalinen invaasio)
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFeature" value="macroExtrathyroidal">
                                Makroskooppinen kasvu kilpirauhasen ulkopuolelle (pT3b tai suurempi)
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFeature" value="vascular13">
                                Verisuoni-invaasio (1-3 suonessa)
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFeature" value="vascular4plus">
                                Verisuoni-invaasio (≥4 suonessa)
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFeature" value="widelyInvasive">
                                Laajasti invasiivinen follikulaarinen/onkosyyttinen karsinooma
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFeature" value="poorlyDiff">
                                Huonosti erilaistunut (high-grade) karsinooma
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFeature" value="aggressive">
                                Aggressiivinen histologia ≥1 cm (tall cell, solid, hobnail, columnar cell, diffuusi sklerosoiva)
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFeature" value="braf2cm">
                                BRAF V600E -mutaatio ≥2 cm papillaarisessa karsinoomassa
                            </label>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>Imusolmukkeet</h2>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFeature" value="microMeta5">
                                Mikrometastaaseja (&lt;2 mm) ≥5 imusolmukkeessa
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFeature" value="macroMeta">
                                Makrometastaasi (≥2 mm) imusolmukkeessa
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFeature" value="largeMeta">
                                Yli 30 mm läpimittainen imusolmukemetastaasi
                            </label>
                        </div>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFeature" value="extracapsular">
                                Imusolmukemetastaasin ekstrakapsulaarinen kasvu
                            </label>
                        </div>
                    </section>

                    <section class="form-section">
                        <h2>Etäpesäkkeet</h2>

                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="riskFeature" value="distantMeta">
                                Etäpesäkkeet todettu (M1)
                            </label>
                        </div>
                    </section>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">Laske riskiluokka</button>
                        <button type="button" onclick="document.getElementById('riskForm').reset(); document.getElementById('riskResult').style.display='none';" class="btn-secondary">Tyhjennä</button>
                    </div>
                </form>

                <div id="riskResult" class="result-container" style="display: none;">
                    <h2>Riskiluokitus ja radiojodihoitosuositus</h2>
                    <div id="riskRecommendation" class="recommendation"></div>
                    <div id="riskRationale" class="rationale"></div>
                    <div class="disclaimer">
                        <strong>Huomio:</strong> Riskiluokitus määrittää radiojodihoidon tarpeen ja annettavan aktiivisuuden. Lopullinen päätös tehdään yksilöllisesti.
                    </div>
                </div>

                <div class="info-content" style="margin-top: 30px; border-top: 2px solid #e0e0e0; padding-top: 20px;">
                    <h3>Riskiluokituksen perusteet</h3>

                    <h4>Matala riski (uusimisriski &lt;6%)</h4>
                    <ul>
                        <li>Kasvain ≤4 cm, ei marginaalipositiivisuutta</li>
                        <li>Ei invaasiota kilpirauhasen ulkopuolelle</li>
                        <li>Ei verisuoni-invaasiota</li>
                        <li>Ei aggressiivista histologiaa ≥1 cm kasvaimessa</li>
                        <li>Ei BRAF V600E -mutaatiota ≥2 cm kasvaimessa</li>
                        <li>Ei makrometastaaseja imusolmukkeissa</li>
                        <li>Ei etäpesäkkeitä</li>
                    </ul>

                    <h4>Kohtalainen riski (uusimisriski 6-30%)</h4>
                    <ul>
                        <li>Kasvain &gt;4 cm</li>
                        <li>Mikroskooppinen kasvu kilpirauhasen ulkopuolelle</li>
                        <li>Verisuoni-invaasio 1-3 suonessa</li>
                        <li>Aggressiivinen histologia ≥1 cm kasvaimessa</li>
                        <li>BRAF V600E -mutaatio ≥2 cm kasvaimessa</li>
                        <li>Makrometastaasi imusolmukkeessa</li>
                        <li>Mikrometastaaseja ≥5 imusolmukkeessa</li>
                    </ul>

                    <h4>Korkea riski (uusimisriski &gt;30%)</h4>
                    <ul>
                        <li>Makroskooppinen marginaalipositiivisuus</li>
                        <li>Makroskooppinen kasvu kilpirauhasen ulkopuolelle (pT3b tai suurempi)</li>
                        <li>Verisuoni-invaasio ≥4 suonessa</li>
                        <li>Laajasti invasiivinen follikulaarinen/onkosyyttinen karsinooma</li>
                        <li>Huonosti erilaistunut karsinooma</li>
                        <li>Yli 30 mm läpimittainen imusolmukemetastaasi</li>
                        <li>Imusolmukemetastaasin ekstrakapsulaarinen kasvu</li>
                        <li>Etäpesäkkeet</li>
                    </ul>
                </div>
            </main>

            <!-- Section 5.2: RAI Indications -->
            <main id="rai-indications" class="content-section">
                <h2 class="section-title">Radiojodihoidon indikaatiot</h2>
                <div class="info-content">
                    <h3>Radiojodihoidon tavoitteet</h3>
                    <ol>
                        <li><strong>Ablaatio:</strong> Terveen kilpirauhaskudoksen hävittäminen seurannan herkistämiseksi</li>
                        <li><strong>Adjuvanttihoito:</strong> Mahdollisen mikroskooppisen syövän hävittäminen</li>
                        <li><strong>Makroskooppisen syövän hoito:</strong> Jäljellä olevan kasvainkudoksen tai etäpesäkkeiden hoito</li>
                    </ol>

                    <h3>Indikaatiot riskiluokittain</h3>

                    <h4>Matala riski</h4>
                    <ul>
                        <li><strong>&lt;1 cm:</strong> Radiojodihoitoa ei tarvita</li>
                        <li><strong>1-4 cm:</strong> Lähtökohtaisesti ei tarvita, jos:
                            <ul>
                                <li>Tyreoglobuliini &lt;0.2 µg/l postoperatiivisesti</li>
                                <li>Tyreoglobuliinivasta-aineet eivät koholla</li>
                            </ul>
                        </li>
                        <li>Jos Tg 0.2-2 µg/l: kontrolli 2 kk kuluttua</li>
                        <li>Jos Tg &gt;2 µg/l tai vasta-aineet koholla: radiojodihoito 1.1 GBq</li>
                    </ul>

                    <h4>Kohtalainen ja korkea riski</h4>
                    <ul>
                        <li>Radiojodihoito 3.7 GBq lähtökohtaisesti suositeltava</li>
                        <li>Kohtalaisessa riskissä voidaan harkita seurantaa poikkeustilanteissa:
                            <ul>
                                <li>Tyreoglobuliini stabiili &lt;2 µg/l</li>
                                <li>Vasta-aineet eivät koholla</li>
                                <li>Huolellinen seuranta järjestettävissä</li>
                            </ul>
                        </li>
                    </ul>

                    <h3>Radiojodihoidon kontraindikaatiot</h3>
                    <ul>
                        <li>Raskaus tai imetys</li>
                        <li>Potilas ei selviä säteilyeristyksestä</li>
                        <li>Vaikea munuaisten vajaatoiminta</li>
                        <li>Oireinen tai uhkaava sydämen vajaatoiminta</li>
                        <li>Muu akuutti sairaustila</li>
                    </ul>

                    <h3>Annettavat aktiivisuudet</h3>
                    <table class="pad-table">
                        <tr>
                            <th>Riskiluokka</th>
                            <th>Aktiivisuus</th>
                            <th>Indikaatio</th>
                        </tr>
                        <tr>
                            <td>Matala riski</td>
                            <td>1.1 GBq</td>
                            <td>Tarvittaessa (Tg &gt;2 tai vasta-aineet koholla)</td>
                        </tr>
                        <tr>
                            <td>Kohtalainen riski</td>
                            <td>3.7 GBq</td>
                            <td>Lähtökohtaisesti suositeltava</td>
                        </tr>
                        <tr>
                            <td>Korkea riski</td>
                            <td>3.7 GBq</td>
                            <td>Suositeltava vasta-aiheiden puuttuessa</td>
                        </tr>
                    </table>
                </div>
            </main>

            <!-- Section 5.3: TSH Stimulation -->
            <main id="tsh-stimulation" class="content-section">
                <h2 class="section-title">TSH-stimulaatio</h2>
                <div class="info-content">
                    <h3>TSH-stimulaation merkitys</h3>
                    <ul>
                        <li>Radiojodin kertyminen edellyttää TSH-stimulaatiota</li>
                        <li>Riittävä TSH-taso: <strong>&gt;30 mU/l</strong></li>
                        <li>TSH aktivoi kilpirauhaskudosta syntetisoimaan tyreoglobuliinia ja ottamaan jodia</li>
                    </ul>

                    <h3>Vaihtoehtoiset menetelmät</h3>

                    <h4>1. rhTSH-valmiste (Thyrogen®)</h4>
                    <ul>
                        <li><strong>Annostelu:</strong> 0.9 mg lihakseen × 2 annosta 24h välein</li>
                        <li><strong>Edut:</strong>
                            <ul>
                                <li>Potilas säilyy eutyreoottisena</li>
                                <li>Ei toimintahäiriöitä</li>
                                <li>Radiojodin nopeampi poistuminen</li>
                                <li>Pienempi luuydinaltistus</li>
                            </ul>
                        </li>
                        <li><strong>Rajoitukset:</strong> Samalla ei voi tehdä diagnostista kuvausta ja antaa hoitoannosta</li>
                        <li><strong>Suositeltava:</strong> pT1-3 N0-1 papillaarisessa/follikulaarisessa karsinoomassa</li>
                    </ul>

                    <h4>2. Tyroksiinitauko</h4>
                    <ul>
                        <li><strong>Kesto:</strong> 3-4 viikkoa TSH:n noustamiseksi &gt;30 mU/l:iin</li>
                        <li><strong>Edut:</strong> Mahdollisuus tehdä diagnostinen kuvaus ja hoito samalla tauolla</li>
                        <li><strong>Haitat:</strong>
                            <ul>
                                <li>Hypotyreoosin oireet (väsymys, alakuloisuus, ummetus, palelu, turvotukset)</li>
                                <li>Munuaistoiminnan hidastuminen</li>
                                <li>Pitempi sairasloma (4-5 viikkoa)</li>
                            </ul>
                        </li>
                    </ul>

                    <h3>rhTSH-stimulaation aikataulu radiojodihoidossa</h3>
                    <table class="pad-table">
                        <tr>
                            <th>Päivä</th>
                            <th>Toimenpide</th>
                        </tr>
                        <tr>
                            <td>Päivä 1</td>
                            <td>rhTSH 0.9 mg i.m.</td>
                        </tr>
                        <tr>
                            <td>Päivä 2</td>
                            <td>rhTSH 0.9 mg i.m.</td>
                        </tr>
                        <tr>
                            <td>Päivä 3</td>
                            <td>TSH ja s-Tg, sitten radiojodin hoitoannos</td>
                        </tr>
                        <tr>
                            <td>Päivä 10</td>
                            <td>Hoitoannoskuvaus (7 vrk hoidosta)</td>
                        </tr>
                    </table>

                    <h3>Vähäjodinen ruokavalio</h3>
                    <ul>
                        <li><strong>Kesto:</strong> 2 viikkoa ennen radiojodihoitoa</li>
                        <li><strong>Tavoite:</strong> &lt;50 µg jodia/vrk</li>
                        <li><strong>Päättyminen:</strong> Kotiutuessa radiojodihoidosta</li>
                    </ul>

                    <h4>Suositeltavia ruoka-aineita</h4>
                    <ul>
                        <li>Punainen liha, kana, kalkkuna</li>
                        <li>Pasta, viljaruuat, riisi</li>
                        <li>Juurekset, hedelmät, marjat, vihannekset</li>
                        <li>Jodittamaton suola</li>
                    </ul>

                    <h4>Vältettäviä ruoka-aineita</h4>
                    <ul>
                        <li>Joditettu suola, merisuola</li>
                        <li>Merestä saatava ruoka (kala, äyriäiset, merilevä)</li>
                        <li>Kananmunan keltuainen</li>
                        <li>Maito- ja meijerituotteet (paitsi pieniä määriä kahviin)</li>
                    </ul>

                    <h3>Varjoaineet ja lääkkeet</h3>
                    <ul>
                        <li>Jodia sisältäviä lääkkeitä vältettävä 2 viikkoa ennen hoitoa</li>
                        <li><strong>Amiodaroni:</strong> Varoaika 3-6 kk (pitkä puoliintumisaika)</li>
                        <li><strong>TT-varjoaineet:</strong> Radiojodihoito mahdollinen 1 kk kuluttua varjoainetutkimuksesta</li>
                    </ul>
                </div>
            </main>

            <!-- Section 5.4: Radiation Safety -->
            <main id="radiation-safety" class="content-section">
                <h2 class="section-title">Säteilysuojelu</h2>
                <div class="info-content">
                    <h3>Säteilyeristyksen periaatteet</h3>
                    <ul>
                        <li>Eristys yhden hengen potilashuoneessa (oma WC, eteistila, mielellään suihku)</li>
                        <li>Suurin osa aktiivisuudesta (&gt;90%) poistuu ensimmäisen vuorokauden aikana</li>
                        <li>Radiojodi erittyy virtsaan, ulosteeseen ja sylkeen</li>
                    </ul>

                    <h3>Eristyksen kesto</h3>
                    <table class="pad-table">
                        <tr>
                            <th>Aktiivisuus</th>
                            <th>Keskimääräinen minimieristysaika</th>
                        </tr>
                        <tr>
                            <td>1100 MBq (1.1 GBq)</td>
                            <td>24 h</td>
                        </tr>
                        <tr>
                            <td>3700 MBq (3.7 GBq)</td>
                            <td>48 h</td>
                        </tr>
                        <tr>
                            <td>5500 MBq (5.5 GBq)</td>
                            <td>72 h</td>
                        </tr>
                    </table>

                    <h3>Eristyksen purkamisen kriteerit</h3>
                    <ul>
                        <li>Radiojodin määrä alittaa 800 MBq</li>
                        <li>Annosnopeus &lt;40 µSv/h 1 m etäisyydellä</li>
                        <li>Joissakin sairaaloissa alaraja 400 MBq (&lt;20 µSv/h)</li>
                    </ul>

                    <h3>Potilasohjeet eristyksen aikana</h3>
                    <ul>
                        <li><strong>Nesteytys:</strong> Vähintään lasillinen nestettä joka tunti hereillä ollessa</li>
                        <li><strong>WC-hygienia:</strong> Virtsaa istualtaan, huuhtele 2-3 kertaa, pese kädet huolellisesti</li>
                        <li><strong>Pukeutuminen:</strong> Sairaalavaatteet ja sisäkengät</li>
                        <li><strong>Pyykki:</strong> Potilas kerää itse pyykit pusseihin</li>
                    </ul>

                    <h3>Kotiutuksen jälkeiset ohjeet (gammakuvaukseen asti)</h3>
                    <ul>
                        <li>Normaalia runsaampaa juomista ja tiheämpää virtsalla käyntiä</li>
                        <li>Ei pitkäaikaisia lähikontakteja (&lt;3 m, yli 2 h) muiden kanssa</li>
                        <li>Nukkuminen eri huoneessa</li>
                        <li>Ei lähikontakteja sylilapsen (&lt;2 v) tai raskaana olevan kanssa</li>
                        <li>Huolellinen WC-hygienia</li>
                    </ul>

                    <h3>Gammakuvauksen jälkeiset ohjeet</h3>
                    <p>Annosnopeusmittaus 1 m etäisyydellä (n. 1 viikko hoidosta):</p>
                    <ul>
                        <li><strong>&lt;0.3 µSv/h:</strong> Kaikki säteilytoimet voidaan lopettaa</li>
                        <li><strong>0.3-1 µSv/h:</strong> Ei lähikontakteja sylilapsen/raskaana olevien kanssa 4 pv</li>
                        <li><strong>1-4 µSv/h:</strong> Rajoitukset jatkuvat 7 pv</li>
                        <li><strong>&gt;4 µSv/h:</strong> Säteilysuojelutoimia jatketaan 2 viikkoa</li>
                    </ul>

                    <h3>Matkustaminen</h3>
                    <p>Jos ulkomaanmatka kuukauden sisällä hoidosta, mukana hyvä olla todistus radiojodihoidosta (mieluiten englanniksi) rajavalvontaa varten.</p>
                </div>
            </main>

            <!-- Section 6.1: Response Assessment -->
            <main id="response-assessment" class="content-section">
                <h2 class="section-title">Vastearviointi</h2>
                <div class="tool-container">
                    <div class="info-box">
                        <h4>Vastearvioinnin periaatteet</h4>
                        <ul>
                            <li>Vastearvio tehdään kaikille potilaille 8-12 kk leikkauksesta/radiojodihoidosta</li>
                            <li>Tavoite: Arvioida uudelleen uusimisriski ja ohjelmoida seurannan tiheys</li>
                        </ul>
                    </div>

                    <form id="responseForm" class="evaluation-form">
                        <div class="form-group">
                            <label>Onko potilas saanut radiojodihoitoa?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="hadRAI" value="yes" required> Kyllä</label>
                                <label><input type="radio" name="hadRAI" value="no"> Ei</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="suppressedTg">Tyroksiinin aikainen Tg (µg/l):</label>
                            <input type="number" id="suppressedTg" step="0.01" min="0" required>
                        </div>

                        <div class="form-group">
                            <label for="stimulatedTg">Stimuloitu Tg (µg/l) - jos mitattu:</label>
                            <input type="number" id="stimulatedTg" step="0.01" min="0" placeholder="Valinnainen">
                        </div>

                        <div class="form-group">
                            <label>TgAb (tyreoglobuliinivasta-aineet):</label>
                            <div class="radio-group">
                                <label><input type="radio" name="tgAb" value="negative" required> Negatiivinen</label>
                                <label><input type="radio" name="tgAb" value="stable"> Koholla, stabiili/laskeva</label>
                                <label><input type="radio" name="tgAb" value="rising"> Koholla, nousussa</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Kaulan ultraäänilöydös:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="ultrasound" value="normal" required> Normaali</label>
                                <label><input type="radio" name="ultrasound" value="suspicious"> Epäilyttävä löydös</label>
                                <label><input type="radio" name="ultrasound" value="positive"> Selvä tauti</label>
                            </div>
                        </div>

                        <div class="button-group">
                            <button type="submit" class="submit-btn">Arvioi vaste</button>
                            <button type="reset" class="reset-btn">Tyhjennä</button>
                        </div>
                    </form>

                    <div id="responseResult" class="result-container" style="display: none;">
                        <h3>Vastearvio:</h3>
                        <div id="responseRecommendation" class="recommendation"></div>
                        <div id="responseRationale" class="rationale"></div>
                    </div>
                </div>
            </main>

            <!-- Section 6.2: Surveillance Protocol -->
            <main id="surveillance-protocol" class="content-section">
                <h2 class="section-title">Seurantaprotokolla</h2>
                <div class="info-content">
                    <h3>Seurannan periaatteet</h3>
                    <ul>
                        <li>Seurannan tiheys ja sisältö määräytyvät primaarihoidon ja uusimisriskin perusteella</li>
                        <li>Tyroksiinilääkitys vaatii elinikäistä seurantaa 1-2 vuoden välein</li>
                        <li><strong>NIFTP</strong> ei edellytä seurantaa</li>
                        <li><strong>UMP</strong> seurataan kuten matalan riskin kasvaimia</li>
                    </ul>

                    <h3>Seuranta lobektomian jälkeen</h3>
                    <ul>
                        <li>TSH-tavoite: 0.5-2.0 mU/l</li>
                        <li>Vastearvio: kaulan UÄ 12 kk leikkauksesta</li>
                        <li><strong>T1aN0M0 (&lt;1 cm):</strong> UÄ normaali → PTH-seuranta</li>
                        <li><strong>T1b-T2N0M0 (1-4 cm):</strong> ESH-seuranta 3-5 vuotta, sitten PTH</li>
                        <li>PTH:ssa: TSH ja kaulan palpaatio 1-2 vuoden välein</li>
                    </ul>

                    <h3>Seuranta tyreoidektomian jälkeen (ei RAI)</h3>
                    <ul>
                        <li>Vastearvio 8-12 kk: UÄ + TSH + Tg + TyglAb</li>
                        <li><strong>Erinomainen vaste:</strong> ESH 3-5 vuotta, sitten PTH</li>
                        <li><strong>Epävarma vaste:</strong> Kontrolli 6-12 kk välein, harkitse RAI</li>
                    </ul>

                    <h3>Seuranta RAI:n jälkeen - Erinomainen vaste</h3>
                    <ul>
                        <li>Matala/keskikorkea riski: Tg + TyglAb 12-24 kk välein, UÄ harkiten 2-3 vuoden kuluttua</li>
                        <li>Korkea riski: Tg + TyglAb + UÄ 12 kk välein</li>
                        <li>TSH-tavoite: 0.5-2.0 mU/l</li>
                        <li>ESH-seuranta 3-5 vuotta, sitten PTH</li>
                    </ul>

                    <h3>Seuranta RAI:n jälkeen - Epävarma/epätäydellinen vaste</h3>
                    <ul>
                        <li>TSH, Tg, TyglAb + UÄ 6-12 kk välein</li>
                        <li>Noususuuntainen Tg/TyglAb → FDG-PET-TT, thorax-TT, kaulan MRI</li>
                        <li>Tarvittaessa uusinta-RAI (≥3.7 GBq)</li>
                        <li>TSH-tavoite: 0.1-0.5 mU/l</li>
                        <li>Seuranta ESH:ssa, 5-10 vuoden stabiilin tilanteen jälkeen harkiten PTH:oon</li>
                    </ul>
                </div>
            </main>

            <!-- Section 6.3: TSH Targets -->
            <main id="tsh-targets" class="content-section">
                <h2 class="section-title">TSH-tavoitteet</h2>
                <div class="tool-container">
                    <form id="tshForm" class="evaluation-form">
                        <div class="form-group">
                            <label>Leikkaustyyppi:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="surgeryType" value="lobectomy" required> Lobektomia</label>
                                <label><input type="radio" name="surgeryType" value="thyroidectomy"> Totaaliresektio</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Onko vastearvio tehty (8-12 kk leikkauksesta)?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="responseAssessed" value="no" required> Ei vielä</label>
                                <label><input type="radio" name="responseAssessed" value="yes"> Kyllä</label>
                            </div>
                        </div>

                        <div class="form-group" id="riskCategoryGroup">
                            <label>Riskiluokka (ennen vastearviota):</label>
                            <div class="radio-group">
                                <label><input type="radio" name="riskCategory" value="low"> Matala riski</label>
                                <label><input type="radio" name="riskCategory" value="intermediate"> Keskikorkea riski</label>
                                <label><input type="radio" name="riskCategory" value="high"> Korkea riski</label>
                            </div>
                        </div>

                        <div class="form-group" id="responseStatusGroup" style="display:none;">
                            <label>Vastearvion tulos:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="responseStatus" value="excellent"> Erinomainen vaste</label>
                                <label><input type="radio" name="responseStatus" value="indeterminate"> Epävarma tilanne</label>
                                <label><input type="radio" name="responseStatus" value="biochemical"> Biokemiallinen epätäydellinen</label>
                                <label><input type="radio" name="responseStatus" value="structural"> Mitattavaa tautia jäljellä</label>
                            </div>
                        </div>

                        <div class="button-group">
                            <button type="submit" class="submit-btn">Määritä TSH-tavoite</button>
                            <button type="reset" class="reset-btn">Tyhjennä</button>
                        </div>
                    </form>

                    <div id="tshResult" class="result-container" style="display: none;">
                        <h3>TSH-tavoite:</h3>
                        <div id="tshRecommendation" class="recommendation"></div>
                        <div id="tshRationale" class="rationale"></div>
                    </div>

                    <div class="info-box" style="margin-top: 20px;">
                        <h4>TSH-suppressiohoidon haitat</h4>
                        <ul>
                            <li>Sydän- ja verisuonisairastavuus voi lisääntyä</li>
                            <li>Osteoporoosiriski voi kohota</li>
                            <li>Hoito suunnitellaan yksilöllisesti huomioiden syövän ennuste ja oheisriskit</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <h4>Tyroksiiniannostus käytännössä</h4>
                        <ul>
                            <li><strong>Aloitus:</strong> 100 µg × 2 vko, sitten 150 µg (200 µg jos &gt;100 kg)</li>
                            <li>Annoksen säätö TSH-, T4v- ja T3v-kokeiden perusteella</li>
                            <li>Muutostarpeen arvio vasta 6-8 viikon kuluttua edellisestä muutoksesta</li>
                        </ul>
                    </div>
                </div>
            </main>

            <!-- Section 6.4: Imaging Surveillance -->
            <main id="imaging-surveillance" class="content-section">
                <h2 class="section-title">Kuvantamisseuranta</h2>
                <div class="info-content">
                    <h3>Kaulan ultraääni</h3>
                    <ul>
                        <li>Pääasiallinen seurantatutkimus - ei säteilyaltistusta, potilaalle vaivaton</li>
                        <li>Vastearviona kaikille 6-12 kk leikkauksesta/RAI:sta</li>
                        <li>Tämän jälkeen määräajoin riippuen uusimisriskistä ja Tg-tasosta</li>
                    </ul>

                    <h4>Paikallisresidiivi</h4>
                    <ul>
                        <li>Tyypillisesti pyöreä ja niukkakaikuinen</li>
                        <li>Mahdollisesti mikrokalkkeja tai kystisiä alueita</li>
                        <li>UÄ:llä vaikea erottaa arpikudoksesta → herkästi ONB</li>
                    </ul>

                    <h4>Metastaasisuspekti imusolmuke</h4>
                    <ul>
                        <li>Pyöristynyt, lyhyt akseli &gt;8-10 mm</li>
                        <li>Niukkakaikuinen tai kystinen</li>
                        <li>Perifeerinen tai vaihteleva verekkyys</li>
                        <li>Epäsäännölliset reunat, sisäinen rakenne</li>
                        <li>Rasvanidus hävinnyt</li>
                        <li>ONB jos &gt;8-10 mm + poikkeavia piirteitä</li>
                    </ul>

                    <h3>Tietokonetomografia</h3>
                    <ul>
                        <li>Erinomainen kohonneen Tg:n syyn etsimiseen</li>
                        <li>Keuhkometastaasien seurannassa (ilman varjoainetta)</li>
                        <li>Mediastinumin imusolmukemetastaasien arviointi</li>
                        <li><strong>Huom:</strong> Varjoainetta vältettävä jos RAI suunnitteilla 1 kk sisällä</li>
                    </ul>

                    <h3>Kaulan MRI</h3>
                    <ul>
                        <li>Laaja imusolmukemetastasointi - leikkaussuunnittelu</li>
                        <li>Invasiivinen paikallisresidiivi</li>
                        <li>UÄ negatiivinen mutta kliininen epäily imusolmukemetastaaseista</li>
                    </ul>

                    <h3>FDG-PET/TT</h3>
                    <ul>
                        <li><strong>Indikaatiot:</strong>
                            <ul>
                                <li>Tg koholla, radiojodikuvaus negatiivinen</li>
                                <li>Herkkyys kasvaa kun Tg ≥10 µg/l</li>
                                <li>Aggressiiviset syövät jo matalammilla Tg-tasoilla</li>
                                <li>TyglAb koholla, Tg mittaamaton</li>
                            </ul>
                        </li>
                        <li><strong>Ennusteellinen merkitys:</strong>
                            <ul>
                                <li>FDG-PET+ / RAI- = huonoin ennuste</li>
                                <li>FDG-PET- / RAI+ = paras ennuste</li>
                            </ul>
                        </li>
                        <li>TSH-stimulaatiota ei tarvita ennen FDG-PET/TT:tä</li>
                        <li>Positiivinen löydös syytä varmentaa ONB:lla ennen leikkauspäätöstä</li>
                    </ul>
                </div>
            </main>

            <!-- Section 7.1: Repeat Surgery -->
            <main id="repeat-surgery" class="content-section">
                <h2 class="section-title">Uusintaleikkaukset</h2>
                <div class="tool-container">
                    <div class="info-box">
                        <h4>Uusiutuneen kilpirauhassyövän leikkaushoito</h4>
                        <p><strong>Keskitettävä yliopistosairaaloihin.</strong> Ensisijainen hoito on kirurginen, pyritään ONB-varmistukseen.</p>
                    </div>

                    <form id="repeatSurgeryForm" class="evaluation-form">
                        <div class="form-group">
                            <label>Uusiutuman sijainti:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="recurrenceLocation" value="central"> Sentraalialue (taso VI)</label>
                                <label><input type="checkbox" name="recurrenceLocation" value="lateral"> Lateraalialue (tasot III-IV)</label>
                                <label><input type="checkbox" name="recurrenceLocation" value="thyroidBed"> Kilpirauhasen leikkausalue</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="nodeSize">Suurimman imusolmukkeen koko (mm):</label>
                            <input type="number" id="nodeSize" min="1" max="100" required>
                        </div>

                        <div class="form-group">
                            <label>Onko alue aiemmin leikattu?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="previousSurgery" value="no" required> Ei</label>
                                <label><input type="radio" name="previousSurgery" value="yes"> Kyllä</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Onko ONB-varmistus tehty?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="fnacConfirmed" value="yes" required> Kyllä, maligni</label>
                                <label><input type="radio" name="fnacConfirmed" value="suspicious"> Kyllä, epävarma</label>
                                <label><input type="radio" name="fnacConfirmed" value="no"> Ei vielä</label>
                            </div>
                        </div>

                        <div class="button-group">
                            <button type="submit" class="submit-btn">Arvioi leikkaustarve</button>
                            <button type="reset" class="reset-btn">Tyhjennä</button>
                        </div>
                    </form>

                    <div id="repeatSurgeryResult" class="result-container" style="display: none;">
                        <h3>Hoitosuositus:</h3>
                        <div id="repeatSurgeryRecommendation" class="recommendation"></div>
                        <div id="repeatSurgeryRationale" class="rationale"></div>
                    </div>

                    <div class="info-box" style="margin-top: 20px;">
                        <h4>Seurannan raja-arvot</h4>
                        <ul>
                            <li><strong>Sentraalialue:</strong> &lt;8 mm solmukkeita voi seurata UÄ:llä</li>
                            <li><strong>Lateraalialue:</strong> &lt;10 mm solmukkeita voi seurata UÄ:llä</li>
                        </ul>
                    </div>
                </div>
            </main>

            <!-- Section 7.2: Repeat RAI -->
            <main id="repeat-rai" class="content-section">
                <h2 class="section-title">Radiojodin uusinta</h2>
                <div class="tool-container">
                    <div class="info-box">
                        <h4>Yleiset periaatteet</h4>
                        <p>Radiojodihoitoja toistetaan kun syöpää on todennäköisesti jäljellä. Pitkäaikaishaitat korostuvat kumulatiivisen annoksen noustessa.</p>
                    </div>

                    <form id="repeatRaiForm" class="evaluation-form">
                        <div class="form-group">
                            <label for="stimTgLevel">Stimuloitu Tg (µg/l):</label>
                            <input type="number" id="stimTgLevel" step="0.1" min="0" required>
                        </div>

                        <div class="form-group">
                            <label>Tg:n trendi:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="tgTrendRai" value="decreasing" required> Laskeva</label>
                                <label><input type="radio" name="tgTrendRai" value="stable"> Stabiili</label>
                                <label><input type="radio" name="tgTrendRai" value="rising"> Nousussa</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>TgAb-status:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="tgAbRai" value="negative" required> Negatiivinen</label>
                                <label><input type="radio" name="tgAbRai" value="stable"> Koholla, stabiili</label>
                                <label><input type="radio" name="tgAbRai" value="rising"> Koholla, nousussa</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Etäpesäkkeet:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="metastases" value="none" required> Ei todettuja</label>
                                <label><input type="radio" name="metastases" value="lungMicro"> Keuhko, mikronodulaarinen (&lt;2 mm)</label>
                                <label><input type="radio" name="metastases" value="lungMacro"> Keuhko, makronodulaarinen</label>
                                <label><input type="radio" name="metastases" value="bone"> Luusto</label>
                                <label><input type="radio" name="metastases" value="other"> Muu (maksa, aivot)</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Kerävätkö pesäkkeet radiojodia?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="iodineAvid" value="yes" required> Kyllä</label>
                                <label><input type="radio" name="iodineAvid" value="no"> Ei (radiojodirefraktaari)</label>
                                <label><input type="radio" name="iodineAvid" value="unknown"> Ei tiedossa</label>
                            </div>
                        </div>

                        <div class="button-group">
                            <button type="submit" class="submit-btn">Arvioi RAI-tarve</button>
                            <button type="reset" class="reset-btn">Tyhjennä</button>
                        </div>
                    </form>

                    <div id="repeatRaiResult" class="result-container" style="display: none;">
                        <h3>Hoitosuositus:</h3>
                        <div id="repeatRaiRecommendation" class="recommendation"></div>
                        <div id="repeatRaiRationale" class="rationale"></div>
                    </div>
                </div>
            </main>

            <!-- Section 7.3: External Radiation -->
            <main id="external-radiation" class="content-section">
                <h2 class="section-title">Ulkoinen sädehoito</h2>
                <div class="tool-container">
                    <div class="info-box">
                        <h4>Sädehoidon indikaatiot</h4>
                        <p>Ulkoinen sädehoito harkitaan kun radiojodihoito ei ole tehokas ja leikkaus ei ole mahdollinen.</p>
                    </div>

                    <form id="radiationForm" class="evaluation-form">
                        <div class="form-group">
                            <label>Hoitokohde:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="radiationTarget" value="neck" required> Kaulan alue</label>
                                <label><input type="radio" name="radiationTarget" value="lung"> Keuhkopesäkkeet</label>
                                <label><input type="radio" name="radiationTarget" value="bone"> Luustopesäkkeet</label>
                                <label><input type="radio" name="radiationTarget" value="brain"> Aivopesäkkeet</label>
                                <label><input type="radio" name="radiationTarget" value="liver"> Maksapesäkkeet</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Pesäkkeiden lukumäärä:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="lesionCount" value="single" required> Yksittäinen</label>
                                <label><input type="radio" name="lesionCount" value="oligo"> Oligometastaattinen (2-4)</label>
                                <label><input type="radio" name="lesionCount" value="multiple"> Multippelit (&gt;4)</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Radiojodihoitovaste:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="raiResponse" value="avid" required> Kerää radiojodia</label>
                                <label><input type="radio" name="raiResponse" value="refractory"> Radiojodirefraktaari</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Onko leikkaus mahdollinen?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="surgeryPossible" value="yes" required> Kyllä</label>
                                <label><input type="radio" name="surgeryPossible" value="no"> Ei</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Oireisuus:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="symptoms" value="pain"> Kipu</label>
                                <label><input type="checkbox" name="symptoms" value="compression"> Paineoireet</label>
                                <label><input type="checkbox" name="symptoms" value="fracture"> Murtumariski</label>
                                <label><input type="checkbox" name="symptoms" value="neurological"> Neurologiset oireet</label>
                            </div>
                        </div>

                        <div class="button-group">
                            <button type="submit" class="submit-btn">Arvioi sädehoitotarve</button>
                            <button type="reset" class="reset-btn">Tyhjennä</button>
                        </div>
                    </form>

                    <div id="radiationResult" class="result-container" style="display: none;">
                        <h3>Hoitosuositus:</h3>
                        <div id="radiationRecommendation" class="recommendation"></div>
                        <div id="radiationRationale" class="rationale"></div>
                    </div>

                    <h3 style="margin-top: 20px;">Annokset (IMRT, 2 Gy fraktiot)</h3>
                    <table class="pad-table">
                        <tr><th>Kohdealue</th><th>Annos</th></tr>
                        <tr><td>Makroskooppinen kasvain</td><td>70 Gy</td></tr>
                        <tr><td>Korkean riskin alue (marginaali+)</td><td>66 Gy</td></tr>
                        <tr><td>Elektiivinen alue</td><td>54 Gy</td></tr>
                    </table>
                </div>
            </main>

            <!-- Section 7.4: Systemic Therapy -->
            <main id="systemic-therapy" class="content-section">
                <h2 class="section-title">Systeeminen hoito</h2>
                <div class="tool-container">
                    <div class="info-box">
                        <h4>Yleiset periaatteet</h4>
                        <p>Lääkehoito on pitkäkestoinen. <strong>Pelkkä Tg-nousu EI riitä indikaatioksi</strong> - tarvitaan etenevä tauti ja oireisuus/merkittävä tautitaakka.</p>
                    </div>

                    <form id="systemicForm" class="evaluation-form">
                        <div class="form-group">
                            <label>Radiojodihoitovaste:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="raiStatus" value="responsive" required> Reagoi radiojodille</label>
                                <label><input type="radio" name="raiStatus" value="refractory"> Radiojodirefraktaari</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Taudin progressio:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="progression" value="stable" required> Stabiili tauti</label>
                                <label><input type="radio" name="progression" value="slow"> Hidas progressio</label>
                                <label><input type="radio" name="progression" value="rapid"> Nopea progressio</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Onko tauti hallittavissa paikallishoidolla (kirurgia/sädehoito)?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="localControl" value="yes" required> Kyllä</label>
                                <label><input type="radio" name="localControl" value="no"> Ei</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Oireisuus ja tautitaakka:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="burden" value="symptomatic"> Oireinen potilas</label>
                                <label><input type="checkbox" name="burden" value="significant"> Merkittävä tautitaakka</label>
                                <label><input type="checkbox" name="burden" value="threatening"> Henkeä uhkaava sijainti</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Molekyylipatologiset löydökset (jos tutkittu):</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="molecular" value="ntrk"> NTRK-fuusio</label>
                                <label><input type="checkbox" name="molecular" value="ret"> RET-fuusio</label>
                                <label><input type="checkbox" name="molecular" value="braf"> BRAF V600E</label>
                            </div>
                        </div>

                        <div class="button-group">
                            <button type="submit" class="submit-btn">Arvioi lääkehoidon tarve</button>
                            <button type="reset" class="reset-btn">Tyhjennä</button>
                        </div>
                    </form>

                    <div id="systemicResult" class="result-container" style="display: none;">
                        <h3>Hoitosuositus:</h3>
                        <div id="systemicRecommendation" class="recommendation"></div>
                        <div id="systemicRationale" class="rationale"></div>
                    </div>

                    <h3 style="margin-top: 20px;">Lääkevaihtoehdot</h3>
                    <table class="pad-table">
                        <tr><th>Linja</th><th>Lääke</th><th>Annostus</th></tr>
                        <tr><td>1.</td><td>Lenvatinibi</td><td>24 mg × 1</td></tr>
                        <tr><td>1.</td><td>Sorafenibi</td><td>400 mg × 2</td></tr>
                        <tr><td>2. (NTRK+)</td><td>Larotrektinibi/Entrektinibi</td><td>-</td></tr>
                        <tr><td>2. (RET+)</td><td>Selperkatinibi</td><td>-</td></tr>
                    </table>
                </div>
            </main>

            <!-- Section 8.1: Genetic Predisposition -->
            <main id="genetic-predisposition" class="content-section">
                <h2 class="section-title">Geneettinen alttius kilpirauhassyövälle</h2>
                <div class="tool-container">
                    <div class="info-box">
                        <h4>FNMTC - Familiaalinen kilpirauhassyöpä</h4>
                        <p>Noin 3–10 % non-medullaarisista kilpirauhassyövistä on familiaalisia. Sukuhistoria vaikuttaa uusimisriskiin ja sukulaisten seulontatarpeeseen.</p>
                    </div>

                    <form id="geneticForm" class="evaluation-form">
                        <div class="form-group">
                            <label for="affectedRelatives">Kuinka monta ensimmäisen asteen sukulaista on sairastunut kilpirauhassyöpään?</label>
                            <select id="affectedRelatives" required>
                                <option value="">Valitse...</option>
                                <option value="0">Ei yhtään</option>
                                <option value="1">1 sukulainen</option>
                                <option value="2">2 sukulaista</option>
                                <option value="3">3 tai enemmän</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="youngestAge">Suvun nuorimman sairastuneen ikä diagnoosivaiheessa (jos tiedossa):</label>
                            <input type="number" id="youngestAge" min="1" max="100" placeholder="Valinnainen">
                        </div>

                        <div class="form-group">
                            <label>Onko suvussa tai potilaalla piirteitä kasvainalttiusoireyhtymästä?</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="syndromeFeature" value="fap"> GI-polyypit, osteoomat (FAP/Gardner)</label>
                                <label><input type="checkbox" name="syndromeFeature" value="cowden"> Multippelit hamartoomat, rintasyöpäalttius (Cowden)</label>
                                <label><input type="checkbox" name="syndromeFeature" value="carney"> Lisämunuaisen/aivolisäkkeen kasvaimet, myksoomat (Carney)</label>
                                <label><input type="checkbox" name="syndromeFeature" value="werner"> Ennenaikainen vanheneminen, sarkoomat (Werner)</label>
                                <label><input type="checkbox" name="syndromeFeature" value="dicer1"> Pleuropulmonaarinen blastooma, monikyhmystruuma (DICER1)</label>
                            </div>
                        </div>

                        <div class="button-group">
                            <button type="submit" class="submit-btn">Arvioi seulontatarve</button>
                            <button type="reset" class="reset-btn">Tyhjennä</button>
                        </div>
                    </form>

                    <div id="geneticResult" class="result-container" style="display: none;">
                        <h3>Seulontasuositus:</h3>
                        <div id="geneticRecommendation" class="recommendation"></div>
                        <div id="geneticRationale" class="rationale"></div>
                    </div>

                    <h3 style="margin-top: 30px;">Geneettiset kasvainoireyhtymät</h3>
                    <table class="pad-table">
                        <thead>
                            <tr>
                                <th>Syndrooma</th>
                                <th>Manifestaatiot</th>
                                <th>Geeni</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Gardnerin sdr (FAP)</strong></td>
                                <td>GI-polyypit, osteoma, epidermoidikysta</td>
                                <td>APC</td>
                            </tr>
                            <tr>
                                <td><strong>Cowdenin sdr</strong></td>
                                <td>Hamartoomat, rintasyöpäriski</td>
                                <td>PTEN</td>
                            </tr>
                            <tr>
                                <td><strong>Carneyn kompleksi</strong></td>
                                <td>Endokriinikasvaimet, myksooma</td>
                                <td>PRKAR1α</td>
                            </tr>
                            <tr>
                                <td><strong>Wernerin sdr</strong></td>
                                <td>Sarkoomat, progeria</td>
                                <td>WRN</td>
                            </tr>
                            <tr>
                                <td><strong>DICER1-syndrooma</strong></td>
                                <td>Blastooma, monikyhmystruuma</td>
                                <td>DICER1</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </main>

            <!-- Section 8.2: Pregnancy -->
            <main id="pregnancy" class="content-section">
                <h2 class="section-title">Raskaus ja kilpirauhassyöpä</h2>
                <div class="tool-container">
                    <div class="info-box">
                        <h4>Pääperiaate</h4>
                        <p><strong>Raskauden keskeytystä ei ole syytä suosittaa</strong> hyvin erilaistuneen kilpirauhassyövän yhteydessä.</p>
                    </div>

                    <form id="pregnancyForm" class="evaluation-form">
                        <div class="form-group">
                            <label>Potilaan tilanne:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="pregnancyScenario" value="newDiagnosis" required> Raskausaikana todettu kilpirauhassyöpä</label>
                                <label><input type="radio" name="pregnancyScenario" value="previousTreatment"> Aiemmin hoidettu kilpirauhassyöpä, nyt raskaana</label>
                                <label><input type="radio" name="pregnancyScenario" value="planningPregnancy"> Suunnittelee raskautta hoidon jälkeen</label>
                            </div>
                        </div>

                        <div class="form-group" id="trimesterGroup" style="display:none;">
                            <label>Raskauskolmannes:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="trimester" value="first"> 1. kolmannes (vko 1-12)</label>
                                <label><input type="radio" name="trimester" value="second"> 2. kolmannes (vko 13-26)</label>
                                <label><input type="radio" name="trimester" value="third"> 3. kolmannes (vko 27-40)</label>
                            </div>
                        </div>

                        <div class="form-group" id="tumorFeaturesGroup" style="display:none;">
                            <label>Kasvaimen ominaisuudet:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="pregnancyFeature" value="symptoms"> Paineoireet (hengitysvaikeus, nielemisvaikeus, äänen käheys)</label>
                                <label><input type="checkbox" name="pregnancyFeature" value="lymphNodes"> Todetut imusolmukemetastaasit</label>
                                <label><input type="checkbox" name="pregnancyFeature" value="growth"> Merkittävä kasvu (>50% tilavuudessa tai >20% dimensioissa)</label>
                                <label><input type="checkbox" name="pregnancyFeature" value="invasion"> Kapseli-invaasio tai ekstrathyreoidaalinen kasvu</label>
                            </div>
                        </div>

                        <div class="form-group" id="diseaseStatusGroup" style="display:none;">
                            <label>Taudin tila ennen raskautta:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="diseaseStatus" value="cured"> Tautivapaa (erinomainen vaste)</label>
                                <label><input type="radio" name="diseaseStatus" value="indeterminate"> Epävarma tilanne (matala Tg)</label>
                                <label><input type="radio" name="diseaseStatus" value="active"> Aktiivinen tauti / korkea uusiutumisriski</label>
                            </div>
                        </div>

                        <div class="form-group" id="postTreatmentGroup" style="display:none;">
                            <label>Viimeisin hoito:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="lastTreatment" value="rai"> Radiojodihoito</label>
                                <label><input type="radio" name="lastTreatment" value="surgery"> Leikkaus (ei RAI)</label>
                                <label><input type="radio" name="lastTreatment" value="breastfeeding"> Imettää parhaillaan</label>
                            </div>
                        </div>

                        <div class="button-group">
                            <button type="submit" class="submit-btn">Arvioi hoito</button>
                            <button type="reset" class="reset-btn">Tyhjennä</button>
                        </div>
                    </form>

                    <div id="pregnancyResult" class="result-container" style="display: none;">
                        <h3>Hoitosuositus:</h3>
                        <div id="pregnancyRecommendation" class="recommendation"></div>
                        <div id="pregnancyRationale" class="rationale"></div>
                    </div>

                    <div class="recommendation-box recommendation-korkea" style="margin-top: 20px;">
                        <h4>Ehdottomat vasta-aiheet raskauden aikana</h4>
                        <ul>
                            <li>Radiojodihoito</li>
                            <li>Kilpirauhasen gammakuvaus</li>
                            <li>TKI-lääkkeet (teratogeenisia)</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <h4>Raskauden suunnittelu RAI:n jälkeen</h4>
                        <ul>
                            <li><strong>Nainen:</strong> Vähintään 6 kk (jopa 12 kk remission varmistamiseksi)</li>
                            <li><strong>Mies:</strong> Vähintään 3–6 kk lapsen siittämiseen</li>
                            <li>Imetys lopetettava 2–3 kk ennen RAI:ta</li>
                        </ul>
                    </div>
                </div>
            </main>

            <!-- Section 8.3: Thyroglobulin -->
            <main id="thyroglobulin" class="content-section">
                <h2 class="section-title">Tyreoglobuliinin tulkinta</h2>
                <div class="tool-container">
                    <div class="info-box">
                        <h4>Tyreoglobuliini (Tg) kasvainmarkkerina</h4>
                        <p>Tg on herkkä merkkiaine jäljellä olevalle kilpirauhaskudokselle tai syövälle totaalityreoidektomian jälkeen. <strong>Ei käytössä diagnostiikassa</strong>, vain seurannassa.</p>
                    </div>

                    <form id="tgForm" class="evaluation-form">
                        <div class="form-group">
                            <label>Mittaustyyppi:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="tgType" value="suppressed" required> Suppressoitu Tg (TSH &lt;2 mU/l)</label>
                                <label><input type="radio" name="tgType" value="stimulated"> Stimuloitu Tg (TSH &gt;30 mU/l)</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="tgValue">Tyreoglobuliini (µg/l):</label>
                            <input type="number" id="tgValue" step="0.01" min="0" required>
                        </div>

                        <div class="form-group">
                            <label>TgAb (tyreoglobuliinivasta-aineet):</label>
                            <div class="radio-group">
                                <label><input type="radio" name="tgAbStatus" value="negative" required> Negatiivinen</label>
                                <label><input type="radio" name="tgAbStatus" value="positive-stable"> Koholla, stabiili tai laskeva</label>
                                <label><input type="radio" name="tgAbStatus" value="positive-rising"> Koholla, nousussa</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Tg:n trendi verrattuna edelliseen mittaukseen:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="tgTrend" value="decreasing" required> Laskeva</label>
                                <label><input type="radio" name="tgTrend" value="stable"> Stabiili</label>
                                <label><input type="radio" name="tgTrend" value="rising"> Nousussa</label>
                                <label><input type="radio" name="tgTrend" value="first"> Ensimmäinen mittaus</label>
                            </div>
                        </div>

                        <div class="button-group">
                            <button type="submit" class="submit-btn">Tulkitse tulos</button>
                            <button type="reset" class="reset-btn">Tyhjennä</button>
                        </div>
                    </form>

                    <div id="tgResult" class="result-container" style="display: none;">
                        <h3>Tulkinta:</h3>
                        <div id="tgRecommendation" class="recommendation"></div>
                        <div id="tgRationale" class="rationale"></div>
                    </div>

                    <h3 style="margin-top: 30px;">Viitearvot</h3>
                    <table class="pad-table">
                        <thead>
                            <tr>
                                <th>Vaste</th>
                                <th>Suppressoitu Tg</th>
                                <th>Stimuloitu Tg</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Erinomainen</strong></td>
                                <td>&lt;0.2 µg/l</td>
                                <td>&lt;1 µg/l</td>
                            </tr>
                            <tr>
                                <td><strong>Epävarma</strong></td>
                                <td>0.2–1 µg/l</td>
                                <td>1–10 µg/l</td>
                            </tr>
                            <tr>
                                <td><strong>Epätäydellinen</strong></td>
                                <td>&gt;1 µg/l</td>
                                <td>&gt;10 µg/l</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box" style="margin-top: 20px;">
                        <h4>rhTSH-stimulaation aikataulutus</h4>
                        <ul>
                            <li><strong>Päivä 1-2:</strong> rhTSH 0.9 mg i.m.</li>
                            <li><strong>Päivä 3:</strong> Tg-mittaus (RAI-hoidon jälkeen)</li>
                            <li><strong>Päivä 5:</strong> Tg-mittaus (vastearvioinnissa)</li>
                        </ul>
                    </div>
                </div>
            </main>

            <!-- Section 9.1: Original Article -->
            <main id="source-article" class="content-section">
                <h2 class="section-title">9.1 Alkuperäisartikkeli</h2>
                <div class="info-content">
                    <h3>Artikkelin tiedot</h3>
                    <div class="source-card">
                        <h4>Papillaarinen ja follikulaarinen kilpirauhasen syöpä</h4>
                        <p class="source-meta">Hoitosuositukset ja hoito-ohjeet</p>
                        <ul class="article-meta">
                            <li><strong>Julkaisija:</strong> Suomalainen Lääkäriseura Duodecim</li>
                            <li><strong>Julkaisupäivä:</strong> 22.4.2025</li>
                            <li><strong>Artikkelin tunnus:</strong> hsu00033</li>
                            <li><strong>Tyyppi:</strong> Uusi artikkeli</li>
                        </ul>
                    </div>

                    <h3>Kirjoittajat</h3>
                    <p class="authors-list">
                        Hanna Aula, Riitta Aaltonen, Veera Ahtiainen, Johanna Arola, Annette Beule,
                        Tommi Hakala, Pia Hakanen, Päivi Halonen, Esa Hämäläinen, Päivi Hämäläinen,
                        Maria Juujärvi, Jari Karjalainen, Pekka Kejo, Harri Keski-Santti, Ivana Kholová,
                        Minna Koivikko, Petri Koivunen, Päivi Koskela-Karjalainen, David Laaksonen,
                        Maria Lapela, Helena Leijon, Niina Matikainen, Saara Metso, Leena Moilanen,
                        Hanna O Mäenpää, Kimmo Mäkinen, Leo Niskanen, Tommi Noponen, Kristofer Nyman,
                        Vesa-Matti Pohjanen, Minna Pöyhönen, Milla Rosengård-Bärlund, Johanna Ruohola,
                        Pasi Salmela, Jukka Schildt, Mikko Tenhunen, Leila Vaalavirta ja Mika Väisänen
                    </p>

                    <h3>Huomautus</h3>
                    <p>Tämä työkalu on tarkoitettu kliinisen päätöksenteon tueksi. Se ei korvaa lääkärin arviota eikä potilaskohtaista harkintaa.</p>
                    <p class="copyright">© 2025 Kustannus Oy Duodecim</p>
                </div>
            </main>

            <!-- Section 9.2: References -->
            <main id="source-references" class="content-section">
                <h2 class="section-title">9.2 Kirjallisuusviitteet</h2>
                <div class="info-content">
                    <p>Alkuperäisartikkelissa käytetyt lähteet:</p>
                    <ol class="references-list">
                        <li>Gharib H, Papini E, Garber JR, ym. AACE/ACE/AME Medical Guidelines for Clinical Practice for the Diagnosis and Management of Thyroid Nodules - 2016 Update. Endocr Pract 2016;22(5):622-39</li>
                        <li>Abalovich M, Amino N, Barbour LA, ym. Management of thyroid dysfunction during pregnancy and postpartum: an Endocrine Society Clinical Practice Guideline. J Clin Endocrinol Metab 2007;92(8 Suppl):S1-47</li>
                        <li>Alexander EK, Pearce EN, Brent GA, ym. 2017 Guidelines of the American Thyroid Association for the Diagnosis and Management of Thyroid Disease During Pregnancy and the Postpartum. Thyroid 2017;27(3):315-389</li>
                        <li>Attia AS, Hussein M, Issa PP, ym. Association of BRAF(V600E) Mutation with the Aggressive Behavior of Papillary Thyroid Microcarcinoma: A Meta-Analysis of 33 Studies. Int J Mol Sci 2022;23(24)</li>
                        <li>Bennedbaek FN, Hegedus L. Management of the solitary thyroid nodule: results of a North American survey. J Clin Endocrinol Metab 2000;85(7):2493-8</li>
                        <li>Bennedbaek FN, Perrild H, Hegedus L. Diagnosis and treatment of the solitary thyroid nodule. Results of a European survey. Clin Endocrinol (Oxf) 1999;50(3):357-63</li>
                        <li>Bonavita JA, Mayo J, Babb J, ym. Pattern recognition of benign nodules at ultrasound of the thyroid: which nodules can be left alone? AJR Am J Roentgenol 2009;193(1):207-13</li>
                        <li>Bradley PJ, Raghavan U. Cancers presenting in the head and neck during pregnancy. Curr Opin Otolaryngol Head Neck Surg 2004;12(2):76-81</li>
                        <li>Brandt F, Green A, Hegedus L, ym. A critical review and meta-analysis of the association between overt hyperthyroidism and mortality. Eur J Endocrinol 2011;165(4):491-7</li>
                        <li>Haugen BR, Alexander EK, Bible KC, ym. 2015 American Thyroid Association Management Guidelines for Adult Patients with Thyroid Nodules and Differentiated Thyroid Cancer. Thyroid 2016;26(1):1-133</li>
                        <li>Capezzone M, Robenshtok E, Cantara S, ym. Familial non-medullary thyroid cancer: a critical review. J Endocrinol Invest 2021;44(5):943-950</li>
                        <li>Carney JA, Hirokawa M, Lloyd RV, ym. Hyalinizing trabecular tumors of the thyroid gland are almost all benign. Am J Surg Pathol 2008;32(12):1877-89</li>
                        <li>Charkes ND. On the prevalence of familial nonmedullary thyroid cancer in multiply affected kindreds. Thyroid 2006;16(2):181-6</li>
                        <li>Choe W, McDougall IR. Thyroid cancer in pregnant women: diagnostic and therapeutic management. Thyroid 1994;4(4):433-5</li>
                        <li>Costante G, Meringolo D, Durante C, ym. Predictive value of serum calcitonin levels for preoperative diagnosis of medullary thyroid carcinoma. J Clin Endocrinol Metab 2007;92(2):450-5</li>
                        <li>De Groot L, Abalovich M, Alexander EK, ym. Management of thyroid dysfunction during pregnancy and postpartum: an Endocrine Society clinical practice guideline. J Clin Endocrinol Metab 2012;97(8):2543-65</li>
                        <li>Dottorini ME, Lomuscio G, Mazzucchelli L, ym. Assessment of female fertility and carcinogenesis after iodine-131 therapy for differentiated thyroid carcinoma. J Nucl Med 1995;36(1):21-7</li>
                        <li>Cranshaw IM, Carnaille B. Micrometastases in thyroid cancer. An important finding? Surg Oncol 2008;17(3):253-8</li>
                        <li>Enumah S, Fingeret A, Parangi S, ym. BRAF(V600E) Mutation is Associated with an Increased Risk of Papillary Thyroid Cancer Recurrence. World J Surg 2020;44(8):2685-2691</li>
                        <li>Fallah M, Pukkala E, Tryggvadottir L, ym. Risk of thyroid cancer in first-degree relatives of patients with non-medullary thyroid cancer by histology type and age at diagnosis. J Med Genet 2013;50(6):373-82</li>
                        <li>Figlioli G, Kohler A, Chen B, ym. Novel genome-wide association study-based candidate loci for differentiated thyroid cancer risk. J Clin Endocrinol Metab 2014;99(10):E2084-92</li>
                        <li>Filetti S, Durante C, Hartl D, ym. Thyroid cancer: ESMO Clinical Practice Guidelines for diagnosis, treatment and follow-up. Ann Oncol 2019;30(12):1856-1883</li>
                        <li>Filetti S, Durante C, Hartl DM, ym. ESMO Clinical Practice Guideline update on the use of systemic therapy in advanced thyroid cancer. Ann Oncol 2022;33(7):674-684</li>
                        <li>Francis GL, Waguespack SG, Bauer AJ, ym. Management Guidelines for Children with Thyroid Nodules and Differentiated Thyroid Cancer. Thyroid 2015;25(7):716-59</li>
                        <li>Fugazzola L, Elisei R, Fuhrer D, ym. 2019 European Thyroid Association Guidelines for the Treatment and Follow-Up of Advanced Radioiodine-Refractory Thyroid Cancer. Eur Thyroid J 2019;8(5):227-245</li>
                        <li>Glinoer D, Soto MF, Bourdoux P, ym. Pregnancy in patients with mild thyroid abnormalities: maternal and neonatal repercussions. J Clin Endocrinol Metab 1991;73(2):421-7</li>
                        <li>Gubbiotti MA, Livolsi V, Montone K, ym. Papillary thyroid microcarcinomas: does subtyping predict aggressive clinical behavior? Hum Pathol 2021;114:28-35</li>
                        <li>Haddad RI, Bischoff L, Ball D, ym. Thyroid Carcinoma, Version 2.2022, NCCN Clinical Practice Guidelines in Oncology. J Natl Compr Canc Netw 2022;20(8):925-951</li>
                        <li>Haddow JE, Palomaki GE, Allan WC, ym. Maternal thyroid deficiency during pregnancy and subsequent neuropsychological development of the child. N Engl J Med 1999;341(8):549-55</li>
                        <li>Hamburger JI. Thyroid nodules in pregnancy. Thyroid 1992;2(2):165-8</li>
                        <li>Haugen BR, Alexander EK, Bible KC, ym. 2015 American Thyroid Association Management Guidelines for Adult Patients with Thyroid Nodules and Differentiated Thyroid Cancer. Thyroid 2016;26(1):1-133</li>
                        <li>Herzon FS, Morris DM, Segal MN, ym. Coexistent thyroid cancer and pregnancy. Arch Otolaryngol Head Neck Surg 1994;120(11):1191-3</li>
                        <li>Hoang JK, Langer JE, Middleton WD, ym. Managing incidental thyroid nodules detected on imaging: white paper of the ACR Incidental Thyroid Findings Committee. J Am Coll Radiol 2015;12(2):143-50</li>
                        <li>Huang Y, Qu S, Zhu G, ym. BRAF V600E Mutation-Assisted Risk Stratification of Solitary Intrathyroidal Papillary Thyroid Cancer for Precision Treatment. J Natl Cancer Inst 2018;110(4):362-370</li>
                        <li>Khaled H, Al Lahloubi N, Rashad N. A review on thyroid cancer during pregnancy: Multitasking is required. J Adv Res 2016;7(4):565-70</li>
                        <li>Hyer S, Vini L, O'Connell M, ym. Testicular dose and fertility in men following I(131) therapy for thyroid cancer. Clin Endocrinol (Oxf) 2002;56(6):755-8</li>
                        <li>Karger S, Schötz S, Stumvoll M, ym. Impact of pregnancy on prevalence of goitre and nodular thyroid disease in women living in a region of borderline sufficient iodine supply. Horm Metab Res 2010;42(2):137-42</li>
                        <li>Kiess AP, Agrawal N, Brierley JD, ym. External-beam radiotherapy for differentiated thyroid cancer locoregional control. Head Neck 2016;38(4):493-8</li>
                        <li>Kim DS, Kim JH, Na DG, ym. Sonographic features of follicular variant papillary thyroid carcinomas in comparison with conventional papillary thyroid carcinomas. J Ultrasound Med 2009;28(12):1685-92</li>
                        <li>Kim EK, Park CS, Chung WY, ym. New sonographic criteria for recommending fine-needle aspiration biopsy of nonpalpable solid nodules of the thyroid. AJR Am J Roentgenol 2002;178(3):687-91</li>
                        <li>Kim JY, Jung SL, Kim MK, ym. Differentiation of benign and malignant thyroid nodules based on the proportion of sponge-like areas on ultrasonography. Ultrasonography 2015;34(4):304-11</li>
                        <li>Klein Hesselink EN, Links TP. Radioiodine Treatment and Thyroid Hormone Suppression Therapy for Differentiated Thyroid Carcinoma. Eur Thyroid J 2015;4(2):82-92</li>
                        <li>Klubo-Gwiezdzinska J, Yang L, Merkel R, ym. Results of Screening in Familial Non-Medullary Thyroid Cancer. Thyroid 2017;27(8):1017-1024</li>
                        <li>Kung AW, Chau MT, Lao TT, ym. The effect of pregnancy on thyroid nodule formation. J Clin Endocrinol Metab 2002;87(3):1010-4</li>
                        <li>Liu Z, Huang Y, Chen S, ym. Minimal extrathyroidal extension affects the prognosis of differentiated thyroid cancer. PLoS One 2019;14(6):e0218171</li>
                        <li>Lushbaugh CC, Casarett GW. The effects of gonadal irradiation in clinical radiation therapy: a review. Cancer 1976;37(2 Suppl):1111-25</li>
                        <li>Mazeh H, Sippel RS. Familial nonmedullary thyroid carcinoma. Thyroid 2013;23(9):1049-56</li>
                        <li>Mazzaferri EL. Gonadal damage from 131I therapy for thyroid cancer. Clin Endocrinol (Oxf) 2002;57(3):313-4</li>
                        <li>Mazzaferri EL. Approach to the pregnant patient with thyroid cancer. J Clin Endocrinol Metab 2011;96(2):265-72</li>
                        <li>Mestman JH, Goodwin TM, Montoro MM. Thyroid disorders of pregnancy. Endocrinol Metab Clin North Am 1995;24(1):41-71</li>
                        <li>Miyauchi A, Kudo T, Ito Y, ym. Estimation of the lifetime probability of disease progression of papillary microcarcinoma of the thyroid during active surveillance. Surgery 2018;163(1):48-52</li>
                        <li>Miyauchi A, Kudo T, Miya A, ym. Prognostic impact of serum thyroglobulin doubling-time under thyrotropin suppression in patients with papillary thyroid carcinoma. Thyroid 2011;21(7):707-16</li>
                        <li>Moosa M, Mazzaferri EL. Outcome of differentiated thyroid cancer diagnosed in pregnant women. J Clin Endocrinol Metab 1997;82(9):2862-6</li>
                        <li>Nixon IJ, Suárez C, Simo R, ym. The impact of family history on non-medullary thyroid cancer. Eur J Surg Oncol 2016;42(10):1455-63</li>
                        <li>Nyman K, Markkola A. Kilpirauhaskyhmyn kaikukuvaus ja ohutneulanäytteenoton aiheet. Duodecim 2018;134:280-8</li>
                        <li>O'Connell L, Prichard RS, O'Reilly E, ym. Running in the family: A rare diagnosis of familial papillary thyroid cancer. Int J Surg Case Rep 2015;16:64-6</li>
                        <li>Padovani RP, Robenshtok E, Brokhin M, ym. Even without additional therapy, serum thyroglobulin concentrations often decline for years after total thyroidectomy. Thyroid 2012;22(8):778-83</li>
                        <li>Perros P, Boelaert K, Colley S, ym. Guidelines for the management of thyroid cancer. Clin Endocrinol (Oxf) 2014;81 Suppl 1:1-122</li>
                        <li>Rashid FA, Tabassum S, Khan MS, ym. VE1 immunohistochemistry is an adjunct tool for detection of BRAF(V600E) mutation. J Clin Lab Anal 2021;35(2):e23628</li>
                        <li>Rios A, Rodriguez JM, Navas D, ym. Family Screening in Familial Papillary Carcinoma: The Early Detection of Thyroid Disease. Ann Surg Oncol 2016;23(8):2564-70</li>
                        <li>Rosario PW, Mourão GF. Noninvasive follicular thyroid neoplasm with papillary-like nuclear features (NIFTP): a review for clinicians. Endocr Relat Cancer 2019;26(5):R259-R266</li>
                        <li>Rosario PW, Mineiro Filho AF, Prates BS, ym. Ultrasonographic screening for thyroid cancer in siblings of patients with apparently sporadic papillary carcinoma. Thyroid 2012;22(8):805-8</li>
                        <li>Russ G. Risk stratification of thyroid nodules on ultrasonography with the French TI-RADS. Ultrasonography 2016;35(1):25-38</li>
                        <li>Rutter MM, Jha P, Schultz KA, ym. DICER1 Mutations and Differentiated Thyroid Carcinoma. J Clin Endocrinol Metab 2016;101(1):1-5</li>
                        <li>Sanabria A, Rojas A, Arevalo J, ym. Microscopically positive surgical margins and local recurrence in thyroid cancer. A meta-analysis. Eur J Surg Oncol 2019;45(8):1310-1316</li>
                        <li>Sawka AM, Lakra DC, Lea J, ym. A systematic review examining the effects of therapeutic radioactive iodine on ovarian function and future pregnancy. Clin Endocrinol (Oxf) 2008;69(3):479-90</li>
                        <li>Sawka AM, Ibrahim-Zada I, Galacgac P, ym. Dietary iodine restriction in preparation for radioactive iodine treatment or scanning. Thyroid 2010;20(10):1129-38</li>
                        <li>Schalin-Jäntti C. Kilpirauhasensairaudet ja raskaus. Suomen Lääkärilehti 2008;63(35):2795-2800</li>
                        <li>Schlumberger ed. Thyroid tumors. 4th edition, 2015</li>
                        <li>Shin JH, Baek JH, Chung J, ym. Ultrasonography Diagnosis and Imaging-Based Management of Thyroid Nodules: Revised Korean Society of Thyroid Radiology Consensus Statement. Korean J Radiol 2016;17(3):370-95</li>
                        <li>Sisson JC, Freitas J, ym. Radiation safety in the treatment of patients with thyroid diseases by radioiodine 131I. Thyroid 2011;21(4):335-46</li>
                        <li>Smith LH, Danielsen B, Allen ME, ym. Cancer associated with obstetric delivery: results of linkage with the California cancer registry. Am J Obstet Gynecol 2003;189(4):1128-35</li>
                        <li>Frates MC, Benson CB, Charboneau JW, ym. Management of thyroid nodules detected at US: Society of Radiologists in Ultrasound consensus conference statement. Radiology 2005;237(3):794-800</li>
                        <li>Stagnaro-Green A, Abalovich M, Alexander E, ym. Guidelines of the American Thyroid Association for the diagnosis and management of thyroid disease during pregnancy and postpartum. Thyroid 2011;21(10):1081-125</li>
                        <li>Struve CW, Haupt S, Ohlen S. Influence of frequency of previous pregnancies on the prevalence of thyroid nodules in women. Thyroid 1993;3(1):7-9</li>
                        <li>Suomen Syöpärekisteri</li>
                        <li>Tessler FN, Middleton WD, Grant EG, ym. ACR Thyroid Imaging, Reporting and Data System (TI-RADS). J Am Coll Radiol 2017;14(5):587-595</li>
                        <li>Tuttle RM, Haugen B, Perrier ND. Updated American Joint Committee on Cancer/Tumor-Node-Metastasis Staging System for Differentiated and Anaplastic Thyroid Cancer. Thyroid 2017;27(6):751-756</li>
                        <li>Weisz B, Schiff E, Lishner M. Cancer in pregnancy: maternal and fetal implications. Hum Reprod Update 2001;7(4):384-93</li>
                        <li>Wichers M, Benz E, Palmedo H, ym. Testicular function after radioiodine therapy for thyroid carcinoma. Eur J Nucl Med 2000;27(5):503-7</li>
                        <li>Vaisman F, Momesso D, Bulzico DA, ym. Spontaneous remission in thyroid cancer patients after biochemical incomplete response to initial therapy. Clin Endocrinol (Oxf) 2012;77(1):132-8</li>
                        <li>Xing M, Alzahrani AS, Carson KA, ym. Association between BRAF V600E mutation and mortality in patients with papillary thyroid cancer. JAMA 2013;309(14):1493-501</li>
                        <li>Xu B, David J, Dogan S, ym. Primary high-grade non-anaplastic thyroid carcinoma: a retrospective study of 364 cases. Histopathology 2022;80(2):322-337</li>
                        <li>Yang LB, Jiang DQ, Qi WB, ym. Subclinical hyperthyroidism and the risk of cardiovascular events and all-cause mortality. Eur J Endocrinol 2012;167(1):75-84</li>
                        <li>Yasmeen S, Cress R, Romano PS, ym. Thyroid cancer in pregnancy. Int J Gynaecol Obstet 2005;91(1):15-20</li>
                        <li>Zannat R, Lee J, Muzaffar J, ym. The potential interaction between medical treatment and radioiodine treatment success: A systematic review. Front Endocrinol (Lausanne) 2022;13:1061555</li>
                    </ol>
                </div>
            </main>

            <footer>
                <p>Perustuu Duodecimin käypä hoito -suositukseen: Papillaarinen ja follikulaarinen kilpirauhasen syöpä</p>
            </footer>
        </div>
    </div>

    <script>
document.addEventListener('DOMContentLoaded', function() {
    // Collapsible menu handling
    const collapsibles = document.querySelectorAll('.nav-section-title.collapsible');

    collapsibles.forEach(collapsible => {
        collapsible.addEventListener('click', function(e) {
            e.stopPropagation();
            this.classList.toggle('expanded');
        });
    });

    // Toggle all sections button
    const toggleAllBtn = document.getElementById('toggleAllSections');
    if (toggleAllBtn) {
        let allExpanded = false;

        toggleAllBtn.addEventListener('click', function() {
            allExpanded = !allExpanded;
            const toggleIcon = this.querySelector('.toggle-icon');
            const toggleText = this.querySelector('.toggle-text');

            collapsibles.forEach(collapsible => {
                if (allExpanded) {
                    collapsible.classList.add('expanded');
                } else {
                    collapsible.classList.remove('expanded');
                }
            });

            if (allExpanded) {
                toggleIcon.textContent = '⊟';
                toggleText.textContent = 'Sulje kaikki';
            } else {
                toggleIcon.textContent = '⊞';
                toggleText.textContent = 'Avaa kaikki';
            }
        });
    }

    // Navigation handling
    const navItems = document.querySelectorAll('.nav-item');
    const sections = document.querySelectorAll('.content-section');

    navItems.forEach(item => {
        item.addEventListener('click', function(e) {
            e.preventDefault();

            // Remove active class from all nav items and sections
            navItems.forEach(nav => nav.classList.remove('active'));
            sections.forEach(section => section.classList.remove('active'));

            // Add active class to clicked nav item
            this.classList.add('active');

            // Expand parent section if clicking on a subitem
            if (this.classList.contains('nav-subitem')) {
                const parentSection = this.closest('.nav-section');
                const parentTitle = parentSection.querySelector('.nav-section-title.collapsible');
                if (parentTitle && !parentTitle.classList.contains('expanded')) {
                    parentTitle.classList.add('expanded');
                }
            }

            // Show corresponding section
            const targetId = this.getAttribute('href').substring(1);
            const targetSection = document.getElementById(targetId);
            if (targetSection) {
                targetSection.classList.add('active');
            }
        });
    });

    // Surgical treatment form handling
    const form = document.getElementById('treatmentForm');
    const resultContainer = document.getElementById('result');
    const recommendationDiv = document.getElementById('recommendation');
    const rationaleDiv = document.getElementById('rationale');

    if (form) {
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            calculateRecommendation();
        });

        form.addEventListener('reset', function() {
            resultContainer.style.display = 'none';
        });
    }

    function calculateRecommendation() {
        // Get form values
        const tumorSize = parseInt(document.getElementById('tumorSize').value);
        const tumorType = document.getElementById('tumorType').value;

        // Get selected risk factors
        const riskFactors = Array.from(document.querySelectorAll('input[name="riskFactor"]:checked'))
            .map(cb => cb.value);

        // Determine risk category and recommendation
        const result = determineRecommendation(tumorSize, tumorType, riskFactors);

        // Display results
        displayRecommendation(result, tumorSize, riskFactors);
    }

    function determineRecommendation(size, type, risks) {
        let recommendation = '';
        let category = '';
        let reasoning = [];

        // Check for high-risk factors
        const hasExtrathyroidal = risks.includes('extrathyroidal');
        const hasVascularInvasion = risks.includes('vascular');
        const hasLymphNode = risks.includes('lymphNode');
        const hasBRAF = risks.includes('braf');
        const hasAggressiveHistology = risks.includes('aggressive');
        const hasFamilyHistory = risks.includes('familyHistory');
        const hasRadiation = risks.includes('radiation');
        const hasTrachealContact = risks.includes('trachealContact');

        // Major risk factors that always indicate total thyroidectomy
        const hasMajorRisk = hasExtrathyroidal || hasVascularInvasion ||
                            hasLymphNode || hasAggressiveHistology || hasTrachealContact;

        // Minor risk factors
        const hasMinorRisk = hasBRAF || hasFamilyHistory || hasRadiation;

        // Tumor size categories
        if (size <= 10) {
            category = 'cT1a (≤10 mm)';

            if (!hasMajorRisk && !hasMinorRisk) {
                recommendation = 'Lobektomia tai aktiivinen seuranta';
                reasoning.push('Kasvain on pieni (≤10 mm) ilman riskitekijöitä');
                reasoning.push('Aktiivinen seuranta on vaihtoehto hyvin valituille potilaille');
                reasoning.push('Lobektomia on riittävä hoito matalan riskin tapauksissa');
            } else if (!hasMajorRisk && hasMinorRisk) {
                recommendation = 'Lobektomia (ensisijainen) tai totaaliresektion harkinta';
                reasoning.push('Kasvain on pieni, mutta läsnä on vähäisiä riskitekijöitä');
                if (hasBRAF) reasoning.push('BRAF-mutaatio lisää uusiutumisriskiä');
                if (hasFamilyHistory) reasoning.push('Sukurasitus voi viitata aggressiivisempaan tautiin');
                if (hasRadiation) reasoning.push('Aiempi säteilytys on riskitekijä');
            } else {
                recommendation = 'Totaaliresektio (thyroidektomia)';
                category += ' - korkeampi riski';
                reasoning.push('Kasvain on pieni, mutta läsnä on merkittäviä riskitekijöitä');
                if (hasExtrathyroidal) reasoning.push('Ekstrathyreoidaalinen leviäminen vaatii laajemman leikkauksen');
                if (hasVascularInvasion) reasoning.push('Verisuoniinvaasio lisää etäpesäkeriskiä');
                if (hasLymphNode) reasoning.push('Imusolmuketäyttäyneisyys edellyttää totaaliresektiota');
                if (hasAggressiveHistology) reasoning.push('Aggressiivinen histologia vaatii radikaalimman hoidon');
                if (hasTrachealContact) reasoning.push('Kosketus elintärkeisiin rakenteisiin');
            }

        } else if (size <= 40) {
            category = 'cT1b-T2 (11-40 mm)';

            if (!hasMajorRisk) {
                recommendation = 'Lobektomia';
                reasoning.push('Keskikokoinen kasvain ilman merkittäviä riskitekijöitä');
                reasoning.push('Lobektomia on riittävä, jos ei kosketusta henkitorveen/ruokatorveen/rekurrenshermooon');
                if (hasMinorRisk) {
                    reasoning.push('Huomioi vähäiset riskitekijät seurannassa ja jatkohoitosuunnitelmassa');
                }
            } else {
                recommendation = 'Totaaliresektio (thyroidektomia)';
                category += ' - korkeampi riski';
                reasoning.push('Keskikokoinen kasvain merkittävillä riskitekijöillä');
                if (hasExtrathyroidal) reasoning.push('Ekstrathyreoidaalinen leviäminen');
                if (hasVascularInvasion) reasoning.push('Verisuoniinvaasio');
                if (hasLymphNode) reasoning.push('Imusolmuketäyttäyneisyys - harkitse myös imusolmukedissektiota');
                if (hasAggressiveHistology) reasoning.push('Aggressiivinen histologinen alatyyppi');
                if (hasTrachealContact) reasoning.push('Kosketus henkitorveen/ruokatorveen/rekurrenshermooon');
            }

        } else {
            category = 'cT3-T4 (>40 mm)';
            recommendation = 'Totaaliresektio (thyroidektomia)';
            reasoning.push('Suuri kasvain (>40 mm) edellyttää aina totaaliresektiota');

            if (hasLymphNode) {
                reasoning.push('Imusolmuketäyttäyneisyys - suunnittele imusolmukedissektio');
            }
            if (hasExtrathyroidal) {
                reasoning.push('Ekstrathyreoidaalinen leviäminen - arvioi tarvittavan resektiolaajuus');
            }
            if (hasTrachealContact) {
                reasoning.push('Kosketus kriittisiin rakenteisiin - harkitse moniammatillista konsultaatiota');
            }
        }

        return {
            recommendation: recommendation,
            category: category,
            reasoning: reasoning,
            riskLevel: hasMajorRisk ? 'high-risk' : (hasMinorRisk ? 'warning' : 'low-risk')
        };
    }

    function displayRecommendation(result, size, risks) {
        // Set recommendation text and styling
        recommendationDiv.textContent = result.recommendation;
        recommendationDiv.className = 'recommendation ' + result.riskLevel;

        // Build rationale
        let rationaleHTML = '<h3>Perustelut:</h3>';
        rationaleHTML += '<p><strong>Kasvaimen koko:</strong> ' + size + ' mm (' + result.category + ')</p>';

        if (risks.length > 0) {
            rationaleHTML += '<p><strong>Riskitekijät:</strong></p><ul>';
            risks.forEach(risk => {
                rationaleHTML += '<li>' + getRiskFactorLabel(risk) + '</li>';
            });
            rationaleHTML += '</ul>';
        } else {
            rationaleHTML += '<p><strong>Riskitekijät:</strong> Ei riskitekijöitä</p>';
        }

        rationaleHTML += '<p><strong>Kliininen arviointi:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        // Additional recommendations
        rationaleHTML += '<p><strong>Lisähuomiot:</strong></p><ul>';

        if (result.riskLevel === 'low-risk' && size <= 10) {
            rationaleHTML += '<li>Aktiivinen seuranta on vaihtoehto motivoituneille potilaille</li>';
            rationaleHTML += '<li>Ultraääniseuranta 6-12 kuukauden välein</li>';
        }

        if (risks.includes('lymphNode')) {
            rationaleHTML += '<li>Suunnittele keskuskompartmentin (taso VI) imusolmukedissektio</li>';
            rationaleHTML += '<li>Harkitse lateraalisen kaulan dissektiota, jos N1b</li>';
        }

        if (result.recommendation.includes('Totaaliresektio')) {
            rationaleHTML += '<li>Arvioi radiojodihoitojen tarve leikkauksen jälkeen</li>';
            rationaleHTML += '<li>TSH-suppressiohoito postoperatiivisesti</li>';
        }

        rationaleHTML += '<li>Yksilöllinen hoitosuunnitelma moniammatillisessa tiimissä</li>';
        rationaleHTML += '</ul>';

        rationaleDiv.innerHTML = rationaleHTML;

        // Show results
        resultContainer.style.display = 'block';
        resultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function getRiskFactorLabel(value) {
        const labels = {
            'extrathyroidal': 'Ekstrathyreoidaalinen leviäminen',
            'vascular': 'Verisuoniinvaasio',
            'lymphNode': 'Imusolmuketäyttäyneisyys (N+)',
            'braf': 'BRAF-mutaatio',
            'aggressive': 'Aggressiivinen histologia',
            'familyHistory': 'Kilpirauhassyöpä suvussa',
            'radiation': 'Aiempi kaulan säteilytys',
            'trachealContact': 'Kosketus henkitorveen/ruokatorveen/rekurrenshermooon'
        };
        return labels[value] || value;
    }

    // Ultrasound form handling
    const ultrasoundForm = document.getElementById('ultrasoundForm');
    const ultrasoundResultContainer = document.getElementById('ultrasoundResult');
    const ultrasoundRecommendationDiv = document.getElementById('ultrasoundRecommendation');
    const ultrasoundRationaleDiv = document.getElementById('ultrasoundRationale');

    if (ultrasoundForm) {
        ultrasoundForm.addEventListener('submit', function(e) {
            e.preventDefault();
            calculateUltrasoundRisk();
        });

        ultrasoundForm.addEventListener('reset', function() {
            ultrasoundResultContainer.style.display = 'none';
        });
    }

    function calculateUltrasoundRisk() {
        const size = parseInt(document.getElementById('noduleSize').value);
        const composition = document.getElementById('composition').value;
        const echogenicity = document.getElementById('echogenicity').value;
        const features = Array.from(document.querySelectorAll('input[name="usFeature"]:checked'))
            .map(cb => cb.value);

        const result = determineUltrasoundRisk(size, composition, echogenicity, features);
        displayUltrasoundResult(result, size, composition, echogenicity, features);
    }

    function determineUltrasoundRisk(size, composition, echogenicity, features) {
        let riskLevel = '';
        let riskPercentage = '';
        let fnaRecommendation = '';
        let reasoning = [];

        // Check for high-risk features
        const hasMicroCalc = features.includes('microcalcifications');
        const hasIrregularMargins = features.includes('irregular-margins');
        const hasTallerThanWide = features.includes('taller-than-wide');
        const hasExtrathyroidal = features.includes('extrathyroidal-extension');
        const hasMacroCalc = features.includes('macrocalcifications');
        const hasMultiple = features.includes('multiple-nodules');

        // Pure cystic = benign
        if (composition === 'cystic' || composition === 'honeycomb') {
            riskLevel = 'benign';
            riskPercentage = '<1%';
            fnaRecommendation = 'Ei biopsiaa';
            reasoning.push('Puhtaasti kystinen tai hunajakennomainen rakenne');
            reasoning.push('Maligniteettiriski erittäin pieni');
            if (composition === 'cystic') {
                reasoning.push('Oireista kystaa voi tarvittaessa aspiroida');
            }
        }
        // High-risk features
        else if (hasMicroCalc || hasExtrathyroidal || hasTallerThanWide ||
                (echogenicity === 'markedly-hypo' && hasIrregularMargins)) {
            riskLevel = 'high-risk';
            riskPercentage = '70-90%';

            if (size >= 10) {
                fnaRecommendation = 'FNA suositeltava (≥10 mm)';
            } else if (size >= 5) {
                fnaRecommendation = 'FNA harkittava riskiryhmillä (5-9 mm)';
            } else {
                fnaRecommendation = 'Seuranta suositeltava (<5 mm)';
            }

            reasoning.push('Korkean maligniteettriskin piirteet:');
            if (hasMicroCalc) reasoning.push('• Mikrokalkit - vahva maligniteettiin viittaava merkki');
            if (hasExtrathyroidal) reasoning.push('• Kasvu kilpirauhasen ulkopuolelle');
            if (hasTallerThanWide) reasoning.push('• Korkeampi kuin leveämpi muoto');
            if (hasIrregularMargins) reasoning.push('• Epätarkkarajaiset reunat');
            if (echogenicity === 'markedly-hypo') reasoning.push('• Vahvasti niukkakaikuinen');
        }
        // Moderate risk
        else if (echogenicity === 'mildly-hypo' || hasMacroCalc) {
            riskLevel = 'warning';
            riskPercentage = '10-20%';

            if (composition === 'solid' || composition === 'cystic-solid') {
                if (echogenicity === 'mildly-hypo' && size >= 15) {
                    fnaRecommendation = 'FNA suositeltava (≥15 mm)';
                } else if (size >= 20) {
                    fnaRecommendation = 'FNA suositeltava (≥20 mm)';
                } else {
                    fnaRecommendation = 'Seuranta tai FNA harkittava';
                }
            }

            reasoning.push('Keskimääräisen maligniteettriskin piirteet:');
            if (echogenicity === 'mildly-hypo') reasoning.push('• Lievästi niukkakaikuinen');
            if (hasMacroCalc) reasoning.push('• Makrokalkit läsnä');
            if (hasMultiple) reasoning.push('• Monikyhmystruuma - arvioitava yksitellen');
        }
        // Low risk
        else if (composition === 'cystic-solid') {
            riskLevel = 'low-risk';
            riskPercentage = '<3%';

            if (size >= 20) {
                fnaRecommendation = 'FNA harkittava (≥20 mm)';
            } else {
                fnaRecommendation = 'Ei biopsiaa';
            }

            reasoning.push('Erittäin pienen maligniteettriskin piirteet:');
            reasoning.push('• Kystissolidi muutos ilman korkean riskin piirteitä');
        }
        // Iso/hyperechoic = lower risk
        else if (echogenicity === 'iso' || echogenicity === 'hyper') {
            riskLevel = 'low-risk';
            riskPercentage = '5-10%';

            if (size >= 20) {
                fnaRecommendation = 'FNA suositeltava (≥20 mm)';
            } else {
                fnaRecommendation = 'Kontrolli 12 kk';
            }

            reasoning.push('Pienen maligniteettriskin piirteet:');
            reasoning.push('• Saman- tai runsaskaikuinen rakenne');
            if (size >= 20) reasoning.push('• Koko ≥20 mm - biopsia suositeltava');
        }

        return {
            riskLevel: riskLevel,
            riskPercentage: riskPercentage,
            fnaRecommendation: fnaRecommendation,
            reasoning: reasoning
        };
    }

    function displayUltrasoundResult(result, size, composition, echogenicity, features) {
        ultrasoundRecommendationDiv.textContent = result.fnaRecommendation;
        ultrasoundRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>Arvio:</h3>';
        rationaleHTML += '<p><strong>Maligniteettiriski:</strong> ' + result.riskPercentage + '</p>';
        rationaleHTML += '<p><strong>Kyhmyn koko:</strong> ' + size + ' mm</p>';
        rationaleHTML += '<p><strong>Koostumus:</strong> ' + getCompositionLabel(composition) + '</p>';
        rationaleHTML += '<p><strong>Kaikurakenne:</strong> ' + getEchogenicityLabel(echogenicity) + '</p>';

        if (features.length > 0) {
            rationaleHTML += '<p><strong>Ultraäänipiirteet:</strong></p><ul>';
            features.forEach(feature => {
                rationaleHTML += '<li>' + getUSFeatureLabel(feature) + '</li>';
            });
            rationaleHTML += '</ul>';
        }

        rationaleHTML += '<p><strong>Kliininen arviointi:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        rationaleHTML += '<p><strong>Jatkosuositus:</strong></p><ul>';
        rationaleHTML += '<li>' + result.fnaRecommendation + '</li>';
        if (result.riskLevel === 'high-risk' && size < 10) {
            rationaleHTML += '<li>Alle 10 mm vahvasti malignisuspektit kyhmyt: FNA harkittava riskiryhmissä</li>';
            rationaleHTML += '<li>Riskiryhmät: ikä <35v, sukurasitus, aiempi sädehoito, MEN2</li>';
        }
        if (result.riskLevel !== 'benign') {
            rationaleHTML += '<li>Arviointi tapauskohtaisesti ottaen huomioon potilaan ikä ja kliininen tilanne</li>';
        }
        rationaleHTML += '</ul>';

        ultrasoundRationaleDiv.innerHTML = rationaleHTML;
        ultrasoundResultContainer.style.display = 'block';
        ultrasoundResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function getCompositionLabel(value) {
        const labels = {
            'solid': 'Solidi',
            'cystic-solid': 'Kystissolidi',
            'cystic': 'Puhtaasti kystinen',
            'honeycomb': 'Hunajakennomainen'
        };
        return labels[value] || value;
    }

    function getEchogenicityLabel(value) {
        const labels = {
            'markedly-hypo': 'Vahvasti niukkakaikuinen',
            'mildly-hypo': 'Lievästi niukkakaikuinen',
            'iso': 'Samankaikuinen',
            'hyper': 'Runsaskaikuinen'
        };
        return labels[value] || value;
    }

    function getUSFeatureLabel(value) {
        const labels = {
            'microcalcifications': 'Mikrokalkit',
            'macrocalcifications': 'Makrokalkit',
            'irregular-margins': 'Epätarkkarajaiset reunat',
            'taller-than-wide': 'Korkeampi kuin leveämpi',
            'extrathyroidal-extension': 'Kasvu kilpirauhasen ulkopuolelle',
            'multiple-nodules': 'Multippelit kyhmyt'
        };
        return labels[value] || value;
    }

    // FNA form handling
    const fnaForm = document.getElementById('fnaForm');
    const fnaResultContainer = document.getElementById('fnaResult');
    const fnaRecommendationDiv = document.getElementById('fnaRecommendation');
    const fnaRationaleDiv = document.getElementById('fnaRationale');

    if (fnaForm) {
        fnaForm.addEventListener('submit', function(e) {
            e.preventDefault();
            calculateFNAIndication();
        });

        fnaForm.addEventListener('reset', function() {
            fnaResultContainer.style.display = 'none';
        });
    }

    function calculateFNAIndication() {
        const size = parseInt(document.getElementById('fnaNodeSize').value);
        const composition = document.getElementById('fnaComposition').value;
        const age = document.getElementById('patientAge').value ? parseInt(document.getElementById('patientAge').value) : null;
        const features = Array.from(document.querySelectorAll('input[name="fnaFeature"]:checked'))
            .map(cb => cb.value);
        const riskFactors = Array.from(document.querySelectorAll('input[name="riskFactor"]:checked'))
            .map(cb => cb.value);

        const result = determineFNAIndication(size, composition, age, features, riskFactors);
        displayFNAResult(result, size, composition, age, features, riskFactors);
    }

    function determineFNAIndication(size, composition, age, features, riskFactors) {
        let recommendation = '';
        let timing = '';
        let reasoning = [];
        let riskLevel = 'low-risk';

        const hasSuspiciousFeatures = features.length > 0;
        const hasRiskFactors = riskFactors.length > 0;
        const isYoung = age !== null && age < 35;

        // Pure cystic or honeycomb - no FNA
        if (composition === 'cystic' || composition === 'honeycomb') {
            recommendation = 'Ei biopsiaa';
            timing = '';
            reasoning.push('Puhtaasti kystinen tai hunajakennomainen muutos');
            reasoning.push('FNA ei indisoitu');
            reasoning.push('Oireista kystaa voi tarvittaessa aspiroida');
            riskLevel = 'low-risk';
        }
        // Solid with suspicious features
        else if (composition === 'solid-suspicious') {
            if (size >= 10) {
                recommendation = 'FNA suositeltava';
                timing = 'Samalla käynnillä kun mahdollista';
                reasoning.push('Solidi kyhmy malignisuspekteilla piirteillä');
                reasoning.push('Koko ≥10 mm');
                riskLevel = 'high-risk';
            } else if (size >= 5 && (hasRiskFactors || isYoung)) {
                recommendation = 'FNA harkittava';
                timing = 'Riskiryhmä - harkitse biopsiaa';
                reasoning.push('Vahvasti malignisuspekti 5-9 mm kyhmy');
                if (isYoung) reasoning.push('Nuori ikä (<35v) - suurempi maligniteettiriski');
                if (hasRiskFactors) reasoning.push('Riskitekijöitä läsnä');
                riskLevel = 'warning';
            } else {
                recommendation = 'Seuranta tai FNA harkittava';
                timing = 'UÄ-seuranta 6-12 kk, sen jälkeen vuosittain 5v';
                reasoning.push('Malignisuspekti <10 mm kyhmy');
                reasoning.push('Ensisijainen vaihtoehto: aktiivinen seuranta');
                reasoning.push('FNA vaihtoehto motivoituneille potilaille');
                riskLevel = 'warning';
            }
        }
        // Solid mildly hypoechoic
        else if (composition === 'solid-mildly-hypo') {
            if (size >= 15) {
                recommendation = 'FNA suositeltava';
                timing = 'UÄ-ohjatusti';
                reasoning.push('Lievästi niukkakaikuinen solidi kyhmy');
                reasoning.push('Koko ≥15 mm - FNA-kynnys saavutettu');
                riskLevel = 'warning';
            } else if (size >= 10) {
                recommendation = 'UÄ-kontrolli 12 kk tai FNA harkittava';
                timing = 'Tapauskohtainen arvio';
                reasoning.push('Lievästi niukkakaikuinen 10-14 mm kyhmy');
                reasoning.push('Kertakontrolli tai välitön FNA');
                riskLevel = 'low-risk';
            } else {
                recommendation = 'Ei biopsiaa';
                timing = '';
                reasoning.push('Alle 10 mm, ei malignisuspekteja piirteitä');
                riskLevel = 'low-risk';
            }
        }
        // Solid iso/hyperechoic
        else if (composition === 'solid-iso-hyper') {
            if (size >= 20) {
                recommendation = 'FNA suositeltava';
                timing = 'UÄ-ohjatusti';
                reasoning.push('Saman- tai runsaskaikuinen solidi kyhmy');
                reasoning.push('Koko ≥20 mm - FNA-kynnys saavutettu');
                riskLevel = 'low-risk';
            } else if (size >= 15) {
                recommendation = 'UÄ-kontrolli 12 kk';
                timing = 'Kertakontrolli';
                reasoning.push('Saman-/runsaskaikuinen 15-19 mm kyhmy');
                reasoning.push('Kertakontrolli 12 kk kuluttua');
                riskLevel = 'low-risk';
            } else {
                recommendation = 'Ei seurantaa';
                timing = '';
                reasoning.push('Alle 15 mm, ei malignisuspekteja piirteitä');
                riskLevel = 'low-risk';
            }
        }
        // Cystic-solid
        else if (composition === 'cystic-solid') {
            if (hasSuspiciousFeatures && size >= 10) {
                recommendation = 'FNA suositeltava';
                timing = 'Käsitellään kuten solidia niukkakaikuista';
                reasoning.push('Kystissolidi malignisuspekteilla piirteillä solidissa osassa');
                reasoning.push('Koko ≥10 mm');
                riskLevel = 'high-risk';
            } else if (size >= 20) {
                recommendation = 'FNA harkittava';
                timing = 'Tapauskohtainen päätös';
                reasoning.push('Kystissolidi ≥20 mm ilman malignisuspekteja piirteitä');
                reasoning.push('FNA harkittava potilaskohtaisesti');
                riskLevel = 'low-risk';
            } else {
                recommendation = 'Ei biopsiaa / Seuranta harkittava';
                timing = 'UÄ 12-24 kk (harkinta)';
                reasoning.push('Kystissolidi <20 mm ilman malignisuspekteja piirteitä');
                riskLevel = 'low-risk';
            }
        }

        return {
            recommendation: recommendation,
            timing: timing,
            reasoning: reasoning,
            riskLevel: riskLevel
        };
    }

    function displayFNAResult(result, size, composition, age, features, riskFactors) {
        fnaRecommendationDiv.textContent = result.recommendation;
        fnaRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>Suositus:</h3>';
        rationaleHTML += '<p><strong>FNA-suositus:</strong> ' + result.recommendation + '</p>';
        if (result.timing) {
            rationaleHTML += '<p><strong>Ajoitus:</strong> ' + result.timing + '</p>';
        }
        rationaleHTML += '<p><strong>Kyhmyn koko:</strong> ' + size + ' mm</p>';
        rationaleHTML += '<p><strong>Koostumus:</strong> ' + getFNACompositionLabel(composition) + '</p>';
        if (age !== null) {
            rationaleHTML += '<p><strong>Potilaan ikä:</strong> ' + age + ' vuotta';
            if (age < 35) rationaleHTML += ' (nuori ikä - lisääntynyt riski)';
            rationaleHTML += '</p>';
        }

        if (features.length > 0) {
            rationaleHTML += '<p><strong>Malignisuspektit US-piirteet:</strong></p><ul>';
            features.forEach(feature => {
                rationaleHTML += '<li>' + getFNAFeatureLabel(feature) + '</li>';
            });
            rationaleHTML += '</ul>';
        }

        if (riskFactors.length > 0) {
            rationaleHTML += '<p><strong>Riskitekijät:</strong></p><ul>';
            riskFactors.forEach(rf => {
                rationaleHTML += '<li>' + getFNARiskFactorLabel(rf) + '</li>';
            });
            rationaleHTML += '</ul>';
        }

        rationaleHTML += '<p><strong>Kliininen perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        rationaleHTML += '<p><strong>Lisähuomiot:</strong></p><ul>';
        rationaleHTML += '<li>ONB otetaan UÄ-ohjatusti samalla käynnillä kun mahdollista</li>';
        if (result.riskLevel === 'high-risk') {
            rationaleHTML += '<li>Malignisuspektit piirteet edellyttävät huolellista arviointia</li>';
        }
        if (size < 10 && result.recommendation.includes('Seuranta')) {
            rationaleHTML += '<li>Alle 1 cm kyhmyjen ensisijainen hoito on seuranta</li>';
            rationaleHTML += '<li>UÄ-kontrolli 6-12 kk, sen jälkeen vuosittain 5 vuoden ajan</li>';
        }
        rationaleHTML += '<li>Lopullinen päätös tehdään tapauskohtaisesti huomioiden kliininen tilanne</li>';
        rationaleHTML += '</ul>';

        fnaRationaleDiv.innerHTML = rationaleHTML;
        fnaResultContainer.style.display = 'block';
        fnaResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function getFNACompositionLabel(value) {
        const labels = {
            'solid-suspicious': 'Solidi + malignisuspektit piirteet',
            'solid-mildly-hypo': 'Solidi lievästi niukkakaikuinen',
            'solid-iso-hyper': 'Solidi saman- tai runsaskaikuinen',
            'cystic-solid': 'Kystissolidi',
            'cystic': 'Puhtaasti kystinen',
            'honeycomb': 'Hunajakennomainen'
        };
        return labels[value] || value;
    }

    function getFNAFeatureLabel(value) {
        const labels = {
            'microcalcifications': 'Mikrokalkit',
            'irregular-margins': 'Epätarkkarajaisuus',
            'extrathyroidal': 'Kasvu kilpirauhasen ulkopuolelle',
            'taller-than-wide': 'Korkeampi kuin leveämpi',
            'markedly-hypo': 'Vahvasti niukkakaikuinen'
        };
        return labels[value] || value;
    }

    function getFNARiskFactorLabel(value) {
        const labels = {
            'prior-cancer': 'Aiempi kilpirauhassyöpä',
            'neck-metastases': 'Todetut kaulametastaasit',
            'radiation': 'Aiempi pään/kaulan sädehoito',
            'men2': 'MEN2-syndrooma tai muu riskisyndrooma',
            'family-history': 'Sukuanamnesi (1. asteen sukulainen)'
        };
        return labels[value] || value;
    }

    // Bethesda classification form handling
    const bethesdaForm = document.getElementById('bethesdaForm');
    const bethesdaResultContainer = document.getElementById('bethesdaResult');
    const bethesdaRecommendationDiv = document.getElementById('bethesdaRecommendation');
    const bethesdaRationaleDiv = document.getElementById('bethesdaRationale');

    if (bethesdaForm) {
        bethesdaForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const category = document.getElementById('bethesdaCategory').value;
            const features = Array.from(document.querySelectorAll('input[name="bethesdaFeature"]:checked'))
                .map(cb => cb.value);

            const result = determineBethesdaManagement(category, features);
            displayBethesdaResult(result, category, features);
        });
    }

    function determineBethesdaManagement(category, features) {
        const hasMalignantFeatures = features.length > 0;
        let management = '';
        let timing = '';
        let followUp = '';
        let reasoning = [];
        let riskLevel = 'low-risk';

        switch(category) {
            case '1': // Riittämätön näyte
                if (hasMalignantFeatures) {
                    management = 'UÄ ja ONB-uusinta 0-3 kuukautta';
                    timing = 'Heti kun mahdollista';
                    followUp = 'Jos toistetusti riittämätön, kirurginen hoito (diagnostinen lobektomia)';
                    reasoning.push('Malignisuspektit ultraäänipiirteet läsnä');
                    reasoning.push('Nopea uusinta välttämätön maligniteettiin viittaavien löydösten vuoksi');
                    riskLevel = 'warning';
                } else {
                    management = 'UÄ ja ONB-uusinta 12 kuukautta';
                    timing = 'Vuoden kuluttua';
                    followUp = 'Jos toistetusti riittämätön, UÄ-kontrolli 12 kk, kolmas näyte harvoin tarpeen';
                    reasoning.push('Ei malignisuspekteja ultraäänipiirteitä');
                    reasoning.push('Seuranta mahdollista, jos uusintanäyte ei ole edustava');
                }
                break;

            case '2': // Benigni (0-3%)
                if (hasMalignantFeatures) {
                    management = 'UÄ ja ONB-uusinta 6-12 kuukautta';
                    timing = 'Varmuuden vuoksi uusinta';
                    followUp = 'Jos uusintabiopsia benigni, seuranta päättyy';
                    reasoning.push('Ristiriita: benigni sytologia, mutta malignisuspektit US-piirteet');
                    reasoning.push('Uusintabiopsia suositeltava väärän negatiivisen tuloksen poissulkemiseksi');
                    riskLevel = 'warning';
                } else {
                    management = 'Ei seurantaa';
                    timing = '';
                    followUp = 'Hoidon päätös';
                    reasoning.push('Benigni sytologia ilman malignisuspekteja piirteitä');
                    reasoning.push('Maligniteettiriski <3%');
                    riskLevel = 'benign';
                }
                break;

            case '3': // Merkitykseltään määrittämätön atypia (5-15%)
                if (hasMalignantFeatures) {
                    management = 'UÄ ja ONB-uusinta 6 kuukautta';
                    timing = 'Puolen vuoden kuluttua';
                    followUp = 'Jos sytologinen löydös muuttumaton, kirurginen hoito (diagnostinen lobektomia)';
                    reasoning.push('Atypia + malignisuspektit US-piirteet');
                    reasoning.push('Kohonnut maligniteettiriski 5-15%');
                    reasoning.push('Uusintabiopsia diagnostiseen varmuuteen');
                    riskLevel = 'warning';
                } else {
                    management = 'UÄ ja ONB-uusinta 12 kuukautta';
                    timing = 'Vuoden kuluttua';
                    followUp = 'Jos sytologinen löydös muuttumaton, kirurginen hoito (diagnostinen lobektomia)';
                    reasoning.push('Atypia ilman selkeitä malignisuspekteja piirteitä');
                    reasoning.push('Maligniteettiriski 5-15%');
                }
                break;

            case '4': // Follikulaarinen neoplasia (15-30%)
                management = 'Kirurginen hoito';
                timing = 'Diagnostinen lobektomia';
                followUp = 'Histopatologinen diagnoosi leikkausprepraatista';
                reasoning.push('Follikulaarinen neoplasia - adenoma vs. karsinooma');
                reasoning.push('Maligniteettiriski 15-30%');
                reasoning.push('Erottelu adenoomasta ja karsinoomasta vaatii histologisen näytteen');
                reasoning.push('Lobektomia riittävä diagnostiseen selvitykseen');
                riskLevel = 'warning';
                if (hasMalignantFeatures) {
                    reasoning.push('Malignisuspektit US-piirteet nostavat maligniteettiriskiä');
                }
                break;

            case '5': // Epäily maligniteetista (60-75%)
                management = 'Kirurginen hoito';
                timing = 'Lobektomia tai totaltyreoidektomia';
                followUp = 'Jatkohoidon laajuus riippuu perioperatiivisesta PAD-vastauksesta';
                reasoning.push('Malignisuspekti sytologia');
                reasoning.push('Maligniteettiriski 60-75%');
                reasoning.push('Kirurginen hoito indikoitu');
                reasoning.push('Leikkaustavan valinta perustuu kyhmyn kokoon, sijaintiin ja kliiniseen tilanteeseen');
                riskLevel = 'high-risk';
                if (hasMalignantFeatures) {
                    reasoning.push('Vahvasti malignisuspektit US-piirteet tukevat diagnoosia');
                }
                break;

            case '6': // Maligni (97-99%)
                management = 'Kirurginen hoito';
                timing = 'Totaltyreoidektomia tai lobektomia';
                followUp = 'Jatkohoidon laajuus riippuu PAD-vastauksesta ja riskiluokituksesta';
                reasoning.push('Maligni sytologinen diagnoosi');
                reasoning.push('Maligniteettiriski 97-99%');
                reasoning.push('Kirurginen hoito välttämätön');
                reasoning.push('Totaltyreoidektomia suositeltava, jos:');
                reasoning.push('  - Kyhmy >4 cm');
                reasoning.push('  - Bilateraaliset kyhmyt');
                reasoning.push('  - Kliinisesti ilmeinen metastaasi');
                reasoning.push('  - Kasvu kilpirauhasen ulkopuolelle');
                reasoning.push('Lobektomia mahdollinen pienillä, yksipuolisilla kyhmyillä ilman metastasointia');
                riskLevel = 'high-risk';
                break;

            default:
                management = 'Virhe kategorian valinnassa';
                reasoning.push('Valitse Bethesda-kategoria');
        }

        return {
            management: management,
            timing: timing,
            followUp: followUp,
            reasoning: reasoning,
            riskLevel: riskLevel
        };
    }

    function displayBethesdaResult(result, category, features) {
        bethesdaRecommendationDiv.textContent = result.management;
        bethesdaRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>Jatkohoito:</h3>';
        rationaleHTML += '<p><strong>Bethesda-kategoria:</strong> ' + getBethesdaCategoryLabel(category) + '</p>';
        rationaleHTML += '<p><strong>Suositus:</strong> ' + result.management + '</p>';

        if (result.timing) {
            rationaleHTML += '<p><strong>Ajoitus/Laajuus:</strong> ' + result.timing + '</p>';
        }

        if (result.followUp) {
            rationaleHTML += '<p><strong>Jatkoseuranta:</strong> ' + result.followUp + '</p>';
        }

        if (features.length > 0) {
            rationaleHTML += '<p><strong>Ultraäänipiirteet:</strong></p><ul>';
            features.forEach(feature => {
                rationaleHTML += '<li>' + getBethesdaFeatureLabel(feature) + '</li>';
            });
            rationaleHTML += '</ul>';
        } else {
            rationaleHTML += '<p><strong>Ultraäänipiirteet:</strong> Ei malignisuspekteja piirteitä</p>';
        }

        rationaleHTML += '<p><strong>Kliininen perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        rationaleHTML += '<p><strong>Huomioitavaa:</strong></p><ul>';
        rationaleHTML += '<li>Jatkohoidon tarve arvioidaan yksilöllisesti</li>';
        rationaleHTML += '<li>Otettava huomioon potilaan ikä, perussairaudet ja kliininen tilanne</li>';
        rationaleHTML += '<li>Epäselvissä tapauksissa konsultoi alueellista asiantuntijaa</li>';
        rationaleHTML += '</ul>';

        bethesdaRationaleDiv.innerHTML = rationaleHTML;
        bethesdaResultContainer.style.display = 'block';
        bethesdaResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function getBethesdaCategoryLabel(value) {
        const labels = {
            '1': 'I - Riittämätön näyte',
            '2': 'II - Benigni (0-3%)',
            '3': 'III - Merkitykseltään määrittämätön atypia (5-15%)',
            '4': 'IV - Follikulaarinen neoplasia (15-30%)',
            '5': 'V - Epäily maligniteetista (60-75%)',
            '6': 'VI - Maligni (97-99%)'
        };
        return labels[value] || value;
    }

    function getBethesdaFeatureLabel(value) {
        const labels = {
            'microcalcifications': 'Mikrokalkit',
            'irregular-margins': 'Epätarkkarajaisuus',
            'extrathyroidal': 'Kasvu kilpirauhasen ulkopuolelle',
            'taller-than-wide': 'Korkeampi kuin leveämpi',
            'markedly-hypo': 'Vahvasti niukkakaikuinen (< strap-lihas)'
        };
        return labels[value] || value;
    }

    // Incidental findings form handling
    const incidentalForm = document.getElementById('incidentalForm');
    const incidentalResultContainer = document.getElementById('incidentalResult');
    const incidentalRecommendationDiv = document.getElementById('incidentalRecommendation');
    const incidentalRationaleDiv = document.getElementById('incidentalRationale');

    if (incidentalForm) {
        incidentalForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const size = parseInt(document.getElementById('incidentalSize').value);
            const composition = document.getElementById('incidentalComposition').value;
            const ageInput = document.getElementById('incidentalAge').value;
            const age = ageInput ? parseInt(ageInput) : null;
            const features = Array.from(document.querySelectorAll('input[name="incidentalFeature"]:checked'))
                .map(cb => cb.value);
            const riskGroup = document.querySelector('input[name="incidentalRisk"]:checked') !== null;

            const result = determineIncidentalManagement(size, composition, age, features, riskGroup);
            displayIncidentalResult(result, size, composition, age, features, riskGroup);
        });
    }

    function determineIncidentalManagement(size, composition, age, features, riskGroup) {
        const hasMalignantFeatures = features.length > 0;
        const isYoung = age !== null && age < 35;
        const isRiskGroup = riskGroup || isYoung;

        let surveillance = '';
        let timing = '';
        let reasoning = [];
        let riskLevel = 'low-risk';

        // < 1 cm nodules with malignant features
        if (size < 10 && hasMalignantFeatures) {
            if (isRiskGroup) {
                surveillance = 'UÄ-kontrolli 6-12 kuukautta tai FNA-harkinta';
                timing = 'Ensimmäinen kontrolli 6-12 kk, sen jälkeen vuosittain 5 vuoden ajan';
                reasoning.push('Alle 1 cm kyhmy malignisuspekteilla piirteillä');
                reasoning.push('Riskiryhmä - FNA voi olla aiheellinen');
                reasoning.push('Papillaariset mikrokarsinoomat kasvavat hitaasti');
                reasoning.push('Seuranta on ensisijainen vaihtoehto hyvän ennusteen vuoksi');
                riskLevel = 'warning';
            } else {
                surveillance = 'UÄ-seuranta suositeltava';
                timing = 'UÄ-kontrolli 6-12 kk, sen jälkeen vuosittain 5 vuoden ajan';
                reasoning.push('Alle 1 cm kyhmy malignisuspekteilla piirteillä (solidi, niukkakaikuinen, mikrokalkit)');
                reasoning.push('Papillaariset mikrokarsinoomat kasvavat hitaasti - hyvä ennuste');
                reasoning.push('Ensisijainen hoito on seuranta');
                reasoning.push('Ei rauhasen ulkopuoliseen kasvuun tai metastasointiin viittaavaa');
                riskLevel = 'warning';
            }
        }
        // < 1 cm nodules without malignant features
        else if (size < 10 && !hasMalignantFeatures) {
            if (composition === 'solid-hypo-mild') {
                surveillance = 'Ei seurantaa';
                timing = '';
                reasoning.push('Alle 1 cm solidi lievästi niukkakaikuinen ilman malignisuspekteja piirteitä');
                reasoning.push('Ei seurantaa tarvita');
                riskLevel = 'benign';
            } else {
                surveillance = 'Ei seurantaa';
                timing = '';
                reasoning.push('Alle 1 cm kyhmy ilman malignisuspekteja piirteitä');
                reasoning.push('Ei kontrollin tarvetta');
                riskLevel = 'benign';
            }
        }
        // ≥ 1 cm solid mildly hypoechoic
        else if (size >= 10 && composition === 'solid-hypo-mild' && !hasMalignantFeatures) {
            surveillance = 'UÄ-kontrolli 12 kuukautta';
            timing = 'Kertakontrolli vuoden kuluttua';
            reasoning.push('Solidi ≥1 cm lievästi niukkakaikuinen ilman maligneja piirteitä');
            reasoning.push('Ei täytä biopsiakriteeriä');
            reasoning.push('Suositellaan kontrolloitavaksi kerran vuoden kuluttua');
            riskLevel = 'low-risk';
        }
        // ≥ 1.5 cm solid iso/hyperechoic
        else if (size >= 15 && composition === 'solid-iso-hyper' && !hasMalignantFeatures) {
            surveillance = 'UÄ-kontrolli 12 kuukautta';
            timing = 'Kertakontrolli vuoden kuluttua';
            reasoning.push('Solidi ≥1.5 cm saman- tai runsaskaikuinen ilman maligneja piirteitä');
            reasoning.push('Ei täytä biopsiakriteeriä');
            reasoning.push('Suositellaan kontrolloitavaksi kerran vuoden kuluttua');
            riskLevel = 'low-risk';
        }
        // < 1.5 cm solid iso/hyperechoic without malignant features
        else if (size < 15 && composition === 'solid-iso-hyper' && !hasMalignantFeatures) {
            surveillance = 'Ei seurantaa';
            timing = '';
            reasoning.push('Alle 1.5 cm solidi saman- tai runsaskaikuinen ilman maligneja piirteitä');
            reasoning.push('Ei seurantaa tarvita');
            riskLevel = 'benign';
        }
        // Cystic-solid < 2 cm
        else if (size < 20 && composition === 'cystic-solid' && !hasMalignantFeatures) {
            surveillance = 'Ei seurantaa';
            timing = '';
            reasoning.push('Kystissolidi alle 2 cm ilman malignisuspekteja piirteitä');
            reasoning.push('Ei seurantaa tarvita');
            riskLevel = 'benign';
        }
        // Cystic-solid ≥ 2 cm
        else if (size >= 20 && composition === 'cystic-solid' && !hasMalignantFeatures) {
            surveillance = 'UÄ-kontrolli 12-24 kuukautta (harkinta)';
            timing = 'Kertakontrolli - tapauskohtainen päätös';
            reasoning.push('Kystissolidi ≥2 cm ilman malignisuspekteja piirteitä');
            reasoning.push('UÄ-kontrolli voidaan harkita');
            riskLevel = 'low-risk';
        }
        // Pure cystic
        else if (composition === 'cystic') {
            surveillance = 'Ei seurantaa';
            timing = '';
            reasoning.push('Puhtaasti kystinen muutos');
            reasoning.push('Voi sisältää sakkaa, kolloidikiteitä tai hunajakennorakennetta');
            reasoning.push('Ei seurantaa tarvita');
            riskLevel = 'benign';
        }
        // Nodules with malignant features ≥ 1 cm
        else if (hasMalignantFeatures) {
            surveillance = 'FNA suositeltava';
            timing = 'Kyhmyn koko ja piirteet täyttävät biopsiakriteerin';
            reasoning.push('Malignisuspektit ultraäänipiirteet läsnä');
            reasoning.push('Kyhmyn koko ' + size + ' mm');
            reasoning.push('FNA indikoitu malignisuspektien piirteiden perusteella');
            riskLevel = 'high-risk';
        }
        // Default
        else {
            surveillance = 'Tapauskohtainen arvio';
            timing = 'Arvioidaan yksilöllisesti';
            reasoning.push('Kyhmyn ominaisuudet vaativat yksilöllistä harkintaa');
            reasoning.push('Konsultoi tarvittaessa alueellista asiantuntijaa');
            riskLevel = 'low-risk';
        }

        return {
            surveillance: surveillance,
            timing: timing,
            reasoning: reasoning,
            riskLevel: riskLevel
        };
    }

    function displayIncidentalResult(result, size, composition, age, features, riskGroup) {
        incidentalRecommendationDiv.textContent = result.surveillance;
        incidentalRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>Seuranta:</h3>';
        rationaleHTML += '<p><strong>Suositus:</strong> ' + result.surveillance + '</p>';

        if (result.timing) {
            rationaleHTML += '<p><strong>Ajoitus:</strong> ' + result.timing + '</p>';
        }

        rationaleHTML += '<p><strong>Kyhmyn koko:</strong> ' + size + ' mm</p>';
        rationaleHTML += '<p><strong>Kaikurakenne:</strong> ' + getIncidentalCompositionLabel(composition) + '</p>';

        if (age !== null) {
            rationaleHTML += '<p><strong>Potilaan ikä:</strong> ' + age + ' vuotta';
            if (age < 35) {
                rationaleHTML += ' (riskiryhmä)';
            }
            rationaleHTML += '</p>';
        }

        if (riskGroup) {
            rationaleHTML += '<p><strong>Riskiryhmä:</strong> Kyllä</p>';
        }

        if (features.length > 0) {
            rationaleHTML += '<p><strong>Malignisuspektit piirteet:</strong></p><ul>';
            features.forEach(feature => {
                rationaleHTML += '<li>' + getIncidentalFeatureLabel(feature) + '</li>';
            });
            rationaleHTML += '</ul>';
        } else {
            rationaleHTML += '<p><strong>Malignisuspektit piirteet:</strong> Ei havaittu</p>';
        }

        rationaleHTML += '<p><strong>Perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        rationaleHTML += '<p><strong>Seurannassa huomioitavaa:</strong></p><ul>';
        rationaleHTML += '<li>Kasvu ≥20% (vähintään ≥2 mm) kahdessa suunnassa on aihe ONB:lle tai jatkoseurannalle</li>';
        rationaleHTML += '<li>Tilavuuden muutos >50% on aihe jatkoselvityksille</li>';
        rationaleHTML += '<li>UÄ-piirteiden muutos maligniksi on aihe ONB:lle</li>';
        rationaleHTML += '</ul>';

        incidentalRationaleDiv.innerHTML = rationaleHTML;
        incidentalResultContainer.style.display = 'block';
        incidentalResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function getIncidentalCompositionLabel(value) {
        const labels = {
            'solid-hypo-mild': 'Solidi lievästi niukkakaikuinen',
            'solid-iso-hyper': 'Solidi saman- tai runsaskaikuinen',
            'cystic-solid': 'Kystissolidi',
            'cystic': 'Puhtaasti kystinen'
        };
        return labels[value] || value;
    }

    function getIncidentalFeatureLabel(value) {
        const labels = {
            'microcalcifications': 'Mikrokalkit',
            'irregular-margins': 'Epätarkkarajaisuus',
            'extrathyroidal': 'Kasvu kilpirauhasen ulkopuolelle',
            'taller-than-wide': 'Korkeampi kuin leveämpi',
            'markedly-hypo': 'Vahvasti niukkakaikuinen'
        };
        return labels[value] || value;
    }

    // Calcium management form handling
    const calciumForm = document.getElementById('calciumForm');
    const calciumResultContainer = document.getElementById('calciumResult');
    const calciumRecommendationDiv = document.getElementById('calciumRecommendation');
    const calciumRationaleDiv = document.getElementById('calciumRationale');

    if (calciumForm) {
        calciumForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const calcium = parseFloat(document.getElementById('calciumLevel').value);
            const pthInput = document.getElementById('pthLevel').value;
            const pth = pthInput ? parseFloat(pthInput) : null;

            const result = determineCalciumManagement(calcium, pth);
            displayCalciumResult(result, calcium, pth);
        });
    }

    function determineCalciumManagement(calcium, pth) {
        let recommendation = '';
        let dosing = '';
        let followUp = '';
        let reasoning = [];
        let riskLevel = 'low-risk';

        // Severe hypocalcemia - do not discharge
        if (calcium < 1.05) {
            recommendation = 'Ei kotiutusta - aloita aktiivinen D-vitamiini';
            dosing = 'Kalsium-D-vitamiini 2×2 + Alfakalsidoli 0.5 µg × 2';
            followUp = 'Ionisoitunut kalsium joka aamu. Kotiutus vasta kun Ca++ ≥ 1.05 mmol/l';
            reasoning.push('Vaikea hypokalsemia (Ca++ < 1.05 mmol/l)');
            reasoning.push('Potilasta ei saa kotiuttaa');
            reasoning.push('Alfakalsidoli aloitetaan kalsium-D-vitamiinin rinnalle');
            if (pth !== null && pth < 0.58) {
                reasoning.push('PTH erittäin matala - pysyvän hypoparatyreoosin riski kohonnut');
            }
            reasoning.push('Vaikean hypokalsemian yhteydessä voidaan tarvita kalsiuminfuusiota');
            riskLevel = 'high-risk';
        }
        // Mild hypocalcemia
        else if (calcium >= 1.05 && calcium <= 1.15) {
            recommendation = 'Kalsium-D-vitamiinikorvaus, seuranta erikoissairaanhoidossa';
            dosing = 'Kalsium-D-vitamiini 2×2';
            followUp = 'Ohjaus endokrinologian poliklinikalle 1-3 viikon sisällä';
            reasoning.push('Lievä hypokalsemia (Ca++ 1.05-1.15 mmol/l)');
            reasoning.push('Kotiutus mahdollinen kalsiumlisällä');
            if (pth !== null) {
                if (pth < 0.58) {
                    reasoning.push('PTH matala - harkitse alfakalsidolin aloitusta');
                    riskLevel = 'warning';
                } else if (pth > 1.06) {
                    reasoning.push('PTH normaali - lisäkilpirauhasen toiminta todennäköisesti palautuu');
                }
            }
            riskLevel = 'warning';
        }
        // Low-normal calcium
        else if (calcium > 1.15 && calcium <= 1.30) {
            recommendation = 'Profylaktinen kalsium-D-vitamiinivalmiste';
            dosing = 'Kalsium-D-vitamiini 1×1-2';
            followUp = 'Kontrolli omalla terveysasemalla 1-2 kk kuluttua';
            reasoning.push('Kalsium viitealueen alarajalla (Ca++ 1.16-1.30 mmol/l)');
            reasoning.push('Profylaktinen korvaus suositeltava');
            if (pth !== null && pth > 1.06) {
                reasoning.push('PTH normaali - hyvä ennuste lisäkilpirauhasen toiminnalle');
            }
            riskLevel = 'low-risk';
        }
        // Normal calcium
        else {
            recommendation = 'Ei kalsiumlisää tarvita';
            dosing = 'Ei lääkitystä';
            followUp = 'Normaali seuranta';
            reasoning.push('Kalsium normaali (Ca++ > 1.30 mmol/l)');
            reasoning.push('Ei tarvetta kalsiumkorvaukselle');
            if (pth !== null && pth > 1.06) {
                reasoning.push('PTH normaali - lisäkilpirauhasen toiminta säilynyt');
            }
            riskLevel = 'benign';
        }

        // PTH-specific warnings
        if (pth !== null) {
            if (pth < 0.58 && calcium >= 1.05) {
                reasoning.push('HUOM: Matala PTH viittaa hypoparatyreoosiriskiin - tihennetty seuranta');
            }
        }

        return {
            recommendation: recommendation,
            dosing: dosing,
            followUp: followUp,
            reasoning: reasoning,
            riskLevel: riskLevel
        };
    }

    function displayCalciumResult(result, calcium, pth) {
        calciumRecommendationDiv.textContent = result.recommendation;
        calciumRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>Hoito-ohje:</h3>';
        rationaleHTML += '<p><strong>Ca++ (ionisoutunut):</strong> ' + calcium.toFixed(2) + ' mmol/l</p>';
        if (pth !== null) {
            rationaleHTML += '<p><strong>PTH:</strong> ' + pth.toFixed(2) + ' pmol/l</p>';
        }
        rationaleHTML += '<p><strong>Lääkitys:</strong> ' + result.dosing + '</p>';
        rationaleHTML += '<p><strong>Seuranta:</strong> ' + result.followUp + '</p>';

        rationaleHTML += '<p><strong>Perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        rationaleHTML += '<p><strong>Lääkevaihtoehtoja:</strong></p><ul>';
        rationaleHTML += '<li>Kalsium-D-vitamiinivalmisteet: Ideos®, Kalcipos®, Calci-Chew D3 Forte®, Minisun Calcium®</li>';
        rationaleHTML += '<li>Aktiivinen D-vitamiini: Alfakalsidoli (Etalpha® tai geneerinen)</li>';
        rationaleHTML += '</ul>';

        rationaleHTML += '<p><strong>Muistettavaa:</strong></p><ul>';
        rationaleHTML += '<li>Tyroksiini tulee ottaa vähintään 4 tuntia ennen kalsiumvalmistetta</li>';
        if (result.riskLevel === 'high-risk') {
            rationaleHTML += '<li>Mittaa myös plasman magnesiumpitoisuus vaikean hypokalsemian yhteydessä</li>';
        }
        rationaleHTML += '</ul>';

        calciumRationaleDiv.innerHTML = rationaleHTML;
        calciumResultContainer.style.display = 'block';
        calciumResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    // TNM Staging form handling
    const tnmForm = document.getElementById('tnmForm');
    const tnmResultContainer = document.getElementById('tnmResult');
    const tnmRecommendationDiv = document.getElementById('tnmRecommendation');
    const tnmRationaleDiv = document.getElementById('tnmRationale');

    if (tnmForm) {
        tnmForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const age = parseInt(document.getElementById('tnmAge').value);
            const tClass = document.getElementById('tClass').value;
            const nClass = document.getElementById('nClass').value;
            const mClass = document.getElementById('mClass').value;

            const result = determineTNMStage(age, tClass, nClass, mClass);
            displayTNMResult(result, age, tClass, nClass, mClass);
        });
    }

    function determineTNMStage(age, t, n, m) {
        let stage = '';
        let stageDescription = '';
        let reasoning = [];
        let riskLevel = 'low-risk';

        const isYoung = age < 55;
        const hasMetastasis = m === 'M1';
        const hasLymphNode = n === 'N1a' || n === 'N1b';

        // T category parsing
        const isT1 = t === 'T1a' || t === 'T1b';
        const isT2 = t === 'T2';
        const isT3 = t === 'T3a' || t === 'T3b';
        const isT4a = t === 'T4a';
        const isT4b = t === 'T4b';

        if (isYoung) {
            // Age < 55 years - only Stage I or II
            if (hasMetastasis) {
                stage = 'II';
                stageDescription = 'Levinneisyysaste II (ikä <55v, M1)';
                reasoning.push('Potilas alle 55-vuotias');
                reasoning.push('Etäpesäkkeitä todettu (M1)');
                reasoning.push('Alle 55-vuotiailla vain asteet I ja II');
                riskLevel = 'warning';
            } else {
                stage = 'I';
                stageDescription = 'Levinneisyysaste I (ikä <55v, M0)';
                reasoning.push('Potilas alle 55-vuotias');
                reasoning.push('Ei etäpesäkkeitä (M0)');
                reasoning.push('Alle 55-vuotiailla ilman etäpesäkkeitä aina aste I');
                reasoning.push('Ennuste erinomainen iästä riippumatta T- tai N-luokasta');
                riskLevel = 'benign';
            }
        } else {
            // Age >= 55 years
            if (hasMetastasis) {
                stage = 'IVB';
                stageDescription = 'Levinneisyysaste IVB (ikä ≥55v, M1)';
                reasoning.push('Potilas 55-vuotias tai vanhempi');
                reasoning.push('Etäpesäkkeitä todettu (M1)');
                riskLevel = 'high-risk';
            } else if (isT4b) {
                stage = 'IVA';
                stageDescription = 'Levinneisyysaste IVA (ikä ≥55v, T4b)';
                reasoning.push('Potilas 55-vuotias tai vanhempi');
                reasoning.push('Laaja paikallinen leviäminen (T4b)');
                reasoning.push('Kasvu prevertebraalifaskiaan, carotis-valtimon ympäri tai mediastinaalisiin suoniin');
                riskLevel = 'high-risk';
            } else if (isT4a) {
                stage = 'III';
                stageDescription = 'Levinneisyysaste III (ikä ≥55v, T4a)';
                reasoning.push('Potilas 55-vuotias tai vanhempi');
                reasoning.push('Paikallisesti edennyt tauti (T4a)');
                reasoning.push('Kasvu ihonalaisiin pehmytkudoksiin, kurkunpäähän, henkitorveen, ruokatorveen tai recurrens-hermoon');
                riskLevel = 'high-risk';
            } else if (isT3 || hasLymphNode) {
                stage = 'II';
                stageDescription = 'Levinneisyysaste II (ikä ≥55v)';
                reasoning.push('Potilas 55-vuotias tai vanhempi');
                if (isT3) reasoning.push('Suuri kasvain (T3: >4 cm) tai kasvu ympäröiviin lihaksiin');
                if (hasLymphNode) reasoning.push('Imusolmukemetastaaseja todettu (' + n + ')');
                riskLevel = 'warning';
            } else {
                stage = 'I';
                stageDescription = 'Levinneisyysaste I (ikä ≥55v, T1-2 N0)';
                reasoning.push('Potilas 55-vuotias tai vanhempi');
                reasoning.push('Pieni/keskikokoinen kasvain (≤4 cm)');
                reasoning.push('Ei imusolmukemetastaaseja');
                reasoning.push('Ei etäpesäkkeitä');
                riskLevel = 'benign';
            }
        }

        return {
            stage: stage,
            stageDescription: stageDescription,
            reasoning: reasoning,
            riskLevel: riskLevel
        };
    }

    function displayTNMResult(result, age, t, n, m) {
        tnmRecommendationDiv.textContent = result.stageDescription;
        tnmRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>TNM-luokitus:</h3>';
        rationaleHTML += '<p><strong>Ikä:</strong> ' + age + ' vuotta';
        if (age < 55) {
            rationaleHTML += ' (alle 55-vuotias)';
        } else {
            rationaleHTML += ' (55-vuotias tai vanhempi)';
        }
        rationaleHTML += '</p>';
        rationaleHTML += '<p><strong>T-luokka:</strong> ' + t + '</p>';
        rationaleHTML += '<p><strong>N-luokka:</strong> ' + n + '</p>';
        rationaleHTML += '<p><strong>M-luokka:</strong> ' + m + '</p>';
        rationaleHTML += '<p><strong>Levinneisyysaste:</strong> ' + result.stage + '</p>';

        rationaleHTML += '<p><strong>Perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        rationaleHTML += '<p><strong>Ennuste ja hoito:</strong></p><ul>';
        if (result.stage === 'I') {
            rationaleHTML += '<li>Erinomainen ennuste</li>';
            rationaleHTML += '<li>5-vuotiselossaoloennuste >98%</li>';
        } else if (result.stage === 'II') {
            rationaleHTML += '<li>Hyvä ennuste</li>';
            rationaleHTML += '<li>Tihennetty seuranta suositeltava</li>';
        } else if (result.stage === 'III' || result.stage === 'IVA') {
            rationaleHTML += '<li>Kohtalainen ennuste</li>';
            rationaleHTML += '<li>Moniammatillinen arvio suositeltava</li>';
            rationaleHTML += '<li>Radiojodihoito todennäköisesti aiheellinen</li>';
        } else if (result.stage === 'IVB') {
            rationaleHTML += '<li>Vaativa tilanne - moniammatillinen arvio välttämätön</li>';
            rationaleHTML += '<li>Hoitovaste riippuu etäpesäkkeiden radiojodiherkyydestä</li>';
        }
        rationaleHTML += '</ul>';

        tnmRationaleDiv.innerHTML = rationaleHTML;
        tnmResultContainer.style.display = 'block';
        tnmResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    // Risk Stratification form handling
    const riskForm = document.getElementById('riskForm');
    const riskResultContainer = document.getElementById('riskResult');
    const riskRecommendationDiv = document.getElementById('riskRecommendation');
    const riskRationaleDiv = document.getElementById('riskRationale');

    if (riskForm) {
        riskForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const tumorSize = parseInt(document.getElementById('riskTumorSize').value);
            const features = Array.from(document.querySelectorAll('input[name="riskFeature"]:checked'))
                .map(cb => cb.value);

            const result = determineRiskCategory(tumorSize, features);
            displayRiskResult(result, tumorSize, features);
        });
    }

    function determineRiskCategory(tumorSize, features) {
        let riskCategory = 'low';
        let riskDescription = '';
        let raiRecommendation = '';
        let raiDose = '';
        let reasoning = [];
        let highRiskFeatures = [];
        let intermediateRiskFeatures = [];

        // Define high-risk features
        const highRisk = ['macroMargin', 'macroExtrathyroidal', 'vascular4plus', 'widelyInvasive',
                         'poorlyDiff', 'largeMeta', 'extracapsular', 'distantMeta'];

        // Define intermediate-risk features
        const intermediateRisk = ['extrathyroidal', 'vascular13', 'aggressive', 'braf2cm',
                                  'macroMeta', 'microMeta5'];

        // Check for high-risk features
        features.forEach(f => {
            if (highRisk.includes(f)) {
                highRiskFeatures.push(f);
            } else if (intermediateRisk.includes(f)) {
                intermediateRiskFeatures.push(f);
            }
        });

        // Large tumor is intermediate risk
        if (tumorSize > 40) {
            intermediateRiskFeatures.push('largeTumor');
        }

        // Determine risk category
        if (highRiskFeatures.length > 0) {
            riskCategory = 'high';
            riskDescription = 'KORKEA RISKI (uusimisriski >30%)';
            raiRecommendation = 'Radiojodihoito suositeltava';
            raiDose = '3.7 GBq';
            reasoning.push('Korkean riskin piirteitä todettu');
        } else if (intermediateRiskFeatures.length > 0) {
            riskCategory = 'intermediate';
            riskDescription = 'KOHTALAINEN RISKI (uusimisriski 6-30%)';
            raiRecommendation = 'Radiojodihoito suositeltava';
            raiDose = '3.7 GBq';
            reasoning.push('Kohtalaisen riskin piirteitä todettu');
        } else {
            riskCategory = 'low';
            riskDescription = 'MATALA RISKI (uusimisriski <6%)';
            if (tumorSize < 10) {
                raiRecommendation = 'Radiojodihoitoa ei tarvita';
                raiDose = 'Ei hoitoa';
                reasoning.push('<1 cm matalan riskin kasvain ei vaadi radiojodihoitoa');
            } else {
                raiRecommendation = 'Radiojodihoito yleensä ei tarvita, seuranta riittää';
                raiDose = 'Tarvittaessa 1.1 GBq';
                reasoning.push('1-4 cm matalan riskin kasvaimissa radiojodin voi jättää antamatta');
                reasoning.push('Edellytykset: tyreoglobuliini <0.2 µg/l ja vasta-ainetaso normaali');
            }
        }

        // Add specific feature reasons
        const featureLabels = {
            'macroMargin': 'Makroskooppinen marginaalipositiivisuus',
            'macroExtrathyroidal': 'Makroskooppinen kasvu kilpirauhasen ulkopuolelle',
            'vascular4plus': 'Verisuoni-invaasio ≥4 suonessa',
            'widelyInvasive': 'Laajasti invasiivinen karsinooma',
            'poorlyDiff': 'Huonosti erilaistunut karsinooma',
            'largeMeta': 'Suuri (>30 mm) imusolmukemetastaasi',
            'extracapsular': 'Ekstrakapsulaarinen kasvu imusolmukkeessa',
            'distantMeta': 'Etäpesäkkeet',
            'extrathyroidal': 'Mikroskooppinen kasvu kilpirauhasen ulkopuolelle',
            'vascular13': 'Verisuoni-invaasio (1-3 suonessa)',
            'aggressive': 'Aggressiivinen histologia ≥1 cm kasvaimessa',
            'braf2cm': 'BRAF V600E -mutaatio ≥2 cm kasvaimessa',
            'macroMeta': 'Makrometastaasi imusolmukkeessa',
            'microMeta5': 'Mikrometastaaseja ≥5 imusolmukkeessa',
            'largeTumor': 'Kasvain >4 cm'
        };

        highRiskFeatures.forEach(f => {
            reasoning.push('Korkean riskin piirre: ' + featureLabels[f]);
        });

        intermediateRiskFeatures.forEach(f => {
            reasoning.push('Kohtalaisen riskin piirre: ' + featureLabels[f]);
        });

        return {
            riskCategory: riskCategory,
            riskDescription: riskDescription,
            raiRecommendation: raiRecommendation,
            raiDose: raiDose,
            reasoning: reasoning,
            highRiskFeatures: highRiskFeatures,
            intermediateRiskFeatures: intermediateRiskFeatures
        };
    }

    function displayRiskResult(result, tumorSize, features) {
        riskRecommendationDiv.textContent = result.riskDescription;

        if (result.riskCategory === 'high') {
            riskRecommendationDiv.className = 'recommendation high-risk';
        } else if (result.riskCategory === 'intermediate') {
            riskRecommendationDiv.className = 'recommendation warning';
        } else {
            riskRecommendationDiv.className = 'recommendation benign';
        }

        let rationaleHTML = '<h3>Arviointi:</h3>';
        rationaleHTML += '<p><strong>Kasvaimen koko:</strong> ' + tumorSize + ' mm</p>';
        rationaleHTML += '<p><strong>Riskiluokka:</strong> ' + result.riskDescription + '</p>';
        rationaleHTML += '<p><strong>Radiojodihoitosuositus:</strong> ' + result.raiRecommendation + '</p>';
        rationaleHTML += '<p><strong>Radiojodiannos:</strong> ' + result.raiDose + '</p>';

        rationaleHTML += '<p><strong>Perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        // Add treatment considerations
        rationaleHTML += '<p><strong>Hoitosuunnittelussa huomioitavaa:</strong></p><ul>';
        if (result.riskCategory === 'high') {
            rationaleHTML += '<li>Radiojodihoito 3.7 GBq suositeltava vasta-aiheiden puuttuessa</li>';
            rationaleHTML += '<li>TSH-stimulaatio rhTSH-valmisteella tai tyroksiinitauolla</li>';
            rationaleHTML += '<li>Vähäjodinen ruokavalio 2 viikkoa ennen hoitoa</li>';
            if (features.includes('poorlyDiff')) {
                rationaleHTML += '<li>HUOM: Huonosti erilaistuneet karsinoomat reagoivat usein huonommin radiojodiin - ulkoisen sädehoidon tarve arvioitava</li>';
            }
        } else if (result.riskCategory === 'intermediate') {
            rationaleHTML += '<li>Radiojodihoito 3.7 GBq lähtökohtaisesti suositeltava</li>';
            rationaleHTML += '<li>Poikkeustapauksissa seuranta mahdollinen, jos tyreoglobuliini stabiili <2 µg/l</li>';
            rationaleHTML += '<li>TSH-stimulaatio suositeltava rhTSH-valmisteella</li>';
        } else {
            rationaleHTML += '<li>Postoperatiivinen tyreoglobuliini tarkistettava (tavoite <0.2 µg/l)</li>';
            rationaleHTML += '<li>Tyreoglobuliinivasta-aineet tarkistettava</li>';
            rationaleHTML += '<li>Jos Tg 0.2-2 µg/l: kontrolli 2 kk kuluttua</li>';
            rationaleHTML += '<li>Jos Tg >2 µg/l tai vasta-aineet koholla: harkitse radiojodia 1.1 GBq</li>';
        }
        rationaleHTML += '</ul>';

        riskRationaleDiv.innerHTML = rationaleHTML;
        riskResultContainer.style.display = 'block';
        riskResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    // Response Assessment form handling (6.1)
    const responseForm = document.getElementById('responseForm');
    const responseResultContainer = document.getElementById('responseResult');
    const responseRecommendationDiv = document.getElementById('responseRecommendation');
    const responseRationaleDiv = document.getElementById('responseRationale');

    if (responseForm) {
        responseForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const hadRAI = document.querySelector('input[name="hadRAI"]:checked').value;
            const suppressedTg = parseFloat(document.getElementById('suppressedTg').value);
            const stimulatedTgInput = document.getElementById('stimulatedTg').value;
            const stimulatedTg = stimulatedTgInput ? parseFloat(stimulatedTgInput) : null;
            const tgAb = document.querySelector('input[name="tgAb"]:checked').value;
            const ultrasound = document.querySelector('input[name="ultrasound"]:checked').value;

            const result = determineResponseCategory(hadRAI, suppressedTg, stimulatedTg, tgAb, ultrasound);
            displayResponseResult(result, suppressedTg, stimulatedTg, tgAb, ultrasound);
        });

        responseForm.addEventListener('reset', function() {
            responseResultContainer.style.display = 'none';
        });
    }

    function determineResponseCategory(hadRAI, suppressedTg, stimulatedTg, tgAb, ultrasound) {
        let category = '';
        let recommendation = '';
        let riskLevel = 'low-risk';
        let reasoning = [];

        // Structural disease takes priority
        if (ultrasound === 'positive') {
            category = 'Mitattavaa tautia jäljellä';
            recommendation = 'Yksilöllinen hoitosuunnitelma (kirurgia, RAI, sädehoito, lääkehoito)';
            riskLevel = 'high-risk';
            reasoning.push('Kuvantamisessa selvä tauti');
            reasoning.push('Hoito suunnitellaan moniammatillisesti');
        }
        // Rising TgAb is concerning
        else if (tgAb === 'rising') {
            category = 'Biokemiallinen epätäydellinen vaste';
            recommendation = 'Uusinta radiojodihoito yleensä perusteltu';
            riskLevel = 'high-risk';
            reasoning.push('TgAb nousussa viittaa aktiiviseen tautiin');
            reasoning.push('Nouseva TgAb on indikaatio radiojodihoidolle');
        }
        // Check Tg levels based on RAI status
        else if (hadRAI === 'yes') {
            // Post-RAI assessment
            if (ultrasound === 'normal' && tgAb === 'negative') {
                if (suppressedTg < 0.2 && (stimulatedTg === null || stimulatedTg < 1)) {
                    category = 'Erinomainen vaste';
                    recommendation = 'Seuranta, ei uusintahoitoja. Uusimisriski <2%';
                    riskLevel = 'benign';
                    reasoning.push('UÄ normaali, Tg matala, TgAb negatiivinen');
                } else if (suppressedTg <= 1 || (stimulatedTg !== null && stimulatedTg <= 10)) {
                    category = 'Epävarma tilanne';
                    recommendation = 'Ei uusintahoitoa, mutta tiivis seuranta';
                    riskLevel = 'warning';
                    reasoning.push('Tg-taso epävarmalla alueella');
                } else {
                    category = 'Biokemiallinen epätäydellinen vaste';
                    recommendation = 'Uusinta radiojodihoito yleensä perusteltu';
                    riskLevel = 'high-risk';
                    reasoning.push('Kohonnut Tg viittaa jäljellä olevaan tautiin');
                }
            } else if (ultrasound === 'suspicious' || tgAb === 'stable') {
                category = 'Epävarma tilanne';
                recommendation = 'Tiivis seuranta, ei välttämättä uusintahoitoa';
                riskLevel = 'warning';
                if (ultrasound === 'suspicious') reasoning.push('Epäilyttävä UÄ-löydös');
                if (tgAb === 'stable') reasoning.push('TgAb koholla mutta stabiili/laskeva');
            } else {
                category = 'Biokemiallinen epätäydellinen vaste';
                recommendation = 'Uusinta radiojodihoito harkittava';
                riskLevel = 'high-risk';
                reasoning.push('Kohonnut Tg ilman normaalia UÄ-löydöstä');
            }
        } else {
            // No prior RAI
            if (ultrasound === 'normal' && suppressedTg < 0.2 && tgAb === 'negative') {
                category = 'Erinomainen vaste';
                recommendation = 'Seuranta riittää';
                riskLevel = 'benign';
                reasoning.push('Matala riski ilman radiojodihoitoa');
            } else if (suppressedTg <= 2) {
                category = 'Epävarma tilanne';
                recommendation = 'Kontrolli 6-12 kk, harkitse RAI:ta';
                riskLevel = 'warning';
                reasoning.push('Tg 0.2-2 µg/l tai TgAb koholla');
            } else {
                category = 'Biokemiallinen epätäydellinen vaste';
                recommendation = 'Radiojodihoito 1.1 GBq suositeltava';
                riskLevel = 'high-risk';
                reasoning.push('Tg >2 µg/l tai nousussa');
            }
        }

        return {
            category: category,
            recommendation: recommendation,
            riskLevel: riskLevel,
            reasoning: reasoning
        };
    }

    function displayResponseResult(result, suppressedTg, stimulatedTg, tgAb, ultrasound) {
        responseRecommendationDiv.textContent = result.category;
        responseRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>Arvio:</h3>';
        rationaleHTML += '<p><strong>Tyroksiinin aikainen Tg:</strong> ' + suppressedTg.toFixed(2) + ' µg/l</p>';
        if (stimulatedTg !== null) {
            rationaleHTML += '<p><strong>Stimuloitu Tg:</strong> ' + stimulatedTg.toFixed(2) + ' µg/l</p>';
        }
        rationaleHTML += '<p><strong>TgAb:</strong> ' + getTgAbLabel(tgAb) + '</p>';
        rationaleHTML += '<p><strong>UÄ-löydös:</strong> ' + getUltrasoundLabel(ultrasound) + '</p>';

        rationaleHTML += '<p><strong>Suositus:</strong> ' + result.recommendation + '</p>';

        rationaleHTML += '<p><strong>Perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        responseRationaleDiv.innerHTML = rationaleHTML;
        responseResultContainer.style.display = 'block';
        responseResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function getTgAbLabel(value) {
        const labels = {
            'negative': 'Negatiivinen',
            'stable': 'Koholla, stabiili/laskeva',
            'rising': 'Koholla, nousussa'
        };
        return labels[value] || value;
    }

    function getUltrasoundLabel(value) {
        const labels = {
            'normal': 'Normaali',
            'suspicious': 'Epäilyttävä löydös',
            'positive': 'Selvä tauti'
        };
        return labels[value] || value;
    }

    // TSH Targets form handling (6.3)
    const tshForm = document.getElementById('tshForm');
    const tshResultContainer = document.getElementById('tshResult');
    const tshRecommendationDiv = document.getElementById('tshRecommendation');
    const tshRationaleDiv = document.getElementById('tshRationale');

    if (tshForm) {
        // Toggle visibility of risk vs response fields
        const responseAssessedRadios = document.querySelectorAll('input[name="responseAssessed"]');
        responseAssessedRadios.forEach(radio => {
            radio.addEventListener('change', function() {
                const riskGroup = document.getElementById('riskCategoryGroup');
                const responseGroup = document.getElementById('responseStatusGroup');
                if (this.value === 'yes') {
                    riskGroup.style.display = 'none';
                    responseGroup.style.display = 'block';
                } else {
                    riskGroup.style.display = 'block';
                    responseGroup.style.display = 'none';
                }
            });
        });

        tshForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const surgeryType = document.querySelector('input[name="surgeryType"]:checked').value;
            const responseAssessed = document.querySelector('input[name="responseAssessed"]:checked').value;
            const riskCategory = document.querySelector('input[name="riskCategory"]:checked');
            const responseStatus = document.querySelector('input[name="responseStatus"]:checked');

            const result = determineTSHTarget(surgeryType, responseAssessed,
                riskCategory ? riskCategory.value : null,
                responseStatus ? responseStatus.value : null);
            displayTSHResult(result, surgeryType, responseAssessed);
        });

        tshForm.addEventListener('reset', function() {
            tshResultContainer.style.display = 'none';
            document.getElementById('riskCategoryGroup').style.display = 'block';
            document.getElementById('responseStatusGroup').style.display = 'none';
        });
    }

    function determineTSHTarget(surgeryType, responseAssessed, riskCategory, responseStatus) {
        let target = '';
        let reasoning = [];
        let riskLevel = 'low-risk';

        if (surgeryType === 'lobectomy') {
            target = '0.5-2.0 mU/l';
            reasoning.push('Lobektomia - aina matalan riskin hoitolinja');
            reasoning.push('Normaali TSH-tavoite riittää');
            riskLevel = 'benign';
        } else if (responseAssessed === 'no') {
            // Pre-response assessment
            if (riskCategory === 'high') {
                target = '<0.1 mU/l';
                reasoning.push('Korkean riskin potilas - TSH-suppressio tarpeen');
                reasoning.push('Pidä T3v viitealueella');
                riskLevel = 'high-risk';
            } else {
                target = '0.1-0.5 mU/l';
                reasoning.push('Matalan/kohtalaisen riskin potilas ennen vastearviota');
                riskLevel = 'warning';
            }
        } else {
            // Post-response assessment
            switch (responseStatus) {
                case 'excellent':
                    target = '0.5-2.0 mU/l';
                    reasoning.push('Erinomainen vaste - normaali TSH-tavoite riittää');
                    riskLevel = 'benign';
                    break;
                case 'indeterminate':
                case 'biochemical':
                    target = '0.1-0.5 mU/l';
                    reasoning.push('Epävarma/epätäydellinen vaste - lievä suppressio');
                    riskLevel = 'warning';
                    break;
                case 'structural':
                    target = '<0.1 mU/l';
                    reasoning.push('Mitattavaa tautia jäljellä - TSH-suppressio tarpeen');
                    reasoning.push('Pidä T3v viitealueella');
                    riskLevel = 'high-risk';
                    break;
            }
        }

        return {
            target: target,
            reasoning: reasoning,
            riskLevel: riskLevel
        };
    }

    function displayTSHResult(result, surgeryType, responseAssessed) {
        tshRecommendationDiv.textContent = 'TSH-tavoite: ' + result.target;
        tshRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>Suositus:</h3>';
        rationaleHTML += '<p><strong>Leikkaustyyppi:</strong> ' + (surgeryType === 'lobectomy' ? 'Lobektomia' : 'Totaaliresektio') + '</p>';
        rationaleHTML += '<p><strong>Vastearvio:</strong> ' + (responseAssessed === 'yes' ? 'Tehty' : 'Ei vielä') + '</p>';

        rationaleHTML += '<p><strong>Perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        rationaleHTML += '<p><strong>Muistettavaa:</strong></p><ul>';
        rationaleHTML += '<li>Annoksen muutostarpeen arvio 6-8 viikon kuluttua</li>';
        rationaleHTML += '<li>Suppressiohoito voi altistaa osteoporoosille ja sydän-verisuonitaudeille</li>';
        rationaleHTML += '</ul>';

        tshRationaleDiv.innerHTML = rationaleHTML;
        tshResultContainer.style.display = 'block';
        tshResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    // Genetic Predisposition form handling (8.1)
    const geneticForm = document.getElementById('geneticForm');
    const geneticResultContainer = document.getElementById('geneticResult');
    const geneticRecommendationDiv = document.getElementById('geneticRecommendation');
    const geneticRationaleDiv = document.getElementById('geneticRationale');

    if (geneticForm) {
        geneticForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const affectedRelatives = document.getElementById('affectedRelatives').value;
            const youngestAgeInput = document.getElementById('youngestAge').value;
            const youngestAge = youngestAgeInput ? parseInt(youngestAgeInput) : null;
            const syndromeFeatures = Array.from(document.querySelectorAll('input[name="syndromeFeature"]:checked'))
                .map(cb => cb.value);

            const result = determineGeneticScreening(affectedRelatives, youngestAge, syndromeFeatures);
            displayGeneticResult(result, affectedRelatives, youngestAge, syndromeFeatures);
        });

        geneticForm.addEventListener('reset', function() {
            geneticResultContainer.style.display = 'none';
        });
    }

    function determineGeneticScreening(affectedRelatives, youngestAge, syndromeFeatures) {
        let recommendation = '';
        let screeningProtocol = '';
        let geneticTesting = false;
        let reasoning = [];
        let riskLevel = 'low-risk';

        // Check for syndrome features first
        if (syndromeFeatures.length > 0) {
            geneticTesting = true;
            recommendation = 'Geneettinen tutkimus suositeltava';
            riskLevel = 'high-risk';
            reasoning.push('Kasvainalttiusoireyhtymän piirteitä todettu');
            reasoning.push('Konsultoi kliinisen genetiikan yksikköä');
            screeningProtocol = 'Vuosittainen kilpirauhasen UÄ oireyhtymän kantajille';
        }
        // Then check family history
        else if (affectedRelatives === '3') {
            recommendation = 'Vuosittainen kilpirauhasen UÄ-seuranta';
            riskLevel = 'high-risk';
            reasoning.push('≥3 sairastunutta suvussa - 99% todennäköisyydellä familiaalinen tauti');
            reasoning.push('Perustuu ATA/NIH-suositukseen');

            if (youngestAge !== null) {
                const screeningStart = Math.max(10, youngestAge - 10);
                screeningProtocol = 'Aloitus ' + screeningStart + ' vuoden iässä tai 20 vuoden iässä (kumpi tulee ensin)';
            } else {
                screeningProtocol = 'Aloitus 20 vuoden iässä tai 10 vuotta ennen suvun nuorimman sairastumisikää';
            }
        } else if (affectedRelatives === '2') {
            recommendation = 'Kaulan palpaatio, ei rutiini-UÄ-seulontaa';
            riskLevel = 'warning';
            reasoning.push('2 sairastunutta suvussa - sporadisen taudin osuus ~50%');
            reasoning.push('Rutiininomaista UÄ-seulontaa ei suositella');
            screeningProtocol = 'Kliininen seuranta, UÄ oireiden ilmaantuessa';
        } else if (affectedRelatives === '1') {
            recommendation = 'Ei erityistä seulontaa';
            riskLevel = 'low-risk';
            reasoning.push('Yksittäinen sairastunut suvussa - ei viitettä familiaaliseen tautiin');
            screeningProtocol = 'Normaali terveydenhuolto';
        } else {
            recommendation = 'Ei erityistä seulontaa';
            riskLevel = 'benign';
            reasoning.push('Ei sukurasitusta');
            screeningProtocol = 'Normaali terveydenhuolto';
        }

        return {
            recommendation: recommendation,
            screeningProtocol: screeningProtocol,
            geneticTesting: geneticTesting,
            reasoning: reasoning,
            riskLevel: riskLevel
        };
    }

    function displayGeneticResult(result, affectedRelatives, youngestAge, syndromeFeatures) {
        geneticRecommendationDiv.textContent = result.recommendation;
        geneticRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>Seulontasuositus:</h3>';
        rationaleHTML += '<p><strong>Sairastuneet sukulaiset:</strong> ' + getRelativesLabel(affectedRelatives) + '</p>';
        if (youngestAge !== null) {
            rationaleHTML += '<p><strong>Nuorimman sairastumisikä:</strong> ' + youngestAge + ' vuotta</p>';
        }

        if (result.geneticTesting) {
            rationaleHTML += '<p><strong>Geneettinen tutkimus:</strong> Suositeltava</p>';
        }

        rationaleHTML += '<p><strong>Seulontaprotokolla:</strong> ' + result.screeningProtocol + '</p>';

        rationaleHTML += '<p><strong>Perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        if (syndromeFeatures.length > 0) {
            rationaleHTML += '<p><strong>Oireyhtymäpiirteet:</strong></p><ul>';
            syndromeFeatures.forEach(feature => {
                rationaleHTML += '<li>' + getSyndromeLabel(feature) + '</li>';
            });
            rationaleHTML += '</ul>';
        }

        geneticRationaleDiv.innerHTML = rationaleHTML;
        geneticResultContainer.style.display = 'block';
        geneticResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function getRelativesLabel(value) {
        const labels = {
            '0': 'Ei yhtään',
            '1': '1 sukulainen',
            '2': '2 sukulaista',
            '3': '3 tai enemmän'
        };
        return labels[value] || value;
    }

    function getSyndromeLabel(value) {
        const labels = {
            'fap': 'FAP/Gardner (GI-polyypit, osteoomat)',
            'cowden': 'Cowden (hamartoomat, rintasyöpäalttius)',
            'carney': 'Carney (endokriinikasvaimet)',
            'werner': 'Werner (sarkoomat, progeria)',
            'dicer1': 'DICER1 (blastooma, monikyhmystruuma)'
        };
        return labels[value] || value;
    }

    // Pregnancy form handling (8.2)
    const pregnancyForm = document.getElementById('pregnancyForm');
    const pregnancyResultContainer = document.getElementById('pregnancyResult');
    const pregnancyRecommendationDiv = document.getElementById('pregnancyRecommendation');
    const pregnancyRationaleDiv = document.getElementById('pregnancyRationale');

    if (pregnancyForm) {
        // Toggle visibility of conditional fields
        const scenarioRadios = document.querySelectorAll('input[name="pregnancyScenario"]');
        scenarioRadios.forEach(radio => {
            radio.addEventListener('change', function() {
                const trimesterGroup = document.getElementById('trimesterGroup');
                const tumorGroup = document.getElementById('tumorFeaturesGroup');
                const diseaseGroup = document.getElementById('diseaseStatusGroup');
                const postTreatmentGroup = document.getElementById('postTreatmentGroup');

                trimesterGroup.style.display = 'none';
                tumorGroup.style.display = 'none';
                diseaseGroup.style.display = 'none';
                postTreatmentGroup.style.display = 'none';

                if (this.value === 'newDiagnosis') {
                    trimesterGroup.style.display = 'block';
                    tumorGroup.style.display = 'block';
                } else if (this.value === 'previousTreatment') {
                    diseaseGroup.style.display = 'block';
                } else if (this.value === 'planningPregnancy') {
                    postTreatmentGroup.style.display = 'block';
                }
            });
        });

        pregnancyForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const scenario = document.querySelector('input[name="pregnancyScenario"]:checked').value;
            const trimester = document.querySelector('input[name="trimester"]:checked');
            const features = Array.from(document.querySelectorAll('input[name="pregnancyFeature"]:checked'))
                .map(cb => cb.value);
            const diseaseStatus = document.querySelector('input[name="diseaseStatus"]:checked');
            const lastTreatment = document.querySelector('input[name="lastTreatment"]:checked');

            const result = determinePregnancyManagement(scenario,
                trimester ? trimester.value : null,
                features,
                diseaseStatus ? diseaseStatus.value : null,
                lastTreatment ? lastTreatment.value : null);
            displayPregnancyResult(result, scenario);
        });

        pregnancyForm.addEventListener('reset', function() {
            pregnancyResultContainer.style.display = 'none';
            document.getElementById('trimesterGroup').style.display = 'none';
            document.getElementById('tumorFeaturesGroup').style.display = 'none';
            document.getElementById('diseaseStatusGroup').style.display = 'none';
            document.getElementById('postTreatmentGroup').style.display = 'none';
        });
    }

    function determinePregnancyManagement(scenario, trimester, features, diseaseStatus, lastTreatment) {
        let recommendation = '';
        let tshTarget = '';
        let followUp = '';
        let reasoning = [];
        let riskLevel = 'low-risk';

        if (scenario === 'newDiagnosis') {
            const hasHighRiskFeatures = features.includes('symptoms') || features.includes('lymphNodes') ||
                                       features.includes('growth') || features.includes('invasion');

            if (hasHighRiskFeatures) {
                if (trimester === 'second') {
                    recommendation = 'Leikkaushoito suositeltava 2. raskauskolmanneksella';
                    reasoning.push('Korkean riskin piirteitä todettu');
                    reasoning.push('2. raskauskolmannes on optimaalinen leikkausajankohta');
                    riskLevel = 'high-risk';
                } else if (trimester === 'first') {
                    recommendation = 'Tiivis seuranta, leikkaus 2. kolmanneksella jos progressio';
                    reasoning.push('1. kolmanneksella spontaanin keskenmenon riski kohonnut');
                    reasoning.push('Seuraa UÄ:llä 1. kolmanneksen lopussa');
                    riskLevel = 'warning';
                } else {
                    recommendation = 'Leikkaus synnytyksen jälkeen';
                    reasoning.push('3. kolmanneksella ennenaikaisen synnytyksen riski');
                    reasoning.push('Jos tauti pysyy stabiilina, leikkaus synnytyksen jälkeen');
                    riskLevel = 'warning';
                }
                tshTarget = '0.3-2.0 mU/l';
            } else {
                recommendation = 'Seuranta, leikkaus synnytyksen jälkeen';
                reasoning.push('Ei korkean riskin piirteitä');
                reasoning.push('UÄ-seuranta joka raskauskolmanneksessa');
                tshTarget = 'Jos TSH >2 mU/l, harkitse levotyroksiinia (tavoite 0.3-2.0 mU/l)';
                riskLevel = 'low-risk';
            }
            followUp = 'UÄ joka raskauskolmanneksessa';
        } else if (scenario === 'previousTreatment') {
            switch (diseaseStatus) {
                case 'cured':
                    recommendation = 'Normaali raskausseuranta';
                    tshTarget = '0.5-2.5 mU/l';
                    followUp = 'Rutiini-Tg/UÄ-seurantaa ei tarvita raskausaikana';
                    reasoning.push('Tautivapaa potilas - normaali hypotyreosin hoito');
                    reasoning.push('Raskaus ei lisää uusiutumisriskiä');
                    riskLevel = 'benign';
                    break;
                case 'indeterminate':
                    recommendation = 'Seuranta raskausaikana';
                    tshTarget = 'Ennen raskautta asetettu tavoite';
                    followUp = 'UÄ + Tg raskausaikana';
                    reasoning.push('Epävarma tilanne - seuranta tarpeen');
                    riskLevel = 'warning';
                    break;
                case 'active':
                    recommendation = 'Tiivis seuranta, TSH-suppressio';
                    tshTarget = '<0.1 mU/l';
                    followUp = 'UÄ + Tg joka raskauskolmanneksessa';
                    reasoning.push('Aktiivinen tauti - TSH-suppressio läpi raskauden');
                    reasoning.push('T3v pidettävä viitealueella');
                    riskLevel = 'high-risk';
                    break;
            }
            reasoning.push('Nosta levotyroksiiniannosta 25-50 µg heti raskauden alettua');
        } else if (scenario === 'planningPregnancy') {
            if (lastTreatment === 'rai') {
                recommendation = 'Odota vähintään 6 kk radiojodihoidosta';
                reasoning.push('Varoaika vähintään 6 kk, mieluiten 12 kk remission varmistamiseksi');
                reasoning.push('Miehillä varoaika 3-6 kk');
                riskLevel = 'warning';
            } else if (lastTreatment === 'breastfeeding') {
                recommendation = 'Lopeta imetys 2-3 kk ennen mahdollista RAI:ta';
                reasoning.push('Radiojodihoito vasta-aiheinen imetyksen aikana');
                reasoning.push('Imetyksen lopetus kabergoliinilla');
                riskLevel = 'warning';
            } else {
                recommendation = 'Raskaus mahdollinen leikkauksen jälkeen';
                reasoning.push('Ei erityistä varoaikaa pelkän leikkauksen jälkeen');
                reasoning.push('Varmista TSH <2.5 mU/l ennen raskautta');
                riskLevel = 'benign';
            }
        }

        return {
            recommendation: recommendation,
            tshTarget: tshTarget,
            followUp: followUp,
            reasoning: reasoning,
            riskLevel: riskLevel
        };
    }

    function displayPregnancyResult(result, scenario) {
        pregnancyRecommendationDiv.textContent = result.recommendation;
        pregnancyRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>Hoitosuositus:</h3>';

        if (result.tshTarget) {
            rationaleHTML += '<p><strong>TSH-tavoite:</strong> ' + result.tshTarget + '</p>';
        }
        if (result.followUp) {
            rationaleHTML += '<p><strong>Seuranta:</strong> ' + result.followUp + '</p>';
        }

        rationaleHTML += '<p><strong>Perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        rationaleHTML += '<p><strong>Muistettavaa:</strong></p><ul>';
        rationaleHTML += '<li>Radiojodihoito on ehdottomasti vasta-aiheinen raskauden aikana</li>';
        rationaleHTML += '<li>TKI-lääkkeet ovat teratogeenisia</li>';
        if (scenario !== 'planningPregnancy') {
            rationaleHTML += '<li>Tyroksiinin tarve lisääntyy 30-50% raskauden aikana</li>';
        }
        rationaleHTML += '</ul>';

        pregnancyRationaleDiv.innerHTML = rationaleHTML;
        pregnancyResultContainer.style.display = 'block';
        pregnancyResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    // Thyroglobulin Interpretation form handling (8.3)
    const tgForm = document.getElementById('tgForm');
    const tgResultContainer = document.getElementById('tgResult');
    const tgRecommendationDiv = document.getElementById('tgRecommendation');
    const tgRationaleDiv = document.getElementById('tgRationale');

    if (tgForm) {
        tgForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const tgType = document.querySelector('input[name="tgType"]:checked').value;
            const tgValue = parseFloat(document.getElementById('tgValue').value);
            const tgAbStatus = document.querySelector('input[name="tgAbStatus"]:checked').value;
            const tgTrend = document.querySelector('input[name="tgTrend"]:checked').value;

            const result = interpretTg(tgType, tgValue, tgAbStatus, tgTrend);
            displayTgResult(result, tgType, tgValue, tgAbStatus, tgTrend);
        });

        tgForm.addEventListener('reset', function() {
            tgResultContainer.style.display = 'none';
        });
    }

    function interpretTg(tgType, tgValue, tgAbStatus, tgTrend) {
        let interpretation = '';
        let recommendation = '';
        let reasoning = [];
        let riskLevel = 'low-risk';

        // Check for TgAb interference
        if (tgAbStatus !== 'negative') {
            reasoning.push('TgAb koholla - Tg-arvo voi olla virheellisen matala');
            if (tgAbStatus === 'positive-rising') {
                interpretation = 'Nouseva TgAb - aktiivinen tauti todennäköinen';
                recommendation = 'Radiojodihoito harkittava, kuvantaminen tarpeen';
                riskLevel = 'high-risk';
                reasoning.push('Nouseva TgAb viittaa aktiiviseen kilpirauhassyöpään');
                reasoning.push('TgAb:n seuranta 3-6 kk välein');
            }
        }

        // If TgAb is not rising, interpret based on Tg value
        if (tgAbStatus !== 'positive-rising') {
            if (tgType === 'suppressed') {
                if (tgValue < 0.2) {
                    interpretation = 'Erinomainen vaste';
                    recommendation = 'Seuranta, ei uusintahoitoja';
                    riskLevel = 'benign';
                    reasoning.push('Suppressoitu Tg <0.2 µg/l - matala uusimisriski');
                } else if (tgValue <= 1) {
                    interpretation = 'Epävarma tilanne';
                    recommendation = 'Tiivis seuranta, kontrolli 6-12 kk';
                    riskLevel = 'warning';
                    reasoning.push('Suppressoitu Tg 0.2-1 µg/l');
                } else {
                    interpretation = 'Biokemiallinen epätäydellinen vaste';
                    recommendation = 'Kuvantaminen ja radiojodihoito harkittava';
                    riskLevel = 'high-risk';
                    reasoning.push('Suppressoitu Tg >1 µg/l viittaa jäljellä olevaan tautiin');
                }
            } else {
                // Stimulated Tg
                if (tgValue < 1) {
                    interpretation = 'Erinomainen vaste';
                    recommendation = 'Seuranta, ei uusintahoitoja';
                    riskLevel = 'benign';
                    reasoning.push('Stimuloitu Tg <1 µg/l - matala uusimisriski');
                } else if (tgValue <= 10) {
                    interpretation = 'Epävarma tilanne';
                    recommendation = 'Kontrolli 6-12 kk, seuraa trendiä';
                    riskLevel = 'warning';
                    reasoning.push('Stimuloitu Tg 1-10 µg/l');
                } else if (tgValue <= 20) {
                    interpretation = 'Biokemiallinen epätäydellinen vaste';
                    recommendation = 'Radiojodihoito yleensä perusteltu';
                    riskLevel = 'high-risk';
                    reasoning.push('Stimuloitu Tg >10 µg/l viittaa jäljellä olevaan tautiin');
                } else {
                    interpretation = 'Korkean riskin tilanne';
                    recommendation = 'Radiojodihoito ja laaja kuvantaminen';
                    riskLevel = 'high-risk';
                    reasoning.push('Stimuloitu Tg >20 µg/l - korkea uusimisriski');
                }
            }
        }

        // Check trend
        if (tgTrend === 'rising') {
            if (riskLevel !== 'high-risk') {
                riskLevel = 'warning';
            }
            reasoning.push('Nouseva Tg viittaa korkeaan uusimisriskiin');
            if (tgValue > 1) {
                recommendation = 'Kuvantaminen (UÄ, TT/MRI, mahdollisesti PET-TT)';
            }
        } else if (tgTrend === 'decreasing') {
            reasoning.push('Laskeva Tg on hyvä merkki');
        }

        return {
            interpretation: interpretation,
            recommendation: recommendation,
            reasoning: reasoning,
            riskLevel: riskLevel
        };
    }

    function displayTgResult(result, tgType, tgValue, tgAbStatus, tgTrend) {
        tgRecommendationDiv.textContent = result.interpretation;
        tgRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>Tulkinta:</h3>';
        rationaleHTML += '<p><strong>Mittaustyyppi:</strong> ' + (tgType === 'suppressed' ? 'Suppressoitu' : 'Stimuloitu') + '</p>';
        rationaleHTML += '<p><strong>Tg-arvo:</strong> ' + tgValue.toFixed(2) + ' µg/l</p>';
        rationaleHTML += '<p><strong>TgAb:</strong> ' + getTgAbStatusLabel(tgAbStatus) + '</p>';
        rationaleHTML += '<p><strong>Trendi:</strong> ' + getTgTrendLabel(tgTrend) + '</p>';

        rationaleHTML += '<p><strong>Suositus:</strong> ' + result.recommendation + '</p>';

        rationaleHTML += '<p><strong>Perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        if (result.riskLevel === 'high-risk' && tgValue > 1) {
            rationaleHTML += '<p><strong>Kohonneen Tg:n selvittely:</strong></p><ol>';
            rationaleHTML += '<li>Kaulan ultraäänitutkimus</li>';
            rationaleHTML += '<li>Kaulan MRI tai TT</li>';
            if (tgValue > 10) {
                rationaleHTML += '<li>PET-TT (erityisesti Tg >10 µg/l)</li>';
            }
            rationaleHTML += '<li>Koko kehon gammakuvaus diagnostisella radiojodiannoksella</li>';
            rationaleHTML += '</ol>';
        }

        tgRationaleDiv.innerHTML = rationaleHTML;
        tgResultContainer.style.display = 'block';
        tgResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function getTgAbStatusLabel(value) {
        const labels = {
            'negative': 'Negatiivinen',
            'positive-stable': 'Koholla, stabiili/laskeva',
            'positive-rising': 'Koholla, nousussa'
        };
        return labels[value] || value;
    }

    function getTgTrendLabel(value) {
        const labels = {
            'decreasing': 'Laskeva',
            'stable': 'Stabiili',
            'rising': 'Nousussa',
            'first': 'Ensimmäinen mittaus'
        };
        return labels[value] || value;
    }

    // Repeat Surgery form handling (7.1)
    const repeatSurgeryForm = document.getElementById('repeatSurgeryForm');
    const repeatSurgeryResultContainer = document.getElementById('repeatSurgeryResult');
    const repeatSurgeryRecommendationDiv = document.getElementById('repeatSurgeryRecommendation');
    const repeatSurgeryRationaleDiv = document.getElementById('repeatSurgeryRationale');

    if (repeatSurgeryForm) {
        repeatSurgeryForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const locations = Array.from(document.querySelectorAll('input[name="recurrenceLocation"]:checked'))
                .map(cb => cb.value);
            const nodeSize = parseInt(document.getElementById('nodeSize').value);
            const previousSurgery = document.querySelector('input[name="previousSurgery"]:checked').value;
            const fnacConfirmed = document.querySelector('input[name="fnacConfirmed"]:checked').value;

            const result = determineRepeatSurgery(locations, nodeSize, previousSurgery, fnacConfirmed);
            displayRepeatSurgeryResult(result, locations, nodeSize);
        });

        repeatSurgeryForm.addEventListener('reset', function() {
            repeatSurgeryResultContainer.style.display = 'none';
        });
    }

    function determineRepeatSurgery(locations, nodeSize, previousSurgery, fnacConfirmed) {
        let recommendation = '';
        let surgeryType = '';
        let reasoning = [];
        let riskLevel = 'warning';

        const isCentral = locations.includes('central');
        const isLateral = locations.includes('lateral');
        const isThyroidBed = locations.includes('thyroidBed');

        // Check if surveillance is appropriate based on size
        const centralThreshold = 8;
        const lateralThreshold = 10;

        if (fnacConfirmed === 'no') {
            recommendation = 'Tee ensin ONB-varmistus';
            surgeryType = 'Diagnoosi ensin';
            reasoning.push('ONB-varmistus tarvitaan ennen leikkauspäätöstä');
            reasoning.push('Kaulan MRI/TT ennen toimenpiteitä');
            riskLevel = 'warning';
        } else if (fnacConfirmed === 'suspicious') {
            recommendation = 'Harkitse uusinta-ONB tai leikkausta';
            surgeryType = 'Diagnoosi/leikkaus';
            reasoning.push('Epävarma ONB-tulos - harkitse uusintaa');
            reasoning.push('Jos kliininen epäily vahva, leikkaus perusteltua');
            riskLevel = 'warning';
        } else {
            // FNAC confirmed malignant
            if (isCentral && nodeSize < centralThreshold && !isLateral && !isThyroidBed) {
                recommendation = 'Seuranta mahdollinen';
                surgeryType = 'UÄ-seuranta 3-6 kk välein';
                reasoning.push('Sentraalialueen pieni (<8 mm) metastaasi');
                reasoning.push('Aktiivinen seuranta mahdollinen valituilla potilailla');
                riskLevel = 'low-risk';
            } else if (isLateral && nodeSize < lateralThreshold && !isCentral && !isThyroidBed) {
                recommendation = 'Seuranta mahdollinen';
                surgeryType = 'UÄ-seuranta 3-6 kk välein';
                reasoning.push('Lateraalialueen pieni (<10 mm) metastaasi');
                reasoning.push('Aktiivinen seuranta mahdollinen valituilla potilailla');
                riskLevel = 'low-risk';
            } else {
                recommendation = 'Leikkaushoito suositeltava';
                riskLevel = 'high-risk';

                if (isCentral) {
                    if (previousSurgery === 'yes') {
                        surgeryType = 'Leesion poisto (berry picking)';
                        reasoning.push('Sentraalialue aiemmin leikattu - kohdennettu poisto');
                    } else {
                        surgeryType = 'Tason VI tyhjennys';
                        reasoning.push('Sentraalialueen systemaattinen tyhjennys');
                    }
                    reasoning.push('Neuromonitorointi aiheellista');
                }

                if (isLateral) {
                    if (previousSurgery === 'yes') {
                        surgeryType = (surgeryType ? surgeryType + ' + ' : '') + 'Kohdennettu lateraalinen poisto';
                        reasoning.push('Lateraalialue aiemmin leikattu - kohdennettu poisto');
                    } else {
                        surgeryType = (surgeryType ? surgeryType + ' + ' : '') + 'Kauladissektio IIa-III-IV-Vb';
                        reasoning.push('Lateraalialueen systemaattinen dissektio');
                    }
                }

                if (isThyroidBed) {
                    surgeryType = (surgeryType ? surgeryType + ' + ' : '') + 'Kilpirauhasalueen revisio';
                    reasoning.push('Kilpirauhasen leikkausalueen uusiutuma');
                }
            }
        }

        reasoning.push('Hoito keskitettävä yliopistosairaalaan');

        return {
            recommendation: recommendation,
            surgeryType: surgeryType,
            reasoning: reasoning,
            riskLevel: riskLevel
        };
    }

    function displayRepeatSurgeryResult(result, locations, nodeSize) {
        repeatSurgeryRecommendationDiv.textContent = result.recommendation;
        repeatSurgeryRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>Hoitosuositus:</h3>';
        rationaleHTML += '<p><strong>Solmukkeen koko:</strong> ' + nodeSize + ' mm</p>';
        rationaleHTML += '<p><strong>Toimenpide:</strong> ' + result.surgeryType + '</p>';

        rationaleHTML += '<p><strong>Perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        repeatSurgeryRationaleDiv.innerHTML = rationaleHTML;
        repeatSurgeryResultContainer.style.display = 'block';
        repeatSurgeryResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    // Repeat RAI form handling (7.2)
    const repeatRaiForm = document.getElementById('repeatRaiForm');
    const repeatRaiResultContainer = document.getElementById('repeatRaiResult');
    const repeatRaiRecommendationDiv = document.getElementById('repeatRaiRecommendation');
    const repeatRaiRationaleDiv = document.getElementById('repeatRaiRationale');

    if (repeatRaiForm) {
        repeatRaiForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const stimTg = parseFloat(document.getElementById('stimTgLevel').value);
            const tgTrend = document.querySelector('input[name="tgTrendRai"]:checked').value;
            const tgAbStatus = document.querySelector('input[name="tgAbRai"]:checked').value;
            const metastases = document.querySelector('input[name="metastases"]:checked').value;
            const iodineAvid = document.querySelector('input[name="iodineAvid"]:checked').value;

            const result = determineRepeatRai(stimTg, tgTrend, tgAbStatus, metastases, iodineAvid);
            displayRepeatRaiResult(result, stimTg, metastases);
        });

        repeatRaiForm.addEventListener('reset', function() {
            repeatRaiResultContainer.style.display = 'none';
        });
    }

    function determineRepeatRai(stimTg, tgTrend, tgAbStatus, metastases, iodineAvid) {
        let recommendation = '';
        let dose = '';
        let reasoning = [];
        let riskLevel = 'low-risk';

        // Check if RAI-refractory
        if (iodineAvid === 'no') {
            recommendation = 'Radiojodihoito ei ole indisoitu';
            dose = 'Ei RAI:ta';
            reasoning.push('Radiojodirefraktaari tauti - pesäkkeet eivät kerää radiojodia');
            reasoning.push('Harkitse ulkoista sädehoitoa tai systeemistä lääkehoitoa');
            riskLevel = 'warning';
        } else {
            // Check for distant metastases
            if (metastases === 'lungMicro') {
                recommendation = 'RAI-sarjahoito suositeltava';
                dose = '3.7 GBq × 3 (4-6 kk välein)';
                reasoning.push('Mikronodulaarinen keuhkometastasointi');
                reasoning.push('Kuratiivinen hoitotulos mahdollinen');
                riskLevel = 'high-risk';
            } else if (metastases === 'lungMacro' || metastases === 'bone' || metastases === 'other') {
                recommendation = 'RAI-sarjahoito + mahdollisesti paikallishoito';
                dose = '3.7 GBq × 3 (4-6 kk välein)';
                reasoning.push('Etäpesäkkeet todettu - tarvitaan monimodaalinen hoito');
                if (metastases === 'bone') {
                    reasoning.push('Luustometastaasit vaativat aina myös ulkoista sädehoitoa');
                }
                riskLevel = 'high-risk';
            } else {
                // No distant metastases - base on Tg levels
                if (stimTg >= 10) {
                    recommendation = 'Radiojodihoito suositeltava';
                    dose = '3.7 GBq';
                    reasoning.push('Biokemiallinen epätäydellinen vaste (stim. Tg ≥10 µg/l)');
                    riskLevel = 'high-risk';
                } else if (stimTg >= 1 && stimTg < 10) {
                    if (tgTrend === 'rising') {
                        recommendation = 'Radiojodihoito harkittava';
                        dose = '3.7 GBq';
                        reasoning.push('Epävarma tilanne nousevalla Tg-trendillä');
                        riskLevel = 'warning';
                    } else {
                        recommendation = 'Kontrolli 6-12 kk';
                        dose = 'Ei RAI:ta vielä';
                        reasoning.push('Epävarma tilanne (stim. Tg 1-10 µg/l)');
                        reasoning.push('Seuranta tiivis, RAI jos selvä nousu');
                        riskLevel = 'warning';
                    }
                } else {
                    recommendation = 'Ei RAI-tarvetta';
                    dose = 'Seuranta riittää';
                    reasoning.push('Matala Tg-taso (stim. Tg <1 µg/l)');
                    riskLevel = 'benign';
                }
            }

            // Check TgAb
            if (tgAbStatus === 'rising') {
                recommendation = 'Radiojodihoito suositeltava';
                dose = '3.7 GBq';
                reasoning.push('Nouseva TgAb viittaa aktiiviseen syöpään');
                riskLevel = 'high-risk';
            }
        }

        return {
            recommendation: recommendation,
            dose: dose,
            reasoning: reasoning,
            riskLevel: riskLevel
        };
    }

    function displayRepeatRaiResult(result, stimTg, metastases) {
        repeatRaiRecommendationDiv.textContent = result.recommendation;
        repeatRaiRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>Hoitosuositus:</h3>';
        rationaleHTML += '<p><strong>Stimuloitu Tg:</strong> ' + stimTg.toFixed(1) + ' µg/l</p>';
        rationaleHTML += '<p><strong>RAI-annos:</strong> ' + result.dose + '</p>';

        rationaleHTML += '<p><strong>Perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        if (result.riskLevel === 'high-risk') {
            rationaleHTML += '<p><strong>Muistettavaa:</strong></p><ul>';
            rationaleHTML += '<li>Vähäjodinen ruokavalio 2 viikkoa ennen hoitoa</li>';
            rationaleHTML += '<li>TSH-stimulaatio rhTSH:lla tai tyroksiinivieroituksella</li>';
            rationaleHTML += '<li>33 GBq kumulatiivista turvallisuusrajaa voidaan ylittää yksilöllisesti</li>';
            rationaleHTML += '</ul>';
        }

        repeatRaiRationaleDiv.innerHTML = rationaleHTML;
        repeatRaiResultContainer.style.display = 'block';
        repeatRaiResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    // External Radiation form handling (7.3)
    const radiationForm = document.getElementById('radiationForm');
    const radiationResultContainer = document.getElementById('radiationResult');
    const radiationRecommendationDiv = document.getElementById('radiationRecommendation');
    const radiationRationaleDiv = document.getElementById('radiationRationale');

    if (radiationForm) {
        radiationForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const target = document.querySelector('input[name="radiationTarget"]:checked').value;
            const lesionCount = document.querySelector('input[name="lesionCount"]:checked').value;
            const raiResponse = document.querySelector('input[name="raiResponse"]:checked').value;
            const surgeryPossible = document.querySelector('input[name="surgeryPossible"]:checked').value;
            const symptoms = Array.from(document.querySelectorAll('input[name="symptoms"]:checked'))
                .map(cb => cb.value);

            const result = determineRadiation(target, lesionCount, raiResponse, surgeryPossible, symptoms);
            displayRadiationResult(result, target);
        });

        radiationForm.addEventListener('reset', function() {
            radiationResultContainer.style.display = 'none';
        });
    }

    function determineRadiation(target, lesionCount, raiResponse, surgeryPossible, symptoms) {
        let recommendation = '';
        let technique = '';
        let reasoning = [];
        let riskLevel = 'warning';

        const isOligomet = lesionCount === 'single' || lesionCount === 'oligo';
        const hasSymptoms = symptoms.length > 0;

        if (surgeryPossible === 'yes' && (lesionCount === 'single' || target === 'neck')) {
            recommendation = 'Harkitse ensin leikkaushoitoa';
            technique = 'Kirurgia ensisijainen';
            reasoning.push('Leikkauskelpoiset leesiot - kirurgia ensisijainen');
            riskLevel = 'low-risk';
        } else if (raiResponse === 'avid' && !hasSymptoms && target !== 'bone') {
            recommendation = 'Harkitse ensin radiojodihoitoa';
            technique = 'RAI ensisijainen';
            reasoning.push('Radiojodia keräävä tauti - RAI ensisijainen hoitomuoto');
            riskLevel = 'low-risk';
        } else {
            // Radiation indicated
            if (target === 'neck') {
                recommendation = 'Ulkoinen sädehoito aiheellinen';
                technique = 'IMRT 54-70 Gy';
                reasoning.push('Kaulan sädehoito indisoitu');
                if (raiResponse === 'refractory') {
                    reasoning.push('Radiojodirefraktaari kaulatauti');
                }
                riskLevel = 'high-risk';
            } else if (target === 'brain') {
                if (lesionCount === 'multiple') {
                    recommendation = 'Kokoaivojen sädehoito';
                    technique = 'WBRT tai SRS + WBRT';
                    reasoning.push('>4 aivometastaasia - kokoaivojen hoito harkittava');
                } else {
                    recommendation = 'Stereotaktinen sädehoito';
                    technique = 'SRS/SRT';
                    reasoning.push('≤4 aivometastaasia - stereotaktinen hoito suositeltava');
                }
                riskLevel = 'high-risk';
            } else if (target === 'bone') {
                recommendation = 'Ulkoinen sädehoito + RAI (jos kerää)';
                technique = 'EBRT 30-40 Gy + RAI';
                reasoning.push('Luustometastaasit vaativat AINA ulkoista sädehoitoa RAI:n lisäksi');
                if (symptoms.includes('fracture')) {
                    reasoning.push('Murtumariski kantavassa luussa');
                }
                riskLevel = 'high-risk';
            } else if (isOligomet && raiResponse === 'refractory') {
                recommendation = 'Stereotaktinen sädehoito';
                technique = 'SBRT/SABR';
                reasoning.push('Oligometastaattinen radiojodirefraktaari tauti');
                reasoning.push('Voi viivästyttää systeemisen lääkehoidon tarvetta');
                riskLevel = 'warning';
            } else {
                recommendation = 'Palliatiivinen sädehoito harkittava';
                technique = 'Yksilöllinen annos';
                reasoning.push('Oireenmukaiseen hoitoon');
                if (hasSymptoms) {
                    reasoning.push('Oireita aiheuttavat pesäkkeet');
                }
                riskLevel = 'warning';
            }
        }

        return {
            recommendation: recommendation,
            technique: technique,
            reasoning: reasoning,
            riskLevel: riskLevel
        };
    }

    function displayRadiationResult(result, target) {
        radiationRecommendationDiv.textContent = result.recommendation;
        radiationRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>Hoitosuositus:</h3>';
        rationaleHTML += '<p><strong>Tekniikka:</strong> ' + result.technique + '</p>';

        rationaleHTML += '<p><strong>Perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        radiationRationaleDiv.innerHTML = rationaleHTML;
        radiationResultContainer.style.display = 'block';
        radiationResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    // Systemic Therapy form handling (7.4)
    const systemicForm = document.getElementById('systemicForm');
    const systemicResultContainer = document.getElementById('systemicResult');
    const systemicRecommendationDiv = document.getElementById('systemicRecommendation');
    const systemicRationaleDiv = document.getElementById('systemicRationale');

    if (systemicForm) {
        systemicForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const raiStatus = document.querySelector('input[name="raiStatus"]:checked').value;
            const progression = document.querySelector('input[name="progression"]:checked').value;
            const localControl = document.querySelector('input[name="localControl"]:checked').value;
            const burden = Array.from(document.querySelectorAll('input[name="burden"]:checked'))
                .map(cb => cb.value);
            const molecular = Array.from(document.querySelectorAll('input[name="molecular"]:checked'))
                .map(cb => cb.value);

            const result = determineSystemicTherapy(raiStatus, progression, localControl, burden, molecular);
            displaySystemicResult(result, molecular);
        });

        systemicForm.addEventListener('reset', function() {
            systemicResultContainer.style.display = 'none';
        });
    }

    function determineSystemicTherapy(raiStatus, progression, localControl, burden, molecular) {
        let recommendation = '';
        let drug = '';
        let reasoning = [];
        let riskLevel = 'low-risk';

        const hasBurden = burden.length > 0;
        const isSymptomatic = burden.includes('symptomatic');
        const isSignificant = burden.includes('significant');
        const isThreatening = burden.includes('threatening');

        if (raiStatus === 'responsive') {
            recommendation = 'Jatka radiojodihoitoa';
            drug = 'RAI ensisijainen';
            reasoning.push('Radiojodia keräävä tauti - jatka RAI-hoitoa');
            riskLevel = 'benign';
        } else if (localControl === 'yes') {
            recommendation = 'Paikallishoito ensisijainen';
            drug = 'Kirurgia/sädehoito';
            reasoning.push('Tauti hallittavissa paikallishoidolla');
            riskLevel = 'low-risk';
        } else if (progression === 'stable' && !hasBurden) {
            recommendation = 'Aktiivinen seuranta';
            drug = 'Ei lääkehoitoa';
            reasoning.push('Stabiili tauti ilman oireita tai merkittävää tautitaakkaa');
            reasoning.push('Pelkkä Tg-nousu EI riitä TKI-indikaatioksi');
            riskLevel = 'benign';
        } else if (progression === 'slow' && !isSymptomatic && !isThreatening) {
            recommendation = 'Seuranta, harkitse lääkehoitoa';
            drug = 'Ei vielä';
            reasoning.push('Hidas progressio - seuranta mahdollinen');
            reasoning.push('Aloita lääkehoito jos progressio nopeutuu tai oireet ilmaantuvat');
            riskLevel = 'warning';
        } else {
            // TKI indicated
            recommendation = 'Systeeminen lääkehoito indisoitu';
            riskLevel = 'high-risk';

            if (molecular.includes('ntrk')) {
                drug = 'Larotrektinibi tai Entrektinibi';
                reasoning.push('NTRK-fuusiopositiivinen kasvain');
                reasoning.push('Kohdennettu hoito ensisijainen');
            } else if (molecular.includes('ret')) {
                drug = 'Selperkatinibi';
                reasoning.push('RET-fuusiopositiivinen kasvain');
                reasoning.push('Kohdennettu hoito ensisijainen');
            } else {
                drug = 'Lenvatinibi (24 mg × 1) tai Sorafenibi (400 mg × 2)';
                reasoning.push('Ensilinjan TKI-hoito');
            }

            reasoning.push('Radiojodirefraktaari, etenevä tauti');
            if (isSymptomatic) reasoning.push('Oireinen potilas');
            if (isSignificant) reasoning.push('Merkittävä tautitaakka');
            if (isThreatening) reasoning.push('Henkeä uhkaava sijainti');
        }

        return {
            recommendation: recommendation,
            drug: drug,
            reasoning: reasoning,
            riskLevel: riskLevel
        };
    }

    function displaySystemicResult(result, molecular) {
        systemicRecommendationDiv.textContent = result.recommendation;
        systemicRecommendationDiv.className = 'recommendation ' + result.riskLevel;

        let rationaleHTML = '<h3>Hoitosuositus:</h3>';
        rationaleHTML += '<p><strong>Lääke:</strong> ' + result.drug + '</p>';

        rationaleHTML += '<p><strong>Perustelut:</strong></p><ul>';
        result.reasoning.forEach(reason => {
            rationaleHTML += '<li>' + reason + '</li>';
        });
        rationaleHTML += '</ul>';

        if (result.riskLevel === 'high-risk') {
            rationaleHTML += '<p><strong>Seuranta TKI-hoidon aikana:</strong></p><ul>';
            rationaleHTML += '<li>Verenpaine, laboratoriokokeet, ihohaitat</li>';
            rationaleHTML += '<li>Annosta joudutaan usein vähentämään</li>';
            rationaleHTML += '<li>Tyroksiinin tarve voi kasvaa</li>';
            rationaleHTML += '</ul>';

            if (molecular.length === 0) {
                rationaleHTML += '<p><strong>Harkitse molekyylipatologista tutkimusta:</strong> NTRK, RET, BRAF</p>';
            }
        }

        systemicRationaleDiv.innerHTML = rationaleHTML;
        systemicResultContainer.style.display = 'block';
        systemicResultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
});
    </script>
</body>
</html>
